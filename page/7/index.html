<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 8.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aurora-lsk.asia","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
<meta property="og:type" content="website">
<meta property="og:title" content="坤博客">
<meta property="og:url" content="https://aurora-lsk.asia/page/7/index.html">
<meta property="og:site_name" content="坤博客">
<meta property="og:description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="坤">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://aurora-lsk.asia/page/7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>坤博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">坤博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.2%E4%BF%A1%E5%8F%B7%E9%87%8F%EF%BC%8C%E4%BA%8B%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.2%E4%BF%A1%E5%8F%B7%E9%87%8F%EF%BC%8C%E4%BA%8B%E4%BB%B6/" class="post-title-link" itemprop="url">3.2信号量，事件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>信号量</h1>
<h2 id="【一】什么是信号量">【一】什么是信号量</h2>
<ul>
<li>
<p>方法Semaphore</p>
</li>
<li>
<p>允许指定数量的进程或线程对资源进行修改</p>
</li>
<li>
<p>互斥锁：同一时间只能只允许一个进程或线程对资源的修改</p>
</li>
</ul>
<h2 id="【二】例子">【二】例子</h2>
<ul>
<li>
<p>信号量与进程池的概念很像，但是要区分开，信号量涉及到加锁的概念</p>
</li>
<li>
<p>指定信号为3，来几个人进程或线程获得一把锁，计数加1，当技术等于3时，后面的人需要等待，有一个进程或线程结束后就会立刻有一个程序获的一把锁，继续往下执行，以此类推，直到程序结束</p>
</li>
</ul>
```python
import time
from multiprocessing import Semaphore，Process
import random


def semaphore(sem, name):
    sem.acquire()
    print(f"process {name} is starting")
    time.sleep(random.randint(1,4))
    print(f"process {name} is ending")
    sem.release()

def main():
    task_list = []
    sem = Semaphore(3)
    for i in range(8):
        task = Process(
            target=semaphore, args=(sem, f"tom_{i}")
        )
        task.start()
        task_list.append(task)
    for task in task_list:
        task.join()


if __name__ == '__main__':
    print("this is main process starting")
    main()
    print("this is main process ending")
    # 输出
    # this is main process starting
    # process tom_0 is starting
    # process tom_1 is starting
    # process tom_2 is starting
    # process tom_0 is ending
    # process tom_3 is starting
    # process tom_1 is ending
    # process tom_4 is starting
    # process tom_3 is ending
    # process tom_5 is starting
    # process tom_2 is ending
    # process tom_6 is starting
    # process tom_6 is ending
    # process tom_7 is starting
    # process tom_4 is ending
    # process tom_5 is ending
    # process tom_7 is ending
    # this is main process ending
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 事件</span><br><span class="line"></span><br><span class="line">## 【一】什么是事件</span><br><span class="line"></span><br><span class="line">- 和线程一样</span><br><span class="line"></span><br><span class="line">## 【二】事件的处理方法</span><br><span class="line"></span><br><span class="line">- python线程的事件用于主线程控制其它线程的执行，事件主要提供了三个方法set、wait、clear。</span><br><span class="line">- 事件处理的机制：</span><br><span class="line">  - 全局定义了一个“Flag”</span><br><span class="line">  - 如果“Flag”值为False，那么当程序执行`event.wait`方法时就会阻塞</span><br><span class="line">  - 如果“Flag”值为True，那么`event.wait`方法时便不再阻塞</span><br><span class="line">  - clear：</span><br><span class="line">    - 将“Flag”设置为False</span><br><span class="line">  - set:</span><br><span class="line">    - 将“Flag”设置为False</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from multiprocessing import Process, Event, Manager</span><br><span class="line">import time</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line">color_red = &#x27;\033[31m&#x27;</span><br><span class="line">color_reset = &#x27;\033[0m&#x27;</span><br><span class="line">color_green = &#x27;\033[32m&#x27;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义车辆行为函数，它会根据事件对象(event)的状态来决定是否等待或通过路口</span><br><span class="line">def car(event, n):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    模拟汽车行为</span><br><span class="line">    :param event: 事件对象，用于同步操作，红绿灯状态的标识</span><br><span class="line">    :param n: 第几辆车的标识</span><br><span class="line">    :return: 无返回值</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line"></span><br><span class="line">    # 创建一个无限循环直到车辆离开</span><br><span class="line">    while True:</span><br><span class="line">        # 如果事件未设置，表示红灯 False</span><br><span class="line">        if not event.is_set():</span><br><span class="line">            # 红灯亮时，车辆等待，并输出提示信息</span><br><span class="line">            print(f&#x27;&#123;color_red&#125;红灯亮&#123;color_reset&#125;，car&#123;n&#125; :&gt;&gt;&gt; 正在等待 ... &#x27;)</span><br><span class="line">            # 阻塞当前进程，等待event被设置（绿灯）</span><br><span class="line">            event.wait()</span><br><span class="line">            # 当event被设置后，打印绿灯信息</span><br><span class="line">            print(f&#x27;&#123;color_green&#125;车 &#123;n&#125; :&gt;&gt;&gt;&gt; 看见绿灯亮了&#123;color_reset&#125;&#x27;)</span><br><span class="line">            # 模拟通过路口需要的时间</span><br><span class="line">            time.sleep(random.randint(3, 6))</span><br><span class="line">            # 防止在sleep期间event状态改变，再次检查状态</span><br><span class="line">            if not event.is_set():</span><br><span class="line">                continue</span><br><span class="line">            # 通过路口</span><br><span class="line">            print(f&#x27;car &#123;n&#125; :&gt;&gt;&gt;&gt; 安全通行&#x27;)</span><br><span class="line">            # 退出循环</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义 警车 行为函数， 警车 在红灯时等待一秒后直接通过</span><br><span class="line">def police_car(event, n):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    模拟 警车 行为</span><br><span class="line">    :param event: 事件对象，用于同步操作，红绿灯状态的标识</span><br><span class="line">    :param n: 第几辆车的标识</span><br><span class="line">    :return: 无返回值</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    while True:</span><br><span class="line">        # 判断是否为红灯</span><br><span class="line">        if not event.is_set():</span><br><span class="line">            print(f&#x27;&#123;color_red&#125;红灯亮&#123;color_reset&#125;，car&#123;n&#125; :&gt;&gt;&gt; 正在等待 ... &#x27;)</span><br><span class="line">            #  等待1秒，不完全遵守交通规则</span><br><span class="line">            event.wait(1)</span><br><span class="line">            print(f&#x27;灯的是&#123;event.is_set()&#125;，警车走了,car&#123;n&#125;&#x27;)</span><br><span class="line">            # 通过后立即结束循环</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义交通灯控制函数，周期性切换红绿灯状态</span><br><span class="line">def traffic_lights(event, interval):</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    模拟 交通灯 行为</span><br><span class="line">    :param event: 事件对象，用于同步操作，红绿灯状态的标识</span><br><span class="line">    :param interval: 间隔（比如10秒）改变信号灯</span><br><span class="line">    :return: 无返回值</span><br><span class="line">    &#x27;&#x27;&#x27;</span><br><span class="line">    # 无限循环，持续控制交通灯状态</span><br><span class="line">    while True:</span><br><span class="line">        # 按照给定间隔（比如10秒）改变信号灯</span><br><span class="line">        time.sleep(interval)</span><br><span class="line">        # 如果当前是绿灯</span><br><span class="line">        if event.is_set():</span><br><span class="line">            # 切换到红灯状态</span><br><span class="line">            # event.is_set() ----&gt;False</span><br><span class="line">            event.clear()</span><br><span class="line">        else:</span><br><span class="line">            # 如果当前是红灯，则切换到绿灯状态</span><br><span class="line">            # event.is_set() ----&gt; True</span><br><span class="line">            event.set()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main():</span><br><span class="line">    # 初始化事件对象，初始状态为清除（即红灯）</span><br><span class="line">    event = Event()</span><br><span class="line">    # 使用Manager创建一个可跨进程共享的Event对象</span><br><span class="line">    # manager = Manager()</span><br><span class="line">    # event = manager.Event()</span><br><span class="line"></span><br><span class="line">    # 创建并启动多个 警车 进程</span><br><span class="line">    for i in range(5):</span><br><span class="line">        police_car_process = Process(target=police_car, args=(event, i))</span><br><span class="line">        police_car_process.start()</span><br><span class="line"></span><br><span class="line">    # 启动交通灯控制进程</span><br><span class="line">    # 交通灯变化周期为10秒</span><br><span class="line">    traffic_lights_process = Process(target=traffic_lights, args=(event, 10))</span><br><span class="line">    traffic_lights_process.start()</span><br><span class="line"></span><br><span class="line">    # 打印分割线，表明程序运行开始</span><br><span class="line">    print(&#x27; ------------交通开始------------- &#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main()</span><br><span class="line">    #  ------------交通开始------------- </span><br><span class="line">    # 红灯亮，car2 :&gt;&gt;&gt; 正在等待 ... </span><br><span class="line">    # 红灯亮，car0 :&gt;&gt;&gt; 正在等待 ... </span><br><span class="line">    # 红灯亮，car3 :&gt;&gt;&gt; 正在等待 ... </span><br><span class="line">    # 红灯亮，car1 :&gt;&gt;&gt; 正在等待 ... </span><br><span class="line">    # 红灯亮，car4 :&gt;&gt;&gt; 正在等待 ... </span><br><span class="line">    # 灯的是False，警车走了,car2</span><br><span class="line">    # 灯的是False，警车走了,car0</span><br><span class="line">    # 灯的是False，警车走了,car3</span><br><span class="line">    # 灯的是False，警车走了,car1</span><br><span class="line">    # 灯的是False，警车走了,car4</span><br></pre></td></tr></table></figure>

<h2 id="【三】补充">【三】补充</h2>
<ul>
<li>在Python中，可以使用ANSI转义码来设置打印到控制台的文本颜色。</li>
<li><code>\033[</code>是一个开始ANSI序列的转义字符，之后的数字和字母组合定义了具体的样式改变</li>
<li>一下是对<code>\033[设置]</code>的一个详细解释及示例</li>
</ul>
<h3 id="【1】基本语法">【1】基本语法</h3>
<ul>
<li>ANSI 转义序列的一般形式为：<code>\033[属性;...;属性m</code>，其中：
<ul>
<li><code>\033[</code> 是开始标记。</li>
<li>属性之间用分号<code>;</code>隔开，可以指定多个属性（如前景色、背景色）。</li>
<li><code>m</code> 表示设置结束。</li>
</ul>
</li>
</ul>
<h3 id="【2】常用属性">【2】常用属性</h3>
<ul>
<li>
<p>前景色：30-37代表不同的颜色，加上40可以使颜色变为亮色系</p>
</li>
<li>
<ul>
<li>30: 黑色</li>
<li>31: 红色</li>
<li>32: 绿色</li>
<li>33: 黄色</li>
<li>34: 蓝色</li>
<li>35: 紫红色（洋红）</li>
<li>36: 青蓝色（青色）</li>
<li>37: 白色</li>
</ul>
</li>
<li>
<p>背景色：40-47，与前景色类似，但用于背景</p>
</li>
<li>
<p>重置：0，用于清除所有属性设置，回到默认状态。</p>
</li>
</ul>
<h3 id="【3】示例">【3】示例</h3>
<ul>
<li>下面的Python代码示例展示了如何使用ANSI转义码来改变打印文本的颜色和背景色：</li>
</ul>
```python
print("\033[31m这是红色文本\033[0m")  # 红色前景色
print("\033[32m这是绿色文本\033[0m")  # 绿色前景色
print("\033[1;33m这是加粗的黄色文本\033[0m")  # 加粗并设置黄色前景色
print("\033[44m这是蓝色背景文本\033[0m")  # 蓝色背景色
print("\033[34;47m这是蓝色前景色和白色背景色的文本\033[0m")  # 蓝色前景和白色背景
```

<p><img src="https://cdn.nlark.com/yuque/0/2024/png/2322113/1716429167017-116868a2-1026-4682-8635-f8f645b10e10.png?x-oss-process=image%2Fformat%2Cwebp" alt="image.png"></p>
<h3 id="【4】注意事项">【4】注意事项</h3>
<ul>
<li>并非所有的终端都支持ANSI转义码，特别是在一些老版本或非常轻量级的终端中。</li>
<li>在Windows的命令提示符中，默认不支持ANSI转义码，但自从Windows 10开始，通过启用某些设置或使用第三方工具（如ANSICON）可以使其支持。</li>
<li>如果你想让你的脚本更具有跨平台兼容性，可以考虑使用像<code>colorama</code>这样的库，它可以在不支持ANSI转义的平台上模拟这些功能。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.3%E5%90%8D%E7%A7%B0%E7%A9%BA%E9%97%B4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.3%E5%90%8D%E7%A7%B0%E7%A9%BA%E9%97%B4/" class="post-title-link" itemprop="url">3.3名称空间</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>名称空间</h1>
<h2 id="【一】什么是名称空间">【一】什么是名称空间</h2>
<ul>
<li>存放函数名和函数值对应关系的地方</li>
<li>变量名=变量值</li>
<li>先开辟一块内存空间，把函数值扔到内存空间中----》内存空间</li>
<li>然后将变量名和变量值进行绑定存放到名称空间中—》名称空间中</li>
</ul>
<h2 id="【二】名称空间的分类">【二】名称空间的分类</h2>
<h3 id="【1】内建名称空间">【1】内建名称空间</h3>
<ul>
<li>伴随Python解释器的代码启动而生成，随着代码结束而关闭
<ul>
<li>第一个被加载的名称空间，用来存放一些内置的名字，比如内建函数名</li>
</ul>
</li>
</ul>
```python
print(max)
# <built-in function max>
#翻译：max最大
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 【2】全局名称空间</span><br><span class="line"></span><br><span class="line">- 随着内建名称空间加载完成</span><br><span class="line">- 伴随python文件的开始执行/执行完毕而产生/回收</span><br><span class="line">  - 是第二个被加载的名称空间，文件执行过程中产生的名字都会存放于该名称空间中，如下名字</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">import sys #模块名sys</span><br><span class="line"></span><br><span class="line">x=1 #变量名x</span><br><span class="line"></span><br><span class="line">if x == 1:</span><br><span class="line">    y=2 #变量名y</span><br><span class="line"></span><br><span class="line">def foo(x): #函数名foo</span><br><span class="line">    y=1</span><br><span class="line">    def bar():</span><br><span class="line">        pass</span><br><span class="line"></span><br><span class="line">Class Bar: #类名Bar</span><br><span class="line">	pass</span><br><span class="line"></span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line"># 这个列表是全局的列表</span><br><span class="line"># 列表是可变数据类型 ---&gt; 列表被修改后id不变</span><br><span class="line">num_list = []</span><br><span class="line">print(id(num_list)) # 1200291395392</span><br><span class="line">def add_list(num):</span><br><span class="line">    num_list.append(num)</span><br><span class="line">    print(id(num_list)) # 1200291395392</span><br><span class="line">add_list(1)</span><br><span class="line">add_list(2)</span><br><span class="line">add_list(3)</span><br><span class="line">print(num_list) # [1, 2, 3]</span><br><span class="line">print(id(num_list)) # 1200291395392</span><br><span class="line">&#x27;&#x27;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="【3】局部名称空间">【3】局部名称空间</h3>
<ul>
<li>
<p>在函数内部或者是类内部定义的变量</p>
</li>
<li>
<p>随着函数启动而创建，随着函数结束而消失</p>
</li>
<li>
<p>列表式是可变数据类型----》列表被修改后id不变</p>
</li>
<li>
<p>函数的形参，函数内定义的名字都会被存放于该名称空间中</p>
</li>
</ul>
<h3 id="【4】名称空间的加载顺序">【4】名称空间的加载顺序</h3>
<ul>
<li>内置–》全局–》局部</li>
<li>查找一个名字的顺序：</li>
<li>局部-》全局-》内置</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.4%E4%BD%9C%E7%94%A8%E5%9F%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.4%E4%BD%9C%E7%94%A8%E5%9F%9F/" class="post-title-link" itemprop="url">3.4作用域</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>作用域</h1>
<h1>【一】 变量作用域</h1>
<ul>
<li>变量的作用域
<ul>
<li>python是静态作用域，也就是说在python中，变量的作用域源于它在代码中的位置</li>
<li>在不同的位置，可能有不同的命名空间，命名空间是变量作用域的体现形式</li>
</ul>
</li>
</ul>
<h1>【二】四种作用域</h1>
<h2 id="【1】Local（局部作用域）">【1】Local（局部作用域）</h2>
<ul>
<li>在函数内部或者是类内部的名称空间</li>
</ul>
```python
# 定义一个函数，函数内部就是局部作用域
def fun():
    # 只有在函数内部的变量
    b = 2
    print(b)  # 输出2


fun()
# 调用函数后，发现找不到变量 b 是因为在全局作用域中找不到 变量 b
print(b)  # 报错

'''
Traceback (most recent call last):
  File "E:\PythonProjects\def_func.py", line 16, in <module>
    print(b)  # 报错
NameError: name 'b' is not defined
'''
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【2】Enclosed（嵌套）</span><br><span class="line"></span><br><span class="line">- 一般是在函数中嵌套函数的时候，外层函数的变量作用域</span><br><span class="line">- 嵌套就是函数里面在嵌套函数</span><br><span class="line">- 作用范围是闭包函数</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line"> Enclosed(嵌套)作用域</span><br><span class="line">def fun1():</span><br><span class="line">    b = 2</span><br><span class="line">    print(&quot;这是fun1打印的：&quot;, b)</span><br><span class="line">    def fun2():</span><br><span class="line">        # 函数 func1 里面 嵌套的 函数 func2 里面的作用域就是 嵌套作用域</span><br><span class="line">        print(&quot;这是fun2打印的：&quot;, b)</span><br><span class="line">    # 将内部函数 func2 的内存地址返回</span><br><span class="line">    return fun2</span><br><span class="line"># 调用 函数 fun1 ， 函数 func1 的返回值是内部函数 fuc2的函数地址</span><br><span class="line">temp = fun1()</span><br><span class="line"># 调用 函数 fun1 的返回值(fuc2的函数地址) , 从而执行 函数 fuc2</span><br><span class="line">temp()</span><br><span class="line">#输出： 这是fun1打印的： 2</span><br><span class="line"># 输出：这是fun2打印的： 2</span><br></pre></td></tr></table></figure>

<ul>
<li>函数fun2里面并没有变量b，但是它可以引用外层函数定义的变量b，此时变量b的作用域就是Enclosed（嵌套）</li>
</ul>
<h2 id="【3】Global（全局）">【3】Global（全局）</h2>
<ul>
<li>
<p>一般模块文件顶层声明的变量具有全局作用域，从外部来看，模块的全局变量就是一个模块对象的属性，仅限于单个模块中。（意思是仅限于本次程序）</p>
</li>
<li>
<p>作用域范围：当前模块（文件）</p>
</li>
</ul>
```python
# Global(全局)作用域

# 定义在全局的变量，在本文件任意位置可调用该变量
a = 2


def fun1():
    print("这是fun1打印的：", a)


fun1()
print(a)

# 这是fun1打印的： 2
# 2
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【4】Built-in(内置)</span><br><span class="line"></span><br><span class="line">- 解释器内置的变量：列入数据类型</span><br><span class="line">- 作用范围：所有模块（文件）</span><br><span class="line">- python中没有块级作用域</span><br><span class="line">  - 块级作用域：代码块中的变量，比如if，while，for后面的代码</span><br><span class="line"></span><br><span class="line">## 【5】四种作用域的规则（LEGB规则）</span><br><span class="line"></span><br><span class="line">- LEGB规则：按照L---&gt;E---&gt;G---&gt;B的顺序查找变量。</span><br><span class="line"></span><br><span class="line">### （1）查看局部变量命令：locals()</span><br><span class="line"></span><br><span class="line">### （2）查看全局变量命令：globals()</span><br><span class="line"></span><br><span class="line">### （3）注意</span><br><span class="line"></span><br><span class="line">- 变量访问规则：从内到外</span><br><span class="line">- 全局变量和局部变量重名时，采用就近原则</span><br><span class="line"></span><br><span class="line">## 【6】综合题</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line"># 定义了一个全局变量G，并把&quot;G全局&quot;赋值给a</span><br><span class="line">a = &quot;G全局&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def myfunc():#</span><br><span class="line">    # 定义了一个局部变量a，并把&quot;E局部1&quot;赋值给a</span><br><span class="line">    a = &quot;E局部&quot;</span><br><span class="line"></span><br><span class="line">    def inner():#翻译：inner内部的</span><br><span class="line">        # 定义了一个局部变量a，并把&quot;L局部2&quot;赋值给a</span><br><span class="line">        a = &quot;L局部2&quot;</span><br><span class="line">        print(f&quot;inner打印的a：&#123;a&#125;&quot;)</span><br><span class="line"></span><br><span class="line">    inner()</span><br><span class="line">    print(f&quot;myfunc打印的a：&#123;a&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">myfunc()</span><br><span class="line">print(f&quot;__main__打印的a：&#123;a&#125;&quot;)</span><br><span class="line"># inner打印的a：L局部2</span><br><span class="line"># myfunc打印的a：E局部</span><br><span class="line"># __main__打印的a：G全局</span><br></pre></td></tr></table></figure>

<h2 id="【7】局部修改全局变量">【7】局部修改全局变量</h2>
```python
name = 'dream'
def func():
    # 在局部修改全局的变量
    # 使用关键字 global 在局部将局部变量的等级提升为全局
    #一般都是用在不可变数据类型身上
    global name
    name = 'opp'
    print(name)
func()#opp
print(name)#opp
```


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.3vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%86%99%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.3vue%E9%A1%B9%E7%9B%AE%E4%B8%AD%E7%9A%84%E5%86%99%E6%B3%95/" class="post-title-link" itemprop="url">3.3vue项目中的写法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>【vue项目中的写法】</h1>
<h2 id="【1】let、const">【1】let、const</h2>
````python
# let :定义变量
# const ：定义常量
------块级作用域----
# var 以后尽量少用，用它声明的都是全局作用域

# 在ES6之前，我们都是用var来声明变量，而且JS只有函数作用域和全局作用域，没有块级作用域，所以{}限定不了var声明变量的访问范围。

# ES6 新增了let命令，用来声明局部变量。它的用法类似于var，但是所声明的变量，只在let命令所在的代码块内有效，而且有暂时性死区的约束


# "暂时性死区"（Temporal Dead Zone，简称 TDZ）是指在 ES6 中使用 let 或 const 声明变量时，变量存在但无法访问的区域。这种行为是为了在 JavaScript 中引入块级作用域而设计的。

# 在 JavaScript 中，使用 var 声明的变量在其声明语句之前就可以被访问，这种行为称为"变量提升"。而在使用 let 或 const 声明变量时，变量虽然存在于作用域中，但是在声明语句之前访问这些变量会导致引发 ReferenceError 异常。
	# 下面是例子	
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="./js2/vue.js"></script>
</head>
<body>

</body>
<script>
    function one(){
        console.log(two)
         var two=76 // 得到的是undefined
         let two=76 // 会报错
    }
    one()
</script>
</html>

# 暂时性死区的产生原因是，let 和 const 声明的变量在进入作用域时就已经被创建，并且被绑定到了该作用域中，但是在变量的声明语句之前，访问这些变量会进入暂时性死区，因为此时变量尚未初始化


# python的LEGB---》查找顺序
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【2】箭头函数</span><br><span class="line"></span><br><span class="line">- 简化了代码</span><br><span class="line">- **想了解细节的话，笔记里面写了**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;````python</span><br><span class="line"># 记住一句话：箭头函数内部没有自己的this---使用上一级</span><br></pre></td></tr></table></figure>

<h2 id="【3】this指向的问题">【3】this指向的问题</h2>
<ul>
<li>
<p>在全局上下文中，this之现象全局对象[可以放值取值]</p>
<ul>
<li>放值取值：<img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240812184134918.png" alt="image-20240812184134918"></li>
</ul>
</li>
<li>
<p>在浏览器环境中通常是window对象，在<code>Node.js</code>中是global对象</p>
</li>
<li>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240812184332118.png" alt="image-20240812184332118"></p>
</li>
<li>
<p>函数调用：</p>
<ul>
<li>
<p>如果函数作为普通函数调用，this指向全局对象（在严格模式下为undefined）</p>
<ul>
<li>
<p>什么是严格模式：是 JavaScript 中的一种运行模式，它通过对语言的某些特性进行限制或改进来帮助开发者写出更安全、更规范的代码</p>
</li>
<li>
````vue
      <script>
          function one(){
              console.log(this)
              // window对象
          }
          one()
      </script>
      <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  - 如果函数作为对象的方法调用，this指向该方法的对象</span><br><span class="line"></span><br><span class="line">    - 尽头函数内部没有this，会往上找</span><br><span class="line"></span><br><span class="line">  &#123;% raw %&#125;```vue</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">      let this_one = &#123;</span><br><span class="line">              name: &quot;jack&quot;,</span><br><span class="line">              age: 18,</span><br><span class="line">              one: () =&gt; &#123;</span><br><span class="line">                  // 这里的this就是window对象</span><br><span class="line">                  console.log(this)</span><br><span class="line">              &#125;,</span><br><span class="line">          two: function()&#123;</span><br><span class="line">                  // 这里的this是one的对象</span><br><span class="line">              console.log(this)</span><br><span class="line">          &#125;</span><br><span class="line">          &#125;</span><br><span class="line">  </span><br><span class="line">      this_one.one()</span><br><span class="line">      this_one.two()</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">  ```</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 只要记住：箭头函数没有this，会往上找，找不到就是window（在严格模式下为undefined）</span><br><span class="line"></span><br><span class="line">- 箭头函数的 this 指向定义时所在的作用域的 this 值，而不是调用时的 this 值。换句话说，箭头函数的 this 是词法作用域，而不是动态作用域</span><br><span class="line"></span><br><span class="line">- 在 ES6 类方法中，this 指向调用该方法的对象实例</span><br><span class="line"></span><br><span class="line">## 【4】模板字符串</span><br><span class="line"></span><br><span class="line">- 插值表达式</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```html</span><br><span class="line">const name = &quot;Alice&quot;;</span><br><span class="line">const age = 25;</span><br><span class="line">const message = `Hello, my name is $&#123;name&#125; and I am $&#123;age&#125; years old.`;</span><br><span class="line">```</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【5】解构赋值</span><br><span class="line"></span><br><span class="line">-  解构赋值允许从数组或对象中提取数据，并将其赋值给变量</span><br><span class="line">-  如果结构的值在对象中没有，就会的到`undefind`，可以赋初值</span><br><span class="line">-  解构赋值可以方便地交换变量的值，同时还支持默认值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```html</span><br><span class="line">&lt;script&gt;</span><br><span class="line">    // 解对象</span><br><span class="line">    let resume=&#123;name:&quot;lsk&quot;,age:18,hobby:[&quot;dance&quot;,&quot;sing&quot;]&#125;</span><br><span class="line">    // 这里必须是个大括号</span><br><span class="line">    // 可以赋初值</span><br><span class="line">    let &#123;name,age,one=666,hobby,two&#125;=resume</span><br><span class="line">    console.log(name) // lsk</span><br><span class="line">    console.log(age) // 18</span><br><span class="line">    // 也可以用作赋值</span><br><span class="line">    console.log(one) // 666</span><br><span class="line">    hobby.pop()</span><br><span class="line">    // 就会将最后一个给pop掉</span><br><span class="line">    console.log(hobby)// [[&quot;dance&quot;]</span><br><span class="line">    console.log(two) // undefined</span><br><span class="line">    </span><br><span class="line">    // 解数组</span><br><span class="line">        let data=[67,11,99]</span><br><span class="line">        let [a,b]=data</span><br><span class="line">        console.log(a) //67</span><br><span class="line">    	console.log(b) //11</span><br><span class="line">    // 结构函数返回值</span><br><span class="line">    	function l()&#123;</span><br><span class="line">        return &#123;name:&quot;lsk&quot;,age:18,hobby:[&quot;dance&quot;,&quot;sing&quot;]&#125;</span><br><span class="line">        &#125;</span><br><span class="line">        let &#123;name,age,hobby&#125;=l()</span><br><span class="line">        console.log(name) // lsk</span><br><span class="line">        console.log(age) // 18</span><br><span class="line">        console.log(hobby) // [&quot;dance&quot;,&quot;sing&quot;]</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">```</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【6】默认参数</span><br><span class="line"></span><br><span class="line">- `ES6` 允许在函数参数中设置默认值，当调用函数时未提供参数时，将使用默认值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;````html</span><br><span class="line">function dom(name,age=22)&#123;</span><br><span class="line">        console.log(name)</span><br><span class="line">        console.log(age)</span><br><span class="line">    &#125;</span><br><span class="line">// 没有传age，使用默认的</span><br><span class="line">dom(&#x27;lsk&#x27;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="【7】展开算法">【7】展开算法</h2>
<ul>
<li>记住展开算法的符号<code>...</code></li>
<li>可以将可迭代对象（如数组，字符串，对象）展开为多个参数或元素，也可以用作函数的参数</li>
</ul>
````python
    // 对象
    let l = {name: "lsk", age: 18}
    let i = {hobby: ["dance", "sing"],...l}
    console.log(i) //{hobby:["dance","sing"],name:"lsk",age:18}
    // 列表
    let l = [1,2,3,4]
    let i = [5,6,7,8,...l]
    console.log(i) // [5,6,7,8,1,2,3,4]
    // 函数
    function l(a,...b){
        console.log(a) // 接受一个值
        console.log(b) // 接收剩下的所有
    }
    // 方法一
    // l(1,2,3,4,5,6,7)
    //方法二
    let i=[1,2,3,4,5,6,7]
    l(...i)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【8】模块化</span><br><span class="line"></span><br><span class="line">### （1）默认导入和导出</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;````javascript</span><br><span class="line">// 创建一个one.js文件 导出</span><br><span class="line">// 定义一个常量</span><br><span class="line">const NAME=&#x27;lsk&#x27;</span><br><span class="line">// 又名函数</span><br><span class="line">function add(a,b)&#123;</span><br><span class="line">    return a+b</span><br><span class="line">&#125;</span><br><span class="line">// 默认的导出对象只能有一个</span><br><span class="line">export default &#123;NAME,add,dmo()&#123;</span><br><span class="line">        console.log(&quot;lsk&quot;)</span><br><span class="line">    &#125;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 在其他的vue的js里面使用</span><br><span class="line">import one from &quot;@/lsk/one&quot;;</span><br><span class="line"></span><br><span class="line">// </span><br><span class="line"></span><br><span class="line">console.log(one.add(1,2))</span><br><span class="line">console.log(one.NAME)</span><br><span class="line">one.dmo()</span><br></pre></td></tr></table></figure>

<h3 id="（2）命名导入导出">（2）命名导入导出</h3>
````javascript
// 命名导出
function dom1(){
    console.log('dom1')
}
function dom2(){
    console.log('dom1')
    dom1()
}
export const f=dom2
export const NAME='lsk'


// 导入
// 方式一
// import {f,NAME} from "@/lsk/one";
// 方式二
import * as a from "@/lsk/one";
// 这个a是一个对象
a.f()
console.log(a.NAME)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### （3）导入路径</span><br><span class="line"></span><br><span class="line">- 如果在一个文件夹下，js的名字为index.js，你只需要导入到这一层的文件就可以</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">import index from &quot;@/lsk&quot;;</span><br><span class="line"></span><br><span class="line">console.log(index.add(1,2))</span><br><span class="line">console.log(index.NAME)</span><br><span class="line">index.dmo()</span><br><span class="line">```</span><br><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- @的意思就是当前的是src文件路径</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;````python</span><br><span class="line"># import index from &quot;@/lsk&quot;; 和 import index from &quot;./lsk/index.js&quot;; 一样</span><br></pre></td></tr></table></figure>

<ul>
<li>定制别名</li>
</ul>
````python
import one from "@/lsk/one";
// 这个import后面的one只是一个你别名，可以自定义定制
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 起别名</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;````python</span><br><span class="line">import &#123;f,NAME as a&#125; from &quot;@/lsk/one&quot;;</span><br><span class="line">// 给NAME起别名叫a</span><br></pre></td></tr></table></figure>

<h3 id="（4）module使用">（4）module使用</h3>
<ul>
<li>这个方法是在html中是使用的</li>
</ul>
```javascript
// 定义一个js文件
export default {
    function dom1(a,b){
    return a+b
	}}


// 在html中使用
// 如果不加上type="module"就会就会报错，加上就不会
<script type="module">
    import lsk from './lsk'
    console.log(lqz.dom1(4,5))
</script>
```


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.3%E9%98%9F%E5%88%97queue/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.3%E9%98%9F%E5%88%97queue/" class="post-title-link" itemprop="url">3.3队列queue</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>队列queue</h1>
<h2 id="【一】介绍">【一】介绍</h2>
<ul>
<li>
<p>queue队列</p>
<ul>
<li>
<p>用法：import queue</p>
</li>
<li>
<p>用法与进程Queue的一样</p>
</li>
</ul>
</li>
</ul>
```python
queue is especially useful in threaded programming when information must be exchanged safely between multiple threads.

当信息必须在多个线程之间安全交换时，队列在线程编程中特别有用。
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- `class queue.Queue(maxsize=0)`先进先出</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">import queue</span><br><span class="line"></span><br><span class="line">q = queue.PriorityQueue(3)</span><br><span class="line">q.put(&#x27;111&#x27;)</span><br><span class="line">q.put(&quot;222&quot;)</span><br><span class="line">q.put(&quot;333&quot;)</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get())</span><br><span class="line"># 输出</span><br><span class="line"># 111</span><br><span class="line"># 222</span><br><span class="line"># 333</span><br></pre></td></tr></table></figure>

<h2 id="【二】补充">【二】补充</h2>
<ul>
<li>同一个进程下的多线程数据是共享的</li>
<li>同一个进程下使用队列的原因就是
<ul>
<li>因为对列是：管道 + 锁</li>
<li>可以确保数据的安全</li>
</ul>
</li>
</ul>
<h2 id="【三】后进后出">【三】后进后出</h2>
<ul>
<li><code>queue.LifoQueue</code></li>
</ul>
```python
import queue
q = queue.LifoQueue(3)
q.put("111")
q.put("222")
q.put("333")
print(q.get())
print(q.get())
print(q.get())
# 输出
# 333
# 222
# 111
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【四】`priorityQueue`设置队列的优先级</span><br><span class="line"></span><br><span class="line">- 数字越小优先级越高</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">import queue</span><br><span class="line"></span><br><span class="line">q = queue.PriorityQueue(3)</span><br><span class="line"># 3代表可以存几个</span><br><span class="line"># 存的数量查过三了取得时候就会阻塞</span><br><span class="line">q.put((10,&quot;222&quot;))</span><br><span class="line">q.put((0,&quot;111&quot;))</span><br><span class="line">q.put((100, &#x27;222&#x27;))</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get())</span><br><span class="line">print(q.get())</span><br><span class="line"># 输出</span><br><span class="line"># (0, &#x27;111&#x27;)</span><br><span class="line"># (10, &#x27;222&#x27;)</span><br><span class="line"># (100, &#x27;222&#x27;)</span><br></pre></td></tr></table></figure>

<h2 id="【五】拓展">【五】拓展</h2>
```python
Constructor for a priority queue. maxsize is an integer that sets the upperbound limit on the number of items that can be placed in the queue. Insertion will block once this size has been reached, until queue items are consumed. If maxsize is less than or equal to zero, the queue size is infinite.

构造一个优先级队列,其中maxsize是一个整数,用于设置可以放入队列的项目数量的上限.一旦达到这个上限，插入就会阻塞，直到队列中有项目被消耗。如果maxsize小于或等于0，则队列长度为无穷大。

The lowest valued entries are retrieved first (the lowest valued entry is the one returned by sorted(list(entries))[0]). A typical pattern for entries is a tuple in the form: (priority_number, data).

首先检索最低值的条目(最低值的条目是指列表经过排序后取到的索引为0的那个元素,一般条目是(优先级数字,数据)这种元组的形式

exception queue.Empty
Exception raised when non-blocking get() (or get_nowait()) is called on a Queue object which is empty.

当表示非阻塞的get()或get_nowait()在一个空的队列对象中被调用时,会抛出异常

exception queue.Full
Exception raised when non-blocking put() (or put_nowait()) is called on a Queue object which is full.

当表示非阻塞的put()或put_nowait()在一个满的队列对象中被调用时,会抛出异常

Queue.qsize()
Queue.empty() #return True if empty  

当队列为空返回True

Queue.full() # return True if full 

当队列为满返回True

Queue.put(item, block=True, timeout=None)
Put item into the queue. If optional args block is true and timeout is None (the default), block if necessary until a free slot is available. If timeout is a positive number, it blocks at most timeout seconds and raises the Full exception if no free slot was available within that time. Otherwise (block is false), put an item on the queue if a free slot is immediately available, else raise the Full exception (timeout is ignored in that case).

将一个项放入队列。如果可选参数block为true并且timeout为None(默认值)，则在必要时阻塞，直到有空闲槽可用。如果参数timeout是一个正数，它最多阻塞timeout秒，如果在这段时间内没有可用的空闲槽，则会引发Full异常。否则(block为false)，如果有空闲槽可用，则将一个项目放入队列中，否则引发Full异常(在这种情况下，timeout被忽略)。

Queue.put_nowait(item)
Equivalent to put(item, False).

Queue.get(block=True, timeout=None)
Remove and return an item from the queue. If optional args block is true and timeout is None (the default), block if necessary until an item is available. If timeout is a positive number, it blocks at most timeout seconds and raises the Empty exception if no item was available within that time. Otherwise (block is false), return an item if one is immediately available, else raise the Empty exception (timeout is ignored in that case).

从队列中移除并返回一个项。如果可选参数block为true并且timeout为None(默认值)，则在必要时阻塞，直到有可用的项。如果timeout为正数，则最多阻塞timeout秒，如果在该时间内没有可用项，则抛出Empty异常。否则(block为false)，如果一个项目可用，则返回那个项目，否则引发Empty异常(在这种情况下，timeout被忽略)。

Queue.get_nowait()
Equivalent to get(False).

Two methods are offered to support tracking whether enqueued tasks have been fully processed by daemon consumer threads.

提供了两种方法来支持追踪进入队列的任务是否已被生产者的守护线程完全处理。

Queue.task_done()
Indicate that a formerly enqueued task is complete. Used by queue consumer threads. For each get() used to fetch a task, a subsequent call to task_done() tells the queue that the processing on the task is complete.

假定先前进入队列的任务已完成。并且被队列生产者使用。对于每个用于获取任务的get()，后续对task_done()的调用都会告诉队列任务的处理已经完成。

If a join() is currently blocking, it will resume when all items have been processed (meaning that a task_done() call was received for every item that had been put() into the queue).

如果join()当前正被阻塞，它将在所有项都被处理完时恢复(这意味着对于每个已经put()到队列中的项都接收到task_done()调用)。

Raises a ValueError if called more times than there were items placed in the queue.

如果调用次数超过放入队列的项数，将引发ValueError。

Queue.join() 

阻塞,直到queue被消费完毕
```


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.4%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.4%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">3.4解决跨域问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>【解决跨域问题】</h1>
<ul>
<li>先这样解决</li>
</ul>
<h2 id="【1】解决跨越问题">【1】解决跨越问题</h2>
<ul>
<li>在django的settings里面配置</li>
</ul>
```python
# 统一按如下方式解决跨域
	-1 安装
    	pip3 install django-cors-headers
    -2 app中注册
        INSTALLED_APPS = [
            。。。
            'corsheaders',
        ]
    -3 中间件中注册
        MIDDLEWARE = [

            'corsheaders.middleware.CorsMiddleware',
        ]
    -4 配置文件中配置
    # 允许跨域源
    CORS_ORIGIN_ALLOW_ALL = True
    # 允许的请求头
    CORS_ALLOW_HEADERS = (
        "accept",
        "accept-encoding",
        "authorization",
        "content-type",
        "dnt",
        "origin",
        "user-agent",
        "x-csrftoken",
        "x-requested-with",

        # 额外允许的请求头
        'token',
    )
```


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.4%E8%BF%9B%E7%A8%8B%E6%B1%A0%EF%BC%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.4%E8%BF%9B%E7%A8%8B%E6%B1%A0%EF%BC%8C%E7%BA%BF%E7%A8%8B%E6%B1%A0/" class="post-title-link" itemprop="url">3.4进程池，线程池</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>进程池</h1>
<ul>
<li><code>from concurrent.futures import ProcessPoolExecutor</code></li>
</ul>
<h2 id="【一】池什么意思">【一】池什么意思</h2>
<ul>
<li>池是</li>
</ul>
<h2 id="【二】TCP实现并发的效果的原理">【二】TCP实现并发的效果的原理</h2>
<ul>
<li>每开设一个客户端，就会有一个服务端服务</li>
</ul>
<h3 id="【1】服务端">【1】服务端</h3>
```python
from socket import *
from threading import Thread


def server_create(IP, PORT):
    server = socket()

    server.bind((IP, PORT))

    server.listen(5)

    while True:
        conn, addr = server.accept()
        t = Thread(target=conn_communication, args=(conn,))


def conn_communication(conn):
    while True:
        try:
            data = conn.recv(1024)
            if len(data) == 0:
                break
            print(data.decode('utf8'))
            conn.send(data.upper())
        except Exception as e:
            print(e)
            break
    conn.close()


def main():
    IP = '127.0.0.1'
    PORT = 8086
    t = Thread(target=server_create, args=(IP, PORT,))
    t.start()


if __name__ == '__main__':
    main()
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 【2】客户端</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from socket import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def client_create(IP, PORT):</span><br><span class="line">    client = socket()</span><br><span class="line"></span><br><span class="line">    client.connect((IP, PORT))</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        word = b&#x27;hello world&#x27;</span><br><span class="line">        client.send(word)</span><br><span class="line"></span><br><span class="line">        msg = client.recv(1024)</span><br><span class="line">        print(msg)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    IP = &#x27;127.0.0.1&#x27;</span><br><span class="line">    PORT = 8086</span><br><span class="line"></span><br><span class="line">    client_create(IP, PORT)</span><br></pre></td></tr></table></figure>

<h3 id="【3】总结">【3】总结</h3>
<ul>
<li>开设多进程或者开设多线程，都消耗资源</li>
<li>开设多线程资源会比开设多进程的消耗的资源少一点</li>
<li>硬件开发速度永远赶不上软件的开发速度</li>
<li>我们的总之就是保证计算机硬件正常工作的情况下最大程度的利用它</li>
</ul>
<h2 id="【三】使用方法">【三】使用方法</h2>
<ul>
<li>开设进程池的进程id不会发生变化</li>
</ul>
```python
import os
from concurrent.futures import ProcessPoolExecutor
import time

# 构造进程池，指定进程总数
pool = ProcessPoolExecutor(5)


# 定义线程任务
def task(n):
    print(n, f'当前进程的进程号:>>>{os.getpid()}')
    print(f"这是线程任务中的 n :>>>> {n}")
    time.sleep(2)
    return n * 2


def many_steps():
    task_list = []
    for i in range(5):
        # 提交任务到进程池，并获取到返回值
        res = pool.submit(task, i)
        print(f'这是 pool的返回值:>>>>{res}')
        # 返回值是一个类对象 - result 方法 ----> 返回异步回调的结果
        # <Future at 0x134d3fcd0 state=pending>
        task_list.append(res)

    # 关闭进程池 - 等待所有的进程池中的任务运行完毕
    pool.shutdown()

    for task_every in task_list:
        print(f'这是 pool的返回值:>>>>{task_every.result()}')  # None
        # 程序由变成了串行
        # res.result() ： 拿到的就是异步提交的任务的返回结果
        # 程序运行的结果是有序的

    print('this is a main task')

if __name__ == '__main__':
    many_steps()
    # 输出
    # 这是 pool的返回值:>>>><Future at 0x1ee74218760 state=running>
    # 这是 pool的返回值:>>>><Future at 0x1ee7421a770 state=running>
    # 这是 pool的返回值:>>>><Future at 0x1ee7421aaa0 state=pending>
    # 这是 pool的返回值:>>>><Future at 0x1ee7421ac20 state=pending>
    # 这是 pool的返回值:>>>><Future at 0x1ee7421ad70 state=pending>
    # 0 当前进程的进程号:>>>28404
    # 这是线程任务中的 n :>>>> 0
    # 1 当前进程的进程号:>>>30176
    # 这是线程任务中的 n :>>>> 1
    # 2 当前进程的进程号:>>>31664
    # 这是线程任务中的 n :>>>> 2
    # 3 当前进程的进程号:>>>27408
    # 这是线程任务中的 n :>>>> 3
    # 4 当前进程的进程号:>>>8476
    # 这是线程任务中的 n :>>>> 4
    # 这是 pool的返回值:>>>>0
    # 这是 pool的返回值:>>>>2
    # 这是 pool的返回值:>>>>4
    # 这是 pool的返回值:>>>>6
    # 这是 pool的返回值:>>>>8
    # this is a main task
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【四】异步回调</span><br><span class="line"></span><br><span class="line">- `add_done_callback(call_back)`</span><br><span class="line">- `add_done_callback(call_back) `返回值正是我们的上面 pool的返回的结果</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">import os</span><br><span class="line">from concurrent.futures import ProcessPoolExecutor</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"># 构造进程池，指定进程总数</span><br><span class="line">pool = ProcessPoolExecutor(5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义线程任务</span><br><span class="line">def task(n):</span><br><span class="line">    print(n, f&#x27;当前进程的进程号:&gt;&gt;&gt;&#123;os.getpid()&#125;&#x27;)</span><br><span class="line">    print(f&quot;这是线程任务中的 n :&gt;&gt;&gt;&gt; &#123;n&#125;&quot;)</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    return n * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义一个异步回调函数</span><br><span class="line">def call_back(n):</span><br><span class="line">    print(f&#x27;call_back&gt;&gt;&gt;:&#123;n&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def many_steps():</span><br><span class="line">    task_list = []</span><br><span class="line">    for i in range(5):</span><br><span class="line">        # 提交任务到进程池，并获取到返回值，添加一个异步回调函数</span><br><span class="line">        res = pool.submit(task, i).add_done_callback(call_back)</span><br><span class="line">        print(f&#x27;这是 pool的返回值:&gt;&gt;&gt;&gt;&#123;res&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    print(&#x27;this is a main task&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    many_steps()</span><br><span class="line">    # 输出</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;None</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;None</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;None</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;None</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;None</span><br><span class="line">    # this is a main task</span><br><span class="line">    # 0 当前进程的进程号:&gt;&gt;&gt;31368</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 1 当前进程的进程号:&gt;&gt;&gt;30908</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 2 当前进程的进程号:&gt;&gt;&gt;20956</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 2</span><br><span class="line">    # 3 当前进程的进程号:&gt;&gt;&gt;30072</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 3</span><br><span class="line">    # 4 当前进程的进程号:&gt;&gt;&gt;19700</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # call_back&gt;&gt;&gt;:&lt;Future at 0x200bcb2e650 state=finished returned int&gt;</span><br><span class="line">    # call_back&gt;&gt;&gt;:&lt;Future at 0x200bcb2c640 state=finished returned int&gt;</span><br><span class="line">    # call_back&gt;&gt;&gt;:&lt;Future at 0x200bcb2ea10 state=finished returned int&gt;</span><br><span class="line">    # call_back&gt;&gt;&gt;:&lt;Future at 0x200bcb2e890 state=finished returned int&gt;</span><br><span class="line">    # call_back&gt;&gt;&gt;:&lt;Future at 0x200bcb2ec20 state=finished returned int&gt;</span><br></pre></td></tr></table></figure>

<h2 id="【五】查看异步回调结果">【五】查看异步回调结果</h2>
```python
import os
from concurrent.futures import ProcessPoolExecutor
import time

# 构造进程池，指定进程总数
pool = ProcessPoolExecutor(5)


# 定义线程任务
def task(n):
    print(n, f'当前进程的进程号:>>>{os.getpid()}')
    print(f"这是线程任务中的 n :>>>> {n}")
    time.sleep(2)
    return n * 2


# 定义一个异步回调函数
def call_back(n):
    print(f'call_back>>>:{n} | 返回的结果为:>>>{n.result()}')


def many_steps():
    task_list = []
    for i in range(5):
        # 提交任务到进程池，并获取到返回值，添加一个异步回调函数
        res = pool.submit(task, i).add_done_callback(call_back)
        print(f'这是 pool的返回值:>>>>{res}')

    print('this is a main task')


if __name__ == '__main__':
    many_steps()
    # 输出
    # 这是 pool的返回值:>>>>None
    # 这是 pool的返回值:>>>>None
    # 这是 pool的返回值:>>>>None
    # 这是 pool的返回值:>>>>None
    # 这是 pool的返回值:>>>>None
    # this is a main task
    # 0 当前进程的进程号:>>>28268
    # 这是线程任务中的 n :>>>> 0
    # 1 当前进程的进程号:>>>23328
    # 这是线程任务中的 n :>>>> 1
    # 2 当前进程的进程号:>>>9768
    # 这是线程任务中的 n :>>>> 2
    # 3 当前进程的进程号:>>>28200
    # 这是线程任务中的 n :>>>> 3
    # 4 当前进程的进程号:>>>8476
    # 这是线程任务中的 n :>>>> 4
    # call_back>>>:<Future at 0x1e3aae1c640 state=finished returned int> | 返回的结果为:>>>0
    # call_back>>>:<Future at 0x1e3aae1ea70 state=finished returned int> | 返回的结果为:>>>6
    # call_back>>>:<Future at 0x1e3aae1e950 state=finished returned int> | 返回的结果为:>>>4
    # call_back>>>:<Future at 0x1e3aae1e650 state=finished returned int> | 返回的结果为:>>>2
    # call_back>>>:<Future at 0x1e3aae1ec80 state=finished returned int> | 返回的结果为:>>>8
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 线程池</span><br><span class="line"></span><br><span class="line">- `from concurrent.futures import ThreadPoolExecutor`</span><br><span class="line"></span><br><span class="line">## 【一】什么是线程池</span><br><span class="line"></span><br><span class="line">- 在应用启动时创建一定数量的线程，并将他们存入线池中，执行任务时，从线程池中获取一个空闲的线程，将任务分配给他，当任务执行完之后再返回线池中，继续执行下一个任务，可以重复利用</span><br><span class="line"></span><br><span class="line">## 【二】原理</span><br><span class="line"></span><br><span class="line">- 池造出来后，里面固定存在五个线程</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"># 默认开设当前计算机 cpu 个数五倍数的线程数</span><br><span class="line"># 可以指定线程总数</span><br><span class="line">pool = ThreadPoolExecutor(5)</span><br></pre></td></tr></table></figure>

<ul>
<li>这五个线程执行的时候不会存在重复创建和销毁的过程</li>
</ul>
<h2 id="【三】优点">【三】优点</h2>
<ul>
<li>避免了重复创建五个线程的重复开销</li>
</ul>
<h2 id="【四】使用方法">【四】使用方法</h2>
<h3 id="【1】同步提交">【1】同步提交</h3>
<ul>
<li>提交任务之后原地等待任务的返回值，期间不会执行任何事情</li>
</ul>
```python
import time
from concurrent.futures import ThreadPoolExecutor
import random

q = ThreadPoolExecutor(4)


def work(i):
    print(f"thread{i} starting.........")
    time.sleep(random.randint(1,4))
    print("thread ending..........")


def main():
    for i in range(1,7):
        q.submit(work, i)
        print("thread main  ending..........")

if __name__ == '__main__':
    main()
    # 输出
    # thread1 starting.........
    # thread main  ending..........
    # thread2 starting.........
    # thread main  ending..........
    # thread3 starting.........
    # thread main  ending..........
    # thread4 starting.........
    # thread main  ending..........
    # thread main  ending..........
    # thread main  ending..........
    # thread ending..........
    # thread5 starting.........
    # thread ending..........
    # thread6 starting.........
    # thread ending..........
    # thread ending..........
    # thread ending..........
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 【2】异步提交</span><br><span class="line"></span><br><span class="line">- 执行任务之后不等待任务任务的返回值，继续执行代码</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor</span><br><span class="line">import time</span><br><span class="line">import random</span><br><span class="line"></span><br><span class="line"># 构造线程池，指定线程总数</span><br><span class="line">pool = ThreadPoolExecutor(5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义线程任务</span><br><span class="line">def work(name):</span><br><span class="line">    print(f&#x27;&#123;name&#125; is starting  pid &#123;os.getpid()&#125; ppid &#123;os.getppid()&#125;... &#x27;)</span><br><span class="line">    sleep_time = random.randint(1, 4)</span><br><span class="line">    print(f&#x27;&#123;name&#125; start sleeping for &#123;sleep_time&#125;s&#x27;)</span><br><span class="line">    time.sleep(sleep_time)</span><br><span class="line">    print(f&#x27;&#123;name&#125; end sleeping for &#123;sleep_time&#125;s&#x27;)</span><br><span class="line">    print(f&#x27;&#123;name&#125; is ending ... &#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def many_steps():</span><br><span class="line">    for i in range(5):</span><br><span class="line">        pool.submit(work, i)</span><br><span class="line">    print(&#x27;this is a main task&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    many_steps()</span><br><span class="line">    # 输出</span><br><span class="line">    # 0 is starting  pid 2952 ppid 3864...</span><br><span class="line">    # 0 start sleeping for 3s</span><br><span class="line">    # 1 is starting  pid 2952 ppid 3864...</span><br><span class="line">    # 1 start sleeping for 4s</span><br><span class="line">    # 2 is starting  pid 2952 ppid 3864...</span><br><span class="line">    # 2 start sleeping for 1s</span><br><span class="line">    # 3 is starting  pid 2952 ppid 3864...</span><br><span class="line">    # 3 start sleeping for 2s</span><br><span class="line">    # 4 is starting  pid 2952 ppid 3864...</span><br><span class="line">    # 4 start sleeping for 3s</span><br><span class="line">    # this is a main task</span><br><span class="line">    # 2 end sleeping for 1s</span><br><span class="line">    # 2 is ending ...</span><br><span class="line">    # 3 end sleeping for 2s</span><br><span class="line">    # 3 is ending ...</span><br><span class="line">    # 0 end sleeping for 3s</span><br><span class="line">    # 0 is ending ...</span><br><span class="line">    # 4 end sleeping for 3s</span><br><span class="line">    # 4 is ending ...</span><br><span class="line">    # 1 end sleeping for 4s</span><br><span class="line">    # 1 is ending ...</span><br></pre></td></tr></table></figure>

<h3 id="【3】异步返回值">【3】异步返回值</h3>
<h4 id="1-查看异步回调对象">(1)查看异步回调对象</h4>
```python
from concurrent.futures import ThreadPoolExecutor
import time
import random

# 构造线程池，指定线程总数
pool = ThreadPoolExecutor(5)


# 定义线程任务
def work(name):
    print(f'{name} is starting  pid {os.getpid()} ppid {os.getppid()}... ')
    sleep_time = random.randint(1, 4)
    time.sleep(sleep_time)
    print(f'{name} is ending ... ')
    return name * name




def many_steps():
    for i in range(5):
        res = pool.submit(work, i)
        print('this is a main task')
        print(res.result())


if __name__ == '__main__':
    many_steps()
    # 输出
    # 0 is starting  pid 1600 ppid 3864... 
    # this is a main task
    # 
    # 0 is ending ... 
    # 0
    # this is a main task
    # 1 is starting  pid 1600 ppid 3864... 
    # 1 is ending ... 
    # 1
    # this is a main task
    # 2 is starting  pid 1600 ppid 3864... 
    # 2 is ending ... 
    # 4
    # this is a main task
    # 3 is starting  pid 1600 ppid 3864... 
    # 3 is ending ... 
    # 9
    # this is a main task
    # 4 is starting  pid 1600 ppid 3864... 
    # 4 is ending ... 
    # 16
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#### (2)调用异步回调对象</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor</span><br><span class="line">import time</span><br><span class="line"></span><br><span class="line"># 构造线程池，指定线程总数</span><br><span class="line">pool = ThreadPoolExecutor(5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 定义线程任务</span><br><span class="line">def task(n):</span><br><span class="line">    print(f&quot;这是线程任务中的 n :&gt;&gt;&gt;&gt; &#123;n&#125;&quot;)</span><br><span class="line">    time.sleep(2)</span><br><span class="line">    return n * 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def many_steps():</span><br><span class="line">    task_list = []</span><br><span class="line">    for i in range(5):</span><br><span class="line">        # 提交任务到线程池，并获取到返回值</span><br><span class="line">        res = pool.submit(task, i)</span><br><span class="line">        print(f&#x27;这是 pool的返回值:&gt;&gt;&gt;&gt;&#123;res&#125;&#x27;)</span><br><span class="line">        # 返回值是一个类对象 - result 方法 ----&gt; 返回异步回调的结果</span><br><span class="line">        # &lt;Future at 0x134d3fcd0 state=pending&gt;</span><br><span class="line">        task_list.append(res)</span><br><span class="line"></span><br><span class="line">    for task_every in task_list:</span><br><span class="line">        print(f&#x27;这是 pool的返回值:&gt;&gt;&gt;&gt;&#123;task_every.result()&#125;&#x27;)  # None</span><br><span class="line">        # 程序由变成了串行</span><br><span class="line">        # res.result() ： 拿到的就是异步提交的任务的返回结果</span><br><span class="line">        # 程序运行的结果是有序的</span><br><span class="line">    print(&#x27;this is a main task&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    many_steps()</span><br><span class="line">    # 输出</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;&lt;Future at 0x1c5fc937f70 state=running&gt;</span><br><span class="line">    # </span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;&lt;Future at 0x1c5fca4de10 state=running&gt;</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 2</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;&lt;Future at 0x1c5fca4e0b0 state=running&gt;</span><br><span class="line">    # </span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 3</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;&lt;Future at 0x1c5fca4e3b0 state=running&gt;</span><br><span class="line">    # 这是线程任务中的 n :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;&lt;Future at 0x1c5fca4e6b0 state=running&gt;</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;0</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;2</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;4</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;6</span><br><span class="line">    # 这是 pool的返回值:&gt;&gt;&gt;&gt;8</span><br><span class="line">    # this is a main task</span><br></pre></td></tr></table></figure>

<h3 id="【4】pool-shutdown">【4】<code>pool.shutdown()</code></h3>
<ul>
<li>等所有子进程结束之后,在打印程序运行结果</li>
</ul>
```python
from concurrent.futures import ThreadPoolExecutor
import time

# 构造线程池，指定线程总数
pool = ThreadPoolExecutor(5)


# 定义线程任务
def task(n):
    print(f"这是线程任务中的 n :>>>> {n}")
    time.sleep(2)
    return n * 2


def many_steps():
    task_list = []
    for i in range(5):
        # 提交任务到线程池，并获取到返回值
        res = pool.submit(task, i)
        print(f'这是 pool的返回值:>>>>{res}')
        # 返回值是一个类对象 - result 方法 ----> 返回异步回调的结果
        # <Future at 0x134d3fcd0 state=pending>
        task_list.append(res)
    pool.shutdown()

    for task_every in task_list:
        print(f'这是 pool的返回值:>>>>{task_every.result()}')  # None
        # 程序由变成了串行
        # res.result() ： 拿到的就是异步提交的任务的返回结果
        # 程序运行的结果是有序的
    print('this is a main task')


if __name__ == '__main__':
    many_steps()
    # 输出
    # 这是线程任务中的 n :>>>> 0
    # 这是 pool的返回值:>>>><Future at 0x22cd8167f70 state=running>
    # 
    # 这是线程任务中的 n :>>>> 1
    # 这是 pool的返回值:>>>><Future at 0x22cd824de70 state=running>
    # 这是线程任务中的 n :>>>> 2
    # 这是 pool的返回值:>>>><Future at 0x22cd824e110 state=running>
    # 
    # 这是线程任务中的 n :>>>> 3
    # 这是 pool的返回值:>>>><Future at 0x22cd824e410 state=running>
    # 这是线程任务中的 n :>>>> 4
    # 这是 pool的返回值:>>>><Future at 0x22cd824e740 state=running>
    # 
    # 这是 pool的返回值:>>>>0
    # 这是 pool的返回值:>>>>2
    # 这是 pool的返回值:>>>>4
    # 这是 pool的返回值:>>>>6
    # 这是 pool的返回值:>>>>8
    # this is a main task
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 总结</span><br><span class="line"></span><br><span class="line">## 【一】进程池模版</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line"># 导入模块</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"># 构建线程池或进程池</span><br><span class="line">pool_process = ProcessPoolExecutor(5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 构造异步任务</span><br><span class="line">def task(n):</span><br><span class="line">    print(f&#x27;这是异步传进来的参数 n :&gt;&gt;&gt;&gt; &#123;n&#125;&#x27;)</span><br><span class="line">    return n ** 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main_process():</span><br><span class="line">    task_result_list = []</span><br><span class="line">    for i in range(5):</span><br><span class="line">        # 提交任务</span><br><span class="line">        result = pool_process.submit(task, i)</span><br><span class="line">        print(f&#x27;这是异步 &#123;i&#125; 调用的返回结果 :&gt;&gt;&gt;&gt; &#123;result&#125;&#x27;)</span><br><span class="line">        # 提交线程任务结果</span><br><span class="line">        task_result_list.append(result)</span><br><span class="line"></span><br><span class="line">    #  关闭进程池，等待进程池中所有的任务完成</span><br><span class="line">    pool_process.shutdown()</span><br><span class="line"></span><br><span class="line">    # 逐个获取到异步迭代的结果</span><br><span class="line">    for task_every in task_result_list:</span><br><span class="line">        print(f&#x27;这是异步调用的返回结果 :&gt;&gt;&gt;&gt; &#123;task_every.result()&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main_process()</span><br><span class="line"></span><br><span class="line">    # 这是异步 0 调用的返回结果 :&gt;&gt;&gt;&gt; &lt;Future at 0x211cf34c880 state=running&gt;</span><br><span class="line">    # 这是异步 1 调用的返回结果 :&gt;&gt;&gt;&gt; &lt;Future at 0x211cf34e890 state=running&gt;</span><br><span class="line">    # 这是异步 2 调用的返回结果 :&gt;&gt;&gt;&gt; &lt;Future at 0x211cf34ebc0 state=pending&gt;</span><br><span class="line">    # 这是异步 3 调用的返回结果 :&gt;&gt;&gt;&gt; &lt;Future at 0x211cf34ec50 state=pending&gt;</span><br><span class="line">    # 这是异步 4 调用的返回结果 :&gt;&gt;&gt;&gt; &lt;Future at 0x211cf34ee60 state=pending&gt;</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 2</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 3</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # 这是异步调用的返回结果 :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 这是异步调用的返回结果 :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 这是异步调用的返回结果 :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # 这是异步调用的返回结果 :&gt;&gt;&gt;&gt; 9</span><br><span class="line">    # 这是异步调用的返回结果 :&gt;&gt;&gt;&gt; 16</span><br></pre></td></tr></table></figure>

<h2 id="【二】线程池模版">【二】线程池模版</h2>
```python
# 导入模块
from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor

# 构建线程池或进程池
pool_thread = ThreadPoolExecutor(5)


# 构造异步任务
def task(n):
    print(f'这是异步传进来的参数 n :>>>> {n}')
    return n ** 2

def main_thread():
    task_result_list = []
    for i in range(5):
        # 提交任务
        result = pool_thread.submit(task, i)
        print(f'这是异步 {i} 调用的返回结果 :>>>> {result}')
        task_result_list.append(result)

    #  关闭进程池，等待进程池中所有的任务完成
    pool_process.shutdown()

    # 逐个获取到异步迭代的结果
    for task_every in task_result_list:
        print(f'这是异步调用的返回结果 :>>>> {task_every.result()}')


if __name__ == '__main__':

    main_thread()

    # 这是异步传进来的参数 n :>>>> 0
    # 这是异步 0 调用的返回结果 :>>>> <Future at 0x12e30ead0 state=finished returned int>
    # 这是异步 1 调用的返回结果 :>>>> <Future at 0x12e30f190 state=pending>
    # 这是异步传进来的参数 n :>>>> 1
    # 这是异步 2 调用的返回结果 :>>>> <Future at 0x12e30f790 state=pending>
    # 这是异步传进来的参数 n :>>>> 2
    # 这是异步传进来的参数 n :>>>> 3
    # 这是异步 3 调用的返回结果 :>>>> <Future at 0x12e33a3e0 state=finished returned int>
    # 这是异步 4 调用的返回结果 :>>>> <Future at 0x12e30f4c0 state=pending>
    # 这是异步调用的返回结果 :>>>> 0
    # 这是异步调用的返回结果 :>>>> 1
    # 这是异步调用的返回结果 :>>>> 4
    # 这是异步调用的返回结果 :>>>> 9
    # 这是异步传进来的参数 n :>>>> 4
    # 这是异步调用的返回结果 :>>>> 16
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【三】回调函数模版</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line"># 导入模块</span><br><span class="line">from concurrent.futures import ThreadPoolExecutor, ProcessPoolExecutor</span><br><span class="line"></span><br><span class="line"># 构建线程池或进程池</span><br><span class="line">pool_process = ProcessPoolExecutor(5)</span><br><span class="line">pool_thread = ThreadPoolExecutor(5)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 构造异步任务</span><br><span class="line">def task(n):</span><br><span class="line">    print(f&#x27;这是异步传进来的参数 n :&gt;&gt;&gt;&gt; &#123;n&#125;&#x27;)</span><br><span class="line">    return n ** 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># 构造异步调用函数</span><br><span class="line">def call_back(n):</span><br><span class="line">    print(f&#x27;这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; &#123;n.result()&#125;&#x27;)</span><br><span class="line">    return n.result() ** 2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main_process():</span><br><span class="line">    for i in range(5):</span><br><span class="line">        # 提交任务</span><br><span class="line">        result_call_back = pool_process.submit(task, i).add_done_callback(call_back)</span><br><span class="line">        print(f&#x27;这是异步 &#123;i&#125; 调用的返回结果 :&gt;&gt;&gt;&gt; &#123;result_call_back&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def main_thread():</span><br><span class="line">    for i in range(5):</span><br><span class="line">        # 提交任务</span><br><span class="line">        result_call_back = pool_thread.submit(task, i).add_done_callback(call_back)</span><br><span class="line">        print(f&#x27;这是异步 &#123;i&#125; 调用的返回结果 :&gt;&gt;&gt;&gt; &#123;result_call_back&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    main_process()</span><br><span class="line"></span><br><span class="line">    # 这是异步 0 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步 1 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步 2 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步 3 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步 4 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 2</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 3</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 9</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 16</span><br><span class="line"></span><br><span class="line">    # main_thread()</span><br><span class="line"></span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 0</span><br><span class="line">    # 这是异步 0 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步 1 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 1</span><br><span class="line">    # 这是异步 2 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 2</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 3</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 9</span><br><span class="line">    # 这是异步 3 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # 这是异步 4 调用的返回结果 :&gt;&gt;&gt;&gt; None</span><br><span class="line">    # 这是异步传进来的参数 n :&gt;&gt;&gt;&gt; 4</span><br><span class="line">    # 这是异步调用函数中接收到的 :&gt;&gt;&gt;&gt; 16</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.6IO%E6%A8%A1%E5%9E%8B%E7%AE%80%E4%BB%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.6IO%E6%A8%A1%E5%9E%8B%E7%AE%80%E4%BB%8B/" class="post-title-link" itemprop="url">3.6IO模型简介</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>【零】IO模型简介</h1>
<ul>
<li>
<p>我们研究的 IO 都是基于网络 IO 的</p>
</li>
<li>
<p>Stevens在文章中一共比较了五种IO Model：</p>
</li>
<li>
<ul>
<li><em>blocking IO</em></li>
<li>nonblocking IO</li>
<li><em>IO multiplexing</em></li>
<li>signal driven IO —（忽略）</li>
<li>asynchronous IO 由signal driven IO（信号驱动IO）在实际中并不常用，所以主要介绍其余四种IO Model。</li>
</ul>
</li>
<li>
<p>当一个read操作发生时，该操作会经历两个阶段：</p>
</li>
<li>
<ul>
<li>1、等待数据准备 (Waiting for the data to be ready)</li>
<li>2、将数据从内核拷贝到进程中(Copying the data from the kernel to the process)</li>
</ul>
</li>
<li>
<p>同步</p>
</li>
<li>
<ul>
<li>在同步模式下，一个组件必须等待另一个组件完成某个操作，然后再进行下一个操作。</li>
</ul>
</li>
<li>
<p>异步</p>
</li>
<li>
<ul>
<li>在异步模式下，组件之间互不干扰，它们可以独立地执行任务。当一个组件完成任务后，它可以直接通知另一个组件继续执行操作。</li>
</ul>
</li>
<li>
<p>阻塞</p>
</li>
<li>
<ul>
<li>在阻塞模式下，一个进程或线程在执行某个操作时，如果该操作没有完成，它将立即停止一切操作，并等待操作完成后再继续进行后续操作。</li>
</ul>
</li>
<li>
<p>非阻塞</p>
</li>
<li>
<ul>
<li>在非阻塞模式下，一个进程或线程在执行某个操作时，即使该操作没有完成，也会立即返回执行下一个操作，不会出现停滞等待的情况。 如果下一个操作需要依赖于上一个还未完成的操作，它将定期检查上一个操作是否完成，保证这些未完成的操作不会影响后续任务的执行。</li>
</ul>
</li>
<li>
<p>常见的网络IO</p>
</li>
<li>
<ul>
<li>accept</li>
<li>recv</li>
<li>recvfrom</li>
</ul>
</li>
</ul>
<h1>【一】阻塞IO模型</h1>
<p>我们之前写的都是阻塞 IO 模型 （协程除外）</p>
<h2 id="【1】TCP-UDP协议模型">【1】TCP/UDP协议模型</h2>
<p><a target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2322215/202306/2322215-20230630215817953-1689712558.png"><img src="http://zhaochunze.dream521.site/2322215-20230630215817953-1689712558.png" alt="img"></a></p>
<h2 id="【2】TCP-经典IO">【2】TCP 经典IO</h2>
<ul>
<li>客户端</li>
</ul>
```python
from socket import *

client = socket()

IP = '127.0.0.1'
PORT = 8083
client.connect((IP, PORT))

while True:
    msg_to_server = 'hello world'
    msg_to_server = msg_to_server.encode('utf-8')

    client.send(msg_to_server)

    msg_from_server = client.recv(1024)
    msg_from_server = msg_from_server.decode('utf-8')

    print(msg_from_server)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 服务端</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from socket import *</span><br><span class="line"></span><br><span class="line">server = socket()</span><br><span class="line"></span><br><span class="line">IP = &#x27;127.0.0.1&#x27;</span><br><span class="line">PORT = 8082</span><br><span class="line">server.bind((IP, PORT))</span><br><span class="line"></span><br><span class="line">server.listen(5)</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    conn, addr = server.accept()</span><br><span class="line"></span><br><span class="line">    while True:</span><br><span class="line">        try:</span><br><span class="line">            msg_from_client = conn.recv(1024)</span><br><span class="line"></span><br><span class="line">            if len(msg_from_client) == 0:</span><br><span class="line">                break</span><br><span class="line"></span><br><span class="line">            print(msg_from_client.decode(&#x27;utf8&#x27;))</span><br><span class="line"></span><br><span class="line">            conn.send(msg_from_client.upper())</span><br><span class="line"></span><br><span class="line">        except  Exception as e:</span><br><span class="line">            print(e)</span><br><span class="line">            break</span><br><span class="line"></span><br><span class="line">    conn.close()</span><br></pre></td></tr></table></figure>

<ul>
<li>问题：服务端只能接待一个客户端</li>
</ul>
<h2 id="【3】问题解决方案">【3】问题解决方案</h2>
<ul>
<li>在服务端开设多进程或多线程，进程池线程池，以此来解决IO问题</li>
<li>但是还没在根本上解决IO问题</li>
<li>因为在服务端 虽然解决了 请求数据这部分的IO 但是没有从根本上解决 向内核要数据和拷贝数据给客户端这个IO</li>
</ul>
<h1>【二】非阻塞IO模型</h1>
<ul>
<li>将所有的阻塞操作变为非阻塞</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2322215/202306/2322215-20230630215827590-2025602751.png"><img src="http://zhaochunze.dream521.site/2322215-20230630215827590-2025602751.png" alt="img"></a></p>
<h2 id="【1】TCP-非阻塞经典IO">【1】TCP 非阻塞经典IO</h2>
<ul>
<li>服务端</li>
</ul>
```python
from socket import *
import time

server = socket()

IP = '127.0.0.1'
PORT = 8083
server.bind((IP, PORT))

server.listen(5)

# 将所有的网络阻塞 变为 非阻塞
# BlockingIOError: [WinError 10035] 无法立即完成一个非阻止性套接字操作。 ---- 表示服务端并没有立即建立链接，导致了资源无法接收
server.setblocking(False)

conn_list = []
del_conn_list = []
while True:
    try:
        conn, addr = server.accept()
        conn_list.append(conn)

    # 检测进程资源利用错误
    except BlockingIOError as e:
        print(f'当前无阻塞,可进行其他工作')
        for conn in conn_list:
            try:
                data_from_client = conn.recv(1024)  # 没有消息则报错
                if len(data_from_client) == 0:
                    # 如果接收到的消息为 0  则表示当前链接无效：关闭当前链接
                    conn.close()  # （客户端断开连接）
                    # 将无用的conn链接从链接列表中删除掉
                    del_conn_list.append(conn)  # (将无用的链接放到无用的链接列表里)
                    continue
                    
                # 链接对象正常：反馈消息给客户端
                conn.send(data_from_client.upper())
            # 检测进程资源利用错误
            except BlockingIOError as e:
                # 查看其他链接对象是否有消息发过来
                continue

            # 检测到客户端断开链接错误
            except ConnectionError as e:
                # 断开链接
                conn.close()
                # 将无效的链接添加到废弃列表里
                del_conn_list.append(conn)

        # 回收无用的链接对象
        for conn in del_conn_list:
            # 在有效列表内删除无效的链接对象
            conn_list.remove(conn)

        # 清空无效链接列表
        del_conn_list.clear()
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 客户端</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from socket import *</span><br><span class="line"></span><br><span class="line">client = socket()</span><br><span class="line"></span><br><span class="line">IP = &#x27;127.0.0.1&#x27;</span><br><span class="line">PORT = 8083</span><br><span class="line">client.connect((IP, PORT))</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    msg_to_server = &#x27;hello world&#x27;</span><br><span class="line">    msg_to_server = msg_to_server.encode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">    client.send(msg_to_server)</span><br><span class="line"></span><br><span class="line">    msg_from_server = client.recv(1024)</span><br><span class="line">    msg_from_server = msg_from_server.decode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">    print(msg_from_server)</span><br></pre></td></tr></table></figure>

<h2 id="【2】总结">【2】总结</h2>
<ul>
<li>
<p>虽然非阻塞 IO 看起来十分优秀</p>
</li>
<li>
<ul>
<li>但是该模型会长时间占用 CPU 而不处理数据（大部分资源都浪费在反复发起请求 请求数据上）</li>
</ul>
</li>
<li>
<p>实际应用中不会考虑使用非阻塞 IO 模型</p>
</li>
<li>
<ul>
<li>占用资源严重</li>
</ul>
</li>
</ul>
<h1>【三】IO多路复用</h1>
<h2 id="【1】什么是IO多路复用">【1】什么是IO多路复用</h2>
<p><a target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2322215/202306/2322215-20230630215838477-64289328.png"><img src="http://zhaochunze.dream521.site/2322215-20230630215838477-64289328.png" alt="img"></a></p>
<ul>
<li>
<p>当监管的对象只有一个的时候，其实IO多路复用连阻塞IO的功能都比不上</p>
</li>
<li>
<p>但是IO多路复用一次性可以监管多个对象</p>
</li>
<li>
<ul>
<li>server = socket.socket()</li>
<li>conn, addr = socket.accept()</li>
</ul>
</li>
<li>
<p>这个监管机制是由操作系统本身就存在的（select）</p>
</li>
<li>
<p>如果使用需要导入相关的模块（select模块）</p>
</li>
</ul>
<h2 id="【2】基于-select模块解决-IO-阻塞">【2】基于 select模块解决 IO 阻塞</h2>
<ul>
<li>客户端</li>
</ul>
```python
from socket import *
import select

server = socket()

IP = '127.0.0.1'
PORT = 8083
server.bind((IP, PORT))
server.listen(5)

# 将阻塞模型变为非阻塞模型
server.setblocking(False)

# 将监管目标(谁来发起链接)添加到监管列表
read_list = [server]

while True:
    r_list, w_list, x_list = select.select(read_list, [], [])  # 检测server端
    # 返回值（server对象,[],[]） ： ([<socket.socket fd=408, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('127.0.0.1', 8083)>], [], [])
    # 一旦有链接发起，直接拿到监管链接

    # 循环拿到每一个发起的链接对象
    for i in r_list:
        '''
        针对不同的对象进行分类处理
        '''

        # 如果是服务对象就将其添加到服务列表内，再次确认
        if i is server:
            # 拿到每一个链接对象
            conn, addr = i.accept()

            # 将链接对象添加到监管机制中
            read_list.append(conn)
        else:
            # 如果是链接请求就拿到客户端发起的数据
            msg_from_client = i.recv(1024)
            if len(res) == 0:
                # 关闭无效链接
                i.close()

                # 将无效链接从列表中移除
                read_list.remove(i)
                continue
            msg_from_client = msg_from_client.decode('utf-8')
            print(msg_from_client)

            # 反馈信息给客户端
            i.send(msg_from_client.upper())
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 服务端</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from socket import *</span><br><span class="line"></span><br><span class="line">client = socket()</span><br><span class="line"></span><br><span class="line">IP = &#x27;127.0.0.1&#x27;</span><br><span class="line">PORT = 8083</span><br><span class="line">client.connect((IP, PORT))</span><br><span class="line"></span><br><span class="line">while True:</span><br><span class="line">    msg_to_server = &#x27;hello world&#x27;</span><br><span class="line">    msg_to_server = msg_to_server.encode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">    client.send(msg_to_server)</span><br><span class="line"></span><br><span class="line">    msg_from_server = client.recv(1024)</span><br><span class="line">    msg_from_server = msg_from_server.decode(&#x27;utf-8&#x27;)</span><br><span class="line"></span><br><span class="line">    print(msg_from_server)</span><br></pre></td></tr></table></figure>

<h2 id="【3】总结">【3】总结</h2>
<ul>
<li>
<p>监管机制有很多</p>
</li>
<li>
<p>select机制</p>
</li>
<li>
<ul>
<li>Windows/Mac 都有</li>
</ul>
</li>
<li>
<p>poll机制</p>
</li>
<li>
<ul>
<li>只有Linux有</li>
<li>poll 和 select 机制都可以监管多个对象，但是 poll监管的对象更多</li>
</ul>
</li>
</ul>
<p>上述两个机制都不是很完美</p>
<p>当监管的对象特别多的时候，可能会出现机器大的延迟响应</p>
<ul>
<li>
<p>epoll机制</p>
</li>
<li>
<ul>
<li>只在 Linux 机制有</li>
<li>给每个监管对象都绑定了一个回调机制</li>
<li>一旦有响应，回调机制会立刻发起提醒</li>
</ul>
</li>
</ul>
<p>针对不同的操作系统，需要考虑不同的监管机制，太过麻烦</p>
<p>因此有了一个新的模块（selectors模块）</p>
<p>根据平台的不同而自动选择不同的机制</p>
<h1>【四】异步IO</h1>
<ul>
<li>异步IO 是所有模型中效率最高的，也是使用最广泛的</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2322215/202309/2322215-20230921090343398-1608144674.png"><img src="http://zhaochunze.dream521.site/2322215-20230921090343398-1608144674.png" alt="img"></a></p>
<ul>
<li>
<p>由于涉及到调用操作系统底层，我们只能通过C语言代码才能模拟出效果</p>
</li>
<li>
<p>但是，有相关大佬已经帮我们将相关的方法进行了封装</p>
</li>
<li>
<p>模块</p>
</li>
<li>
<ul>
<li>asyncio 模块</li>
</ul>
</li>
<li>
<p>异步框架</p>
</li>
<li>
<ul>
<li>sanic</li>
<li>tronado</li>
<li>twisted</li>
</ul>
</li>
</ul>
<h2 id="【1】asyncio-模块安装">【1】asyncio 模块安装</h2>
```shell
pip install asyncio
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【2】方法示例</span><br><span class="line"></span><br><span class="line">- 单线程实现并发效果</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">import threading</span><br><span class="line">import asyncio</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">async def hello():</span><br><span class="line">    print(f&#x27;hello world statr:&gt;&gt;&#123;threading.current_thread()&#125;&#x27;)</span><br><span class="line"></span><br><span class="line">    await asyncio.sleep(1)  # 真正的 IO 操作 ---- 交互时操作 / 响应式操作</span><br><span class="line"></span><br><span class="line">    print(f&#x27;hello world end:&gt;&gt;&gt;&#123;threading.current_thread()&#125;&#x27;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">loop = asyncio.get_event_loop()</span><br><span class="line">tasks = [hello(), hello()]</span><br><span class="line">loop.run_until_complete(asyncio.wait(tasks))</span><br><span class="line"></span><br><span class="line">loop.close()</span><br><span class="line"></span><br><span class="line"># 单线程实现并发效果</span><br><span class="line"></span><br><span class="line"># hello world statr:&gt;&gt;&lt;_MainThread(MainThread, started 8005963776)&gt;</span><br><span class="line"># hello world statr:&gt;&gt;&lt;_MainThread(MainThread, started 8005963776)&gt;</span><br><span class="line"># hello world end:&gt;&gt;&gt;&lt;_MainThread(MainThread, started 8005963776)&gt;</span><br><span class="line"># hello world end:&gt;&gt;&gt;&lt;_MainThread(MainThread, started 8005963776)&gt;</span><br></pre></td></tr></table></figure>

<h1>【五】IO总结</h1>
<ul>
<li>四个IO模型对比</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://img2023.cnblogs.com/blog/2322215/202306/2322215-20230630215852336-1714846496.jpg"><img src="http://zhaochunze.dream521.site/2322215-20230630215852336-1714846496.jpg" alt="img"></a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/4.0Django%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8%E4%B9%8BORM%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/4.0Django%E6%A1%86%E6%9E%B6%E5%85%A5%E9%97%A8%E4%B9%8BORM%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">4.0Django框架入门之ORM操作</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>ORM迁移数据库</h1>
<h2 id="【一】什么是ORM">【一】什么是ORM</h2>
<ul>
<li>ORM是一种对象与关系型数据库之间的映射关系，主要实现了一下三个方面的功能
<ul>
<li>数据库中的映射为数据库中的类</li>
<li>数据库中的字段映射为python中的属性</li>
<li>数据库中的记录映射为python中的实例</li>
</ul>
</li>
<li>ORM的主要优点是可以减少开发人员编写重复的SQL语句的时间和工作量，并且可以减少由于SQL语句的调整和更改所带来的错误。</li>
</ul>
<h2 id="【二】Django-ORM的特点">【二】Django ORM的特点</h2>
<p>API：应用程序接口，指两个不同软件应用之间进行交互的一组方法</p>
<ul>
<li>与其他ORM框架相比，Django ORM拥有以下优点：</li>
<li>简单易用：Django ORM的API非常简单，易于掌握和使用。</li>
<li>丰富的API：Django ORM提供了丰富的API来完成常见的数据库操作，如增删改查等，同时也支持高级查询和聚合查询等操作。</li>
<li>具有良好的扩展性：Django ORM可以与其他第三方库进行无缝集成，如Django REST framework、Django-Oscar等。</li>
<li>自动映射：Django ORM支持自动映射，开发者只需要定义数据库表的结构，就可以自动生成相应的Python类，从而减少开发过程中的重复代码量</li>
</ul>
<h2 id="【三】创建数据库模型表">【三】创建数据库模型表</h2>
<h3 id="【1】定义模型表">【1】定义模型表</h3>
```python
# 创建一个类 继承models.Model
# CharField ：字符串类型
class UserInfo(models.Model):
    username = models.CharField(max_length=32,
                                verbose_name="用户名")
    # max_length:字符串的最大长度
    # verbose_name：注解--》相同与数据库里的comment
    password = models.CharField(max_length=28,
                                verbose_name="密码")
    age = models.IntegerField(verbose_name="年龄")
    # IntegerField：int类型
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 【2】创建表</span><br><span class="line"></span><br><span class="line">- CharField 字符串类型字段</span><br><span class="line">- IntegerField 数字类型字段</span><br><span class="line"></span><br><span class="line">#### （1）`python manage.py makemigrations`</span><br><span class="line"></span><br><span class="line">- 将定义的Django模型表转换为SQL语句</span><br><span class="line"></span><br><span class="line">#### （2）`python manage.py migrate`</span><br><span class="line"></span><br><span class="line">- SQL语句写入到数据库中</span><br><span class="line"></span><br><span class="line">#### （3）执行方法</span><br><span class="line"></span><br><span class="line">- 创建表的同时你要在settings.py文件中连接数据,不然会报错</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line"># 换成mysql数据库</span><br><span class="line">DATABASES = &#123;</span><br><span class="line">    &#x27;default&#x27;: &#123;</span><br><span class="line">        # mysql引擎</span><br><span class="line">        &#x27;ENGINE&#x27;: &#x27;django.db.backends.mysql&#x27;,</span><br><span class="line">        # 数据库IP地址</span><br><span class="line">        &quot;HOST&quot;: &quot;127.0.0.1&quot;,</span><br><span class="line">        # 数据库端口</span><br><span class="line">        &quot;POST&quot;: 3306,</span><br><span class="line">        # 数据库登入名</span><br><span class="line">        &quot;USER&quot;: &quot;root&quot;,</span><br><span class="line">        # 数据库密码</span><br><span class="line">        &quot;PASSWORD&quot;: &quot;1234567&quot;,</span><br><span class="line">        # 数据库名字--&gt;不要用DATABASE,用NAME</span><br><span class="line">        &quot;NAME&quot;: &quot;&quot;,</span><br><span class="line">        # 数据库编码格式</span><br><span class="line">        &quot;CHARSET&quot;: &quot;utf8mb4&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>
<p>打开pycharm中的Tools里面的运行manage.py任务</p>
</li>
<li>
<p>在控制台输入<code>makemigrations</code>,点击回车—》将Django的模型表映射成SQL语句，APP文件下的<code>migrations</code>就多东西</p>
</li>
<li>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240619195529055.png" alt="image-20240619195529055"></p>
</li>
<li>
<p>创建成功会出现一下数据</p>
</li>
</ul>
```shell
D:\pycharm\python310\python.exe "D:\pycharm\PyCharm 2023.3.4\plugins\python\helpers\pycharm\django_manage.py" makemigrations D:/pycharm/project/Django练习/first_django
Tracking file by folder pattern:  migrations
Migrations for 'user':
  user\migrations\0001_initial.py
  # 这里创建了一个UserInfo的一张表
    - Create model UserInfo

Following files were affected 
 D:\pycharm\project\Django练习\first_django\user\migrations\0001_initial.py
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 创建好了之后你在你的数据库还是看不到的</span><br><span class="line"></span><br><span class="line">- 需要在终端执行migrate命令才行</span><br><span class="line">- 执行完之后会，出现以下信息</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```shell</span><br><span class="line">manage.py@first_django &gt; migrate</span><br><span class="line">D:\pycharm\python310\python.exe &quot;D:\pycharm\PyCharm 2023.3.4\plugins\python\helpers\pycharm\django_manage.py&quot; migrate D:/pycharm/project/Django练习/first_django</span><br><span class="line">Tracking file by folder pattern:  migrations</span><br><span class="line">Operations to perform:</span><br><span class="line">  Apply all migrations: admin, auth, contenttypes, sessions, user</span><br><span class="line">Running migrations:</span><br><span class="line">  Applying contenttypes.0001_initial... OK</span><br><span class="line">  Applying auth.0001_initial... OK</span><br><span class="line">  Applying admin.0001_initial... OK</span><br><span class="line">  Applying admin.0002_logentry_remove_auto_add... OK</span><br><span class="line">  Applying admin.0003_logentry_add_action_flag_choices... OK</span><br><span class="line">  Applying contenttypes.0002_remove_content_type_name... OK</span><br><span class="line">  Applying auth.0002_alter_permission_name_max_length... OK</span><br><span class="line">  Applying auth.0003_alter_user_email_max_length... OK</span><br><span class="line">  Applying auth.0004_alter_user_username_opts... OK</span><br><span class="line">  Applying auth.0005_alter_user_last_login_null... OK</span><br><span class="line">  Applying auth.0006_require_contenttypes_0002... OK</span><br><span class="line">  Applying auth.0007_alter_validators_add_error_messages... OK</span><br><span class="line">  Applying auth.0008_alter_user_username_max_length... OK</span><br><span class="line">  Applying auth.0009_alter_user_last_name_max_length... OK</span><br><span class="line">  Applying auth.0010_alter_group_name_max_length... OK</span><br><span class="line">  Applying auth.0011_update_proxy_permissions... OK</span><br><span class="line">  Applying auth.0012_alter_user_first_name_max_length... OK</span><br><span class="line">  Applying sessions.0001_initial... OK</span><br><span class="line">  Applying user.0001_initial... OK</span><br></pre></td></tr></table></figure>

<ul>
<li>创建成功</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240619202112472.png" alt="image-20240619202112472"></p>
<ul>
<li></li>
</ul>
<h4 id="（4）注意">（4）注意</h4>
<ul>
<li>
<p>只要修改了models中有关数据库相关的代码，就必须执行上面的数据库迁移命令</p>
</li>
<li>
<p><strong>注意的是当你在控制台执行了<code>makemigrations</code>之后，你的APP文件下的<code>migrations</code>就会多东西，如果你想重新迁移的话就把多的东西给删掉，记住不要删除<code>__init__</code>文件</strong></p>
</li>
<li>
<p>你可以看到他会自动给你补充id主键字段</p>
</li>
<li>
<p>Django的默认机制</p>
<ul>
<li>
<p>在settings.py文件中他有一个数据</p>
```python
    DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'
    <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  - 这个机制自动创建了ID字段，你直接写了的话就用你自己的ID字段</span><br><span class="line"></span><br><span class="line">-  Django的默认机制就是如果你的表没有创建ID字段，默认帮你加一个 ID 字段</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from django.db import models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class UserInfo(models.Model):</span><br><span class="line">    username = models.CharField(max_length=32,</span><br><span class="line">                                verbose_name=&quot;用户名&quot;)</span><br><span class="line">    password = models.CharField(max_length=32,</span><br><span class="line">                                verbose_name=&quot;密码&quot;)</span><br><span class="line">    age = models.IntegerField(verbose_name=&quot;年龄&quot;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
</li>
<li>
<p>你没执行那两个命令一次之后，你的APP文件下的<code>migrations</code>就会多东西</p>
</li>
</ul>
<h3 id="【3】增加约束条件">【3】增加约束条件</h3>
<h4 id="（1）字段是否为空">（1）字段是否为空</h4>
<ul>
<li>
<p>默认是不为空的</p>
</li>
<li>
<p>不允许为空：null = False</p>
</li>
<li>
<p>允许为空：null = True</p>
</li>
</ul>
<h4 id="（2）给字段添加默认值">（2）给字段添加默认值</h4>
<ul>
<li>意思就是，你不写的话就会有默认值去填充字段</li>
<li><code>dafault = 默认值</code></li>
</ul>
<h3 id="【4】想要增加字段">【4】想要增加字段</h3>
<ul>
<li>直接在原本的模型表上增加字段就可以</li>
<li>迁移数据库再执行那两个命令</li>
</ul>
```shell
makemigrations

migrate
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">比如：在原本的字段中添加BooleanField类型的字段，bool值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">from django.db import models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class UserInfo(models.Model):</span><br><span class="line">    username = models.CharField(max_length=32,</span><br><span class="line">                                verbose_name=&quot;用户名&quot;)</span><br><span class="line">    password = models.CharField(max_length=32,</span><br><span class="line">                                verbose_name=&quot;密码&quot;)</span><br><span class="line">    # 允许为空</span><br><span class="line">    age = models.IntegerField(verbose_name=&quot;年龄&quot;, null=True)</span><br><span class="line">    # 增加一个爱好的字段允许为你空</span><br><span class="line">    # 给他一个默认值default=1</span><br><span class="line">    gender = models.BooleanField(verbose_name=&quot;男人或女人&quot;,</span><br><span class="line">                                 default=1)</span><br></pre></td></tr></table></figure>

<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240619204014910.png" alt="image-20240619204014910"></p>
<ul>
<li>添加成功</li>
</ul>
<h3 id="【5】删除字段">【5】删除字段</h3>
<ul>
<li>删除字段的话，就在模型表上把你不想要的字段给删掉</li>
<li>在次执行那两个命令</li>
</ul>
```shell
makemigrations

migrate
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 不过，在生产环境中删除字段前请确保不会影响现有数据，因为这可能导致数据丢失或结构不一致。</span><br><span class="line"></span><br><span class="line">### 【补充】</span><br><span class="line"></span><br><span class="line">- 每次修改关于数据库字段的操作时，都要执行数据库的迁移相关操作</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```shell</span><br><span class="line">python manage.py makemigrations</span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>

<h1>ORM操作数据库</h1>
<h2 id="【一】不启动Django就能操作数据库的使用方法">【一】不启动Django就能操作数据库的使用方法</h2>
<ul>
<li>
<p>再Dajngo框架中，Django必须启动才能使用DjangoORM语句</p>
</li>
<li>
<p>不启动Django就能操作数据库的使用方法</p>
</li>
</ul>
```python
import os
    
找到 manage.py copy main 下面的第一行代码
os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'first_django.settings')

# 引入dajngo模块
import django

#启动dajango项目
#缺点就是这个启动只是一次性的
django.setup()

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">![image-20240619211027663](D:\pycharm\Temporary_notes\图片\image-20240619211027663.png)</span><br><span class="line"></span><br><span class="line">## 【二】对数据库的表进行查数据</span><br><span class="line"></span><br><span class="line">- 方法一：first()：拿到你筛选条件的第一个值</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line"># first()：是拿到你筛选条件的第一个值</span><br><span class="line">    res_two = UserInfo.objects.filter(username=&quot;tom&quot;).first()</span><br><span class="line">    print(res_two)</span><br><span class="line">    # UserInfo object (1)</span><br></pre></td></tr></table></figure>

<ul>
<li>方法二：last()：拿到你筛选条件的最后一个值</li>
</ul>
```python
# last()：是拿到你筛选条件的最后一个值
    res_one = UserInfo.objects.filter(username="tom").last()
    print(res_one)
    # UserInfo object (2)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- 案例</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    import os</span><br><span class="line"></span><br><span class="line">    # 这是manage.py中的main下的第一行数据</span><br><span class="line">    os.environ.setdefault(&#x27;DJANGO_SETTINGS_MODULE&#x27;, &#x27;first_django.settings&#x27;)</span><br><span class="line"></span><br><span class="line">    import django</span><br><span class="line"></span><br><span class="line">    # 启动django项目</span><br><span class="line">    # 缺点是一次性的</span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    # 使用Django项目的模型表</span><br><span class="line">    # 导入</span><br><span class="line">    from user.models import UserInfo</span><br><span class="line"></span><br><span class="line">    # 【1】查数据</span><br><span class="line">    # 确保了表里有数据</span><br><span class="line">    res_one = UserInfo.objects.all()</span><br><span class="line">    print(res_one)</span><br><span class="line">    # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;]&gt;</span><br><span class="line">    # 得到的是一个对象</span><br><span class="line"></span><br><span class="line">    # 数据库只有一个数据的时候</span><br><span class="line">    # 过滤filter</span><br><span class="line">    res_one = UserInfo.objects.filter(username=&quot;tom&quot;)</span><br><span class="line">    # 这样就找到了username这个人</span><br><span class="line">    print(res_one)</span><br><span class="line">    # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;]&gt;</span><br><span class="line"></span><br><span class="line">    # 数据库要是有两条数据的话，并且名字一样，我们就要两个参数来判断</span><br><span class="line">    res_two = UserInfo.objects.filter(username=&quot;tom&quot;, password=&quot;912&quot;)</span><br><span class="line">    # 找两个叫tom的数据</span><br><span class="line">    print(res_two)</span><br><span class="line">    # &lt;QuerySet [&lt;UserInfo: UserInfo object (2)&gt;]&gt;</span><br><span class="line"></span><br><span class="line">    # 表中有三个数据</span><br><span class="line">    # first()：是拿到你筛选条件的第一个值</span><br><span class="line">    res_two = UserInfo.objects.filter(username=&quot;tom&quot;).first()</span><br><span class="line">    print(res_two)</span><br><span class="line">    # UserInfo object (1)</span><br><span class="line">    # last()：是拿到你筛选条件的最后一个值</span><br><span class="line">    res_one = UserInfo.objects.filter(username=&quot;tom&quot;).last()</span><br><span class="line">    print(res_one)</span><br><span class="line">    # UserInfo object (2)</span><br><span class="line"></span><br><span class="line">    # 取值--&gt;直接拿res_one当作一个对象，进行.属性获取数据</span><br><span class="line">    username = UserInfo.objects.filter(username=&quot;tom&quot;).last().username</span><br><span class="line">    print(username)</span><br><span class="line">    # # tom</span><br><span class="line">    # 可以写成</span><br><span class="line">    res_one = UserInfo.objects.filter(username=&quot;tom&quot;).last()</span><br><span class="line">    print(res_one.password)</span><br><span class="line">    # 912</span><br><span class="line">    # 记住了只能拿到对象以后才能才能点属性“UserInfo object (1)”</span><br></pre></td></tr></table></figure>

<h3 id="【3】对数据库的表增加数据">【3】对数据库的表增加数据</h3>
<ul>
<li>方法：<code>create()</code></li>
</ul>
```python
if __name__ == '__main__':
    import os

    # 这是manage.py中的main下的第一行数据
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'first_django.settings')

    import django

    # 启动django项目
    # 缺点是一次性的
    django.setup()

    # 使用Django项目的模型表
    # 导入
    from user.models import UserInfo

# 增加表数据-->create
    res = UserInfo.objects.create(username="dream", password="521", age="22")
    print(res)
    # UserInfo object (4)#添加成功
    # 在Django中不需要提交事物
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 【4】对数据库的表进行删数据</span><br><span class="line"></span><br><span class="line">- 方法：`delete()`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    import os</span><br><span class="line"></span><br><span class="line">    # 这是manage.py中的main下的第一行数据</span><br><span class="line">    os.environ.setdefault(&#x27;DJANGO_SETTINGS_MODULE&#x27;, &#x27;first_django.settings&#x27;)</span><br><span class="line"></span><br><span class="line">    import django</span><br><span class="line"></span><br><span class="line">    # 启动django项目</span><br><span class="line">    # 缺点是一次性的</span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    # 使用Django项目的模型表</span><br><span class="line">    # 导入</span><br><span class="line">    from user.models import UserInfo</span><br><span class="line"></span><br><span class="line"># 删除数据</span><br><span class="line">    # 方案一：获取到指定的对象后直接删除--&gt;delete()</span><br><span class="line">    UserInfo.objects.filter(username=&quot;dream&quot;, password=&quot;521&quot;).delete()</span><br><span class="line">    # 删除成功</span><br><span class="line">    # 方法二:先获取对象,然后删除</span><br><span class="line">    # get的属性，找不到值就会报错</span><br><span class="line">    # get 获取多个值也会直接报错</span><br><span class="line">    res = UserInfo.objects.get(username=&quot;dream&quot;)</span><br><span class="line">    print(res)</span><br><span class="line">    # UserInfo object (6) #拿到一个对象</span><br><span class="line">    # 删除到的话就直接delete()</span><br><span class="line">    res.delete()</span><br><span class="line">    # 删除成功</span><br></pre></td></tr></table></figure>

<h3 id="【5】对数据库的表进行修改数据">【5】对数据库的表进行修改数据</h3>
<ul>
<li>方法：<code>update()</code></li>
<li>方法二记得提交事务：save()</li>
</ul>
```python
if __name__ == '__main__':
    import os

    # 这是manage.py中的main下的第一行数据
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'first_django.settings')

    import django

    # 启动django项目
    # 缺点是一次性的
    django.setup()

    # 使用Django项目的模型表
    # 导入
    from user.models import UserInfo

# 修改数据
    # 方法一：直接获取后然后删除-->update
    res = UserInfo.objects.filter(id=1).update(password="88888")
    print(res)
    # 1--》只影响到了一条数据所以才会返回1
    # 修改成功

    # 方法二：获取对象以后在删除
    rew_obj = UserInfo.objects.get(id=2)
    print(rew_obj)
    # UserInfo object (2)
    rew_obj.password = "77777"
    rew_obj.age = 66
    # 你会发现没反应
    rew_obj.save()  # 可以看作是修改后提交事务
    # 修改成功
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">### 【案例】</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    import os</span><br><span class="line"></span><br><span class="line">    # 这是manage.py中的main下的第一行数据</span><br><span class="line">    os.environ.setdefault(&#x27;DJANGO_SETTINGS_MODULE&#x27;, &#x27;first_django.settings&#x27;)</span><br><span class="line"></span><br><span class="line">    import django</span><br><span class="line"></span><br><span class="line">    # 启动django项目</span><br><span class="line">    # 缺点是一次性的</span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    # 使用Django项目的模型表</span><br><span class="line">    # 导入</span><br><span class="line">    from user.models import UserInfo</span><br><span class="line"></span><br><span class="line">    # 【1】查数据</span><br><span class="line">    # 确保了表里有数据</span><br><span class="line">    res_one = UserInfo.objects.all()</span><br><span class="line">    print(res_one)</span><br><span class="line">    # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;]&gt;</span><br><span class="line">    # 得到的是一个对象</span><br><span class="line"></span><br><span class="line">    # 数据库只有一个数据的时候</span><br><span class="line">    # 过滤filter</span><br><span class="line">    res_one = UserInfo.objects.filter(username=&quot;tom&quot;)</span><br><span class="line">    # 这样就找到了username这个人</span><br><span class="line">    print(res_one)</span><br><span class="line">    # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;]&gt;</span><br><span class="line"></span><br><span class="line">    # 数据库要是有两条数据的话，并且名字一样，我们就要两个参数来判断</span><br><span class="line">    res_two = UserInfo.objects.filter(username=&quot;tom&quot;, password=&quot;912&quot;)</span><br><span class="line">    # 找两个叫tom的数据</span><br><span class="line">    print(res_two)</span><br><span class="line">    # &lt;QuerySet [&lt;UserInfo: UserInfo object (2)&gt;]&gt;</span><br><span class="line"></span><br><span class="line">    # 表中有三个数据</span><br><span class="line">    # first()：是拿到你筛选条件的第一个值</span><br><span class="line">    res_two = UserInfo.objects.filter(username=&quot;tom&quot;).first()</span><br><span class="line">    print(res_two)</span><br><span class="line">    # UserInfo object (1)</span><br><span class="line">    # last()：是拿到你筛选条件的最后一个值</span><br><span class="line">    res_one = UserInfo.objects.filter(username=&quot;tom&quot;).last()</span><br><span class="line">    print(res_one)</span><br><span class="line">    # UserInfo object (2)</span><br><span class="line"></span><br><span class="line">    # 取值--&gt;直接拿res_one当作一个对象，进行.属性获取数据</span><br><span class="line">    username = UserInfo.objects.filter(username=&quot;tom&quot;).last().username</span><br><span class="line">    print(username)</span><br><span class="line">    # # tom</span><br><span class="line">    # 可以写成</span><br><span class="line">    res_one = UserInfo.objects.filter(username=&quot;tom&quot;).last()</span><br><span class="line">    print(res_one.password)</span><br><span class="line">    # 912</span><br><span class="line">    # 记住了只能拿到对象以后才能才能点属性“UserInfo object (1)”</span><br><span class="line"></span><br><span class="line">    # 【2】增加表数据--&gt;create</span><br><span class="line">    res = UserInfo.objects.create(username=&quot;dream&quot;, password=&quot;521&quot;, age=&quot;22&quot;)</span><br><span class="line">    print(res)</span><br><span class="line">    # UserInfo object (4)#添加成功</span><br><span class="line">    # 在Django中不需要提交事物</span><br><span class="line"></span><br><span class="line">    # 【3】删除数据</span><br><span class="line">    # 方案一：获取到指定的对象后直接删除--&gt;delete()</span><br><span class="line">    UserInfo.objects.filter(username=&quot;dream&quot;, password=&quot;521&quot;).delete()</span><br><span class="line">    # 删除成功</span><br><span class="line">    # 方法二:先获取对象,然后删除</span><br><span class="line">    # get的属性，找不到值就会报错</span><br><span class="line">    # get 获取多个值也会直接报错</span><br><span class="line">    res = UserInfo.objects.get(username=&quot;dream&quot;)</span><br><span class="line">    print(res)</span><br><span class="line">    # UserInfo object (6) #拿到一个对象</span><br><span class="line">    # 删除到的话就直接delete()</span><br><span class="line">    res.delete()</span><br><span class="line">    # 删除成功</span><br><span class="line"></span><br><span class="line">    # 【4】修改数据</span><br><span class="line">    # 方法一：直接获取后然后删除--&gt;update</span><br><span class="line">    res = UserInfo.objects.filter(id=1).update(password=&quot;88888&quot;)</span><br><span class="line">    print(res)</span><br><span class="line">    # 1--》只影响到了一条数据所以才会返回1</span><br><span class="line">    # 修改成功</span><br><span class="line"></span><br><span class="line">    # 方法二：获取对象以后在删除</span><br><span class="line">    rew_obj = UserInfo.objects.get(id=2)</span><br><span class="line">    print(rew_obj)</span><br><span class="line">    # UserInfo object (2)</span><br><span class="line">    rew_obj.password = &quot;77777&quot;</span><br><span class="line">    rew_obj.age = 66</span><br><span class="line">    # 你会发现没反应</span><br><span class="line">    rew_obj.save()  # 可以看作是修改后提交事务</span><br><span class="line">    # 修改成功</span><br><span class="line"></span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2025/10/15/3.5%E5%87%BD%E6%95%B0%E5%AF%B9%E8%B1%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2025/10/15/3.5%E5%87%BD%E6%95%B0%E5%AF%B9%E8%B1%A1/" class="post-title-link" itemprop="url">3.5函数对象</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2025-10-15 11:34:55 / 修改时间：16:19:13" itemprop="dateCreated datePublished" datetime="2025-10-15T11:34:55+08:00">2025-10-15</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>【一】函数对象</h1>
<ul>
<li>函数对象指的是函数可以被当做数据来处理 ，分四个方面。</li>
<li>python中一切皆为对象</li>
</ul>
<h2 id="【1】函数可以直接被引用">【1】函数可以直接被引用</h2>
<ul>
<li>定义一个函数用一个新的变量来存，用新的变量名调用</li>
</ul>
```python
# 定义一个函数
def add(x, y):
    return x + y


# 将函数地址绑定给一个变量
func = add
# 通过这个变量找到对应的地址，从而调用函数
res = func(1, 2)
print(res) # 3
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【2】可以作为元素被储存</span><br><span class="line"></span><br><span class="line">- 功能字典中的函数地址</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">def add(x, y):</span><br><span class="line">    return x + y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dic = &#123;&#x27;add&#x27;: add, &#x27;max&#x27;: max&#125;</span><br><span class="line">print(dic)  # &#123;&#x27;add&#x27;: &lt;function add at 0x0000020523843E20&gt;, &#x27;max&#x27;: &lt;built-in function max&gt;&#125;</span><br><span class="line">res = dic[&#x27;add&#x27;](1, 2)</span><br><span class="line">print(res)  # 3</span><br></pre></td></tr></table></figure>

<h2 id="【3】函数可以作为一个参数传给另一函数">【3】函数可以作为一个参数传给另一函数</h2>
<ul>
<li>将函数的内存地址作为参数传递</li>
</ul>
```python
f add(x, y):
    return x + y


def foo(x, y, func):
    return func(x, y)


res = foo(1, 2, add)
print(res) # 3
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#123;% endraw %&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## 【4】函数的返回值可以是一个函数</span><br><span class="line"></span><br><span class="line">- 我们直接将函数的内存地址返回</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;% raw %&#125;```python</span><br><span class="line">def add(x, y):</span><br><span class="line">    return x + y</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def bar():</span><br><span class="line">    return add</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">func = bar()</span><br><span class="line">print(func)  # &lt;function add at 0x00000239EC363E20&gt;</span><br><span class="line">res = func(1, 2)</span><br><span class="line">print(res)  # 3</span><br></pre></td></tr></table></figure>


      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">坤</p>
  <div class="site-description" itemprop="description">选择有时候比努力更重要，但是你不努力，选择就只是空谈</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">194</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">坤</span>
</div>
  <div class="powered-by">由 <a href="https://github.com/lsk-0912" class="theme-link" rel="noopener" target="_blank">lsk-0912</a> & <a href="https://github.com/lsk-0912" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
