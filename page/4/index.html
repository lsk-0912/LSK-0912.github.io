<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 8.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aurora-lsk.asia","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
<meta property="og:type" content="website">
<meta property="og:title" content="坤博客">
<meta property="og:url" content="https://aurora-lsk.asia/page/4/index.html">
<meta property="og:site_name" content="坤博客">
<meta property="og:description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="坤">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://aurora-lsk.asia/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>坤博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">坤博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.6%E7%B2%98%E5%8C%85%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.6%E7%B2%98%E5%8C%85%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">1.6ճ������</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>粘包问题</h1>
<h2 id="【一】介�">【一】介�?</h2>
<ul>
<li>
<p>粘包问题只会发生在TCP协议�?–》流失协�?-》不断的传输数据</p>
<ul>
<li>因为TCP是流式协�?</li>
</ul>
</li>
<li>
<p>不会发生在UDP协议�?-》报式协�?–》一次性传输数�?</p>
</li>
</ul>
<h2 id="【二】粘包问�">【二】粘包问�?</h2>
<ul>
<li>客户端发送数据远远超出服务端的接受范�?</li>
<li>就会导致不同数据之间的混�?
<ul>
<li>意思就是你第一次发送的数据太多没有发完，就会跟着第二次混在一块发送�?</li>
</ul>
</li>
</ul>
<h2 id="【三】解决思路和办�">【三】解决思路和办�?</h2>
<ul>
<li>问题产生在服务端
<ul>
<li>原因是客户端传给服务端数据，但是服务端不知道接收的总数据的大小，只能按默认的大小来接收</li>
</ul>
</li>
<li>解决办法
<ul>
<li>客户端发送数据的时候将数据总在一块，一次性发送给服务�?</li>
<li>服务端接收到总数据的大小长度，根据自己的容量大小分批接收</li>
</ul>
</li>
</ul>
<h2 id="【四】例�">【四】例�?</h2>
<ul>
<li>解决方法</li>
<li><code>server.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象</span></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 解决端口被占用的问题</span></span><br><span class="line">server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line">server.bind(settings.ADDR)</span><br><span class="line"><span class="comment"># 服务端多了一步监听对�?</span></span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 多了一步建立连接对�?</span></span><br><span class="line"><span class="comment"># 就是客户端传过来的数�?</span></span><br><span class="line">conn, addr = server.accept()</span><br><span class="line"><span class="comment"># while循环</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 这里面交流的对象永远是上面接收到的那一�?</span></span><br><span class="line">        <span class="comment"># conn,addr = server.accept():接收到新的对象，忘记上一个连接过的对�?</span></span><br><span class="line">        <span class="comment"># 先接收客户端传过来的第一个数据struct打包好的四个字节的数�?</span></span><br><span class="line">        json_pack_data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="comment"># 判断是不是空�?</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> json_pack_data:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># 对数据解�?&gt;得到json二进制长度数�?</span></span><br><span class="line">        json_bytes_length = settings.unpack_data(data=json_pack_data)</span><br><span class="line">        <span class="comment"># 根据json二进制数据长度解出JSON二进制数�?</span></span><br><span class="line">        json_data_bytes = conn.recv(json_bytes_length)</span><br><span class="line">        <span class="comment"># 将json二进制数据转为json字符串数�?</span></span><br><span class="line">        json_str = json_data_bytes.decode()</span><br><span class="line">        <span class="comment"># 将json字符串数据转换为python的字�?</span></span><br><span class="line">        data_info = json.loads(json_str)</span><br><span class="line">        <span class="comment"># 字典特�?-》键取�?</span></span><br><span class="line">        <span class="comment"># 得到总的数据长度</span></span><br><span class="line">        data_length = data_info.get(<span class="string">&#x27;data_length&#x27;</span>)</span><br><span class="line">        <span class="comment"># 开始分批接收数�?</span></span><br><span class="line">        <span class="comment"># 定义数据</span></span><br><span class="line">        <span class="comment"># 定义总数�?--&gt;二进�?</span></span><br><span class="line">        all_data = <span class="string">b&#x27; &#x27;</span></span><br><span class="line">        <span class="comment"># 每次只能接收数据的大�?</span></span><br><span class="line">        size = <span class="number">1024</span></span><br><span class="line">        <span class="comment"># 引入方法---》divmod--》得到商和余�?</span></span><br><span class="line">        <span class="comment"># 比如</span></span><br><span class="line">        <span class="comment"># data_length : 5</span></span><br><span class="line">        <span class="comment"># size : 2</span></span><br><span class="line">        <span class="comment"># count : 2 , last_size : 1</span></span><br><span class="line">        count, last_size = <span class="built_in">divmod</span>(data_length, size)</span><br><span class="line">        <span class="comment"># 再定义一个接收数据的大小</span></span><br><span class="line">        all_size = <span class="number">0</span></span><br><span class="line">        <span class="comment"># while循环</span></span><br><span class="line">        <span class="keyword">while</span> all_size &lt; count + <span class="number">1</span>:</span><br><span class="line">            all_size += <span class="number">1</span></span><br><span class="line">            <span class="comment"># 接收到每一次的数据并和总数据拼�?</span></span><br><span class="line">            <span class="keyword">if</span> all_size == count + <span class="number">1</span>:</span><br><span class="line">                all_data += conn.recv(size)</span><br><span class="line">                from_client_recv_data = all_data.decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;这是来自客户端的数据 :&gt;&gt;&gt;&gt;  \n <span class="subst">&#123;from_client_recv_data&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                to_client_send_data = <span class="built_in">input</span>(<span class="string">&quot;请输入发送给客户端的数据 :&gt;&gt;&gt;&gt; &quot;</span>).strip()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> to_client_send_data:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;不允许发送空的数�?)</span></span><br><span class="line"><span class="string">                    continue</span></span><br><span class="line"><span class="string">                if to_client_send_data == &#x27;</span>q<span class="string">&#x27;:</span></span><br><span class="line"><span class="string">                    print(f&#x27;</span>当前连接已退�?<span class="string">&#x27;)</span></span><br><span class="line"><span class="string">                # 编码</span></span><br><span class="line"><span class="string">                to_client_send_data = to_client_send_data.encode()</span></span><br><span class="line"><span class="string">                # 发送数�?</span></span><br><span class="line"><span class="string">                conn.send(to_client_send_data)</span></span><br><span class="line"><span class="string">                break</span></span><br><span class="line"><span class="string">    except Exception as e:</span></span><br><span class="line"><span class="string">        break</span></span><br><span class="line"><span class="string"># 关闭服务</span></span><br><span class="line"><span class="string">conn.close()</span></span><br><span class="line"><span class="string">server.close()</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>client.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># 导入模块�?</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函�?-》启动命�?</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_cmd</span>(<span class="params">command</span>):</span><br><span class="line">    result = subprocess.run(</span><br><span class="line">        command,  <span class="comment"># 子进程要执行的命�?</span></span><br><span class="line">        shell=<span class="literal">True</span>,  <span class="comment"># 执行的是shell命令</span></span><br><span class="line">        <span class="comment"># 存放的是执行命令成功的结�?</span></span><br><span class="line">        stdout=subprocess.PIPE,</span><br><span class="line">        <span class="comment"># 存放的是执行命令失败的结�?</span></span><br><span class="line">        stderr=subprocess.PIPE,</span><br><span class="line">        encoding=<span class="string">&quot;gbk&quot;</span>,</span><br><span class="line">        timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># returncode属性是run()函数返回结果的状�?</span></span><br><span class="line">    <span class="keyword">if</span> result.returncode == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stdout</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stderr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象</span></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line">client.connect(settings.ADDR)</span><br><span class="line"><span class="comment"># 创建一个while循环</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 输入发送数�?</span></span><br><span class="line">    command = <span class="built_in">input</span>(<span class="string">&quot;请输入你要执行的命令�?---&quot;</span>).strip()</span><br><span class="line">    <span class="comment"># 判断</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> command:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;不允许发送空数据&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;当前连接已退出！&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># 执行本地的命令，获取到当前命令结�?</span></span><br><span class="line">    result = run_cmd(command=command)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="comment"># 将命令的结果进行编码，转换成二进制数�?</span></span><br><span class="line">    result_bytes = result.encode()</span><br><span class="line">    <span class="comment"># 计算长度</span></span><br><span class="line">    data_length = <span class="built_in">len</span>(result)</span><br><span class="line">    <span class="comment"># 加一个数据字典，将所有的数据概览</span></span><br><span class="line">    <span class="comment"># 获得�?</span></span><br><span class="line">    salt = uuid.uuid4().<span class="built_in">hex</span></span><br><span class="line">    <span class="comment"># 加密</span></span><br><span class="line">    encrypted = settings.encrypt_data(data=result_bytes, salt=salt)</span><br><span class="line">    <span class="built_in">print</span>(data_length)</span><br><span class="line">    <span class="comment"># 建立字典</span></span><br><span class="line">    send_data_info = &#123;</span><br><span class="line">        <span class="string">&#x27;command&#x27;</span>: command,</span><br><span class="line">        <span class="string">&#x27;data_length&#x27;</span>: data_length,</span><br><span class="line">        <span class="string">&#x27;salt&#x27;</span>: salt,</span><br><span class="line">        <span class="string">&#x27;encrypted&#x27;</span>: encrypted</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># 将上面打包的数据---》发送给服务�?</span></span><br><span class="line">    <span class="comment"># 字典格式无法发送，将字典转换为字符串数据用--》json</span></span><br><span class="line">    <span class="comment"># dump：处理文件数�?</span></span><br><span class="line">    <span class="comment"># dumps：将格式转换</span></span><br><span class="line">    json_str = json.dumps(send_data_info)</span><br><span class="line">    <span class="comment"># 将转换好的字符串数据再转换成二进制数据�?</span></span><br><span class="line">    json_bytes = json_str.encode()</span><br><span class="line">    <span class="comment"># json字符串转换的二进制数据还是会很长�?</span></span><br><span class="line">    <span class="comment"># 于是我们想到--》struct模块：将某个数据转换为四个字节的二进制数�?</span></span><br><span class="line">    <span class="comment"># 将数据打�?</span></span><br><span class="line">    json_length_pack = settings.pack_data(data_length=<span class="built_in">len</span>(json_bytes))</span><br><span class="line">    <span class="comment"># 发送数�?-》先发送打包好的struct数据--》再发送json数据--》最后发送原始数�?</span></span><br><span class="line">    <span class="comment"># 服务端接受的顺序取决于客户端发送的顺序</span></span><br><span class="line">    <span class="comment"># 先发送打包好的struct数据</span></span><br><span class="line">    client.send(json_length_pack)</span><br><span class="line">    <span class="built_in">print</span>(json_length_pack)</span><br><span class="line">    <span class="comment"># 再发送json数据-&gt;二进制数�?</span></span><br><span class="line">    client.send(json_bytes)</span><br><span class="line">    <span class="comment"># 最后发送原始数�?--&gt;命令二进制数�?</span></span><br><span class="line">    client.send(result_bytes)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 接收服务端返回的消息</span></span><br><span class="line">    from_server_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="comment"># 解码</span></span><br><span class="line">    from_server_recv_data = from_server_recv_data.decode()</span><br><span class="line">    <span class="comment"># 判断---解码得到的是q的话就代表服务端已退�?</span></span><br><span class="line">    <span class="keyword">if</span> from_server_recv_data == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;来自服务端的数据�?----<span class="subst">&#123;from_server_recv_data&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 关闭连接对象--要在while循环外面</span></span><br><span class="line">client.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><code>settings.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Current username：粘包问�?</span></span><br><span class="line"><span class="comment"># current date�?024/5/15</span></span><br><span class="line"><span class="comment"># current time �?0:39</span></span><br><span class="line"></span><br><span class="line">IP = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line"><span class="comment"># localhost �?127.0.0.1区别</span></span><br><span class="line"><span class="comment"># DNS解析 --&gt; 一串字符解析成IP</span></span><br><span class="line"><span class="comment"># localhost 就是一个域�?只能在本地使�?</span></span><br><span class="line">PORT = <span class="number">8006</span></span><br><span class="line">ADDR = (IP, PORT)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#加密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_data</span>(<span class="params">data, salt</span>):</span><br><span class="line">    data = <span class="built_in">str</span>(data) + <span class="built_in">str</span>(salt)</span><br><span class="line">    data = data.encode()</span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(data)</span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个包含不同类型字段的格式字符�?</span></span><br><span class="line">format_string = <span class="string">&#x27;i&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对数据进行打�?</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pack_data</span>(<span class="params">data_length: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="comment"># 使用 struct.pack 将数据打包成二进制字节串</span></span><br><span class="line">    packed_data = struct.pack(format_string, data_length)</span><br><span class="line">    <span class="keyword">return</span> packed_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对数据解�?</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unpack_data</span>(<span class="params">data</span>):</span><br><span class="line">    data_length = struct.unpack(format_string, data)</span><br><span class="line">    <span class="keyword">return</span> data_length[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h2 id="【五】小插曲（subprocess模块�">【五】小插曲（subprocess模块�?</h2>
<ul>
<li>相当于一个模拟终端（cmd�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_cmd</span>(<span class="params">command</span>):</span><br><span class="line">    result = subprocess.run(</span><br><span class="line">        command,  <span class="comment"># 子进程要执行的命�?</span></span><br><span class="line">        shell=<span class="literal">True</span>,  <span class="comment"># 执行的是shell的命�?</span></span><br><span class="line">        <span class="comment"># 存放的是执行命令成功的结�?</span></span><br><span class="line">        stdout=subprocess.PIPE,</span><br><span class="line">        <span class="comment"># 存放的是执行命令失败的结�?</span></span><br><span class="line">        stderr=subprocess.PIPE,</span><br><span class="line">        encoding=<span class="string">&quot;gbk&quot;</span>,</span><br><span class="line">        timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># returncode属性是run()函数返回结果的状态�?</span></span><br><span class="line">    <span class="keyword">if</span> result.returncode == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stdout</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stderr</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(run_cmd([<span class="string">&quot;dir&quot;</span>]))<span class="comment">#命令：dir</span></span><br><span class="line">输出<span class="comment">#  驱动�?D 中的卷是 Data</span></span><br><span class="line">    <span class="comment">#  卷的序列号是 6672-D05A</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#  D:\pycharm\project\DAY01\模块 的目�?</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 2024/05/15  20:28    &lt;DIR&gt;          .</span></span><br><span class="line">    <span class="comment"># 2024/05/14  15:21    &lt;DIR&gt;          ..</span></span><br><span class="line">    <span class="comment"># 2024/05/09  16:53               111 pickle_file</span></span><br><span class="line">    <span class="comment"># 2024/05/09  16:54               932 pickle模块.py</span></span><br><span class="line">    <span class="comment"># 2024/05/15  20:28               731 subprocess模块.py</span></span><br><span class="line">    <span class="comment">#                3 个文�?         1,774 字节</span></span><br><span class="line">    <span class="comment">#                2 个目�?122,309,275,648 可用字节</span></span><br></pre></td></tr></table></figure>
<h2 id="【六】struct模块介绍">【六】struct模块介绍</h2>
<ul>
<li><code>struct.pack()</code>是Python内置模块<code>struct</code>中的一个函�?</li>
<li>他的作用是将指定的数据按照指定的格式进行打包</li>
<li>将打包后的结果转换为一个字节序列（byte string），可以用于在网络上传输或者储存于文件中�?</li>
</ul>
<h3 id="�-）参数简�">�?）参数简�?</h3>
<ul>
<li><code>struct.pack(fmt, v1, v2, ...)</code></li>
<li><code>fmt</code>是格式字符串，指定了需要打包的数据格式，v1,v2则是需要打包的数据</li>
<li>数据按照fmt的格式被编写成二进制的字符串，并返回字节�?</li>
<li>定义fmt用的</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">�?x --- 填充字节</span><br><span class="line">�?c --- char类型，占1字节</span><br><span class="line">�?b --- signed char类型，占1字节</span><br><span class="line">�?B --- unsigned char类型，占1字节</span><br><span class="line">�?h --- short类型，占2字节</span><br><span class="line">�?H --- unsigned short类型，占2字节</span><br><span class="line">�?i --- int类型，占4字节</span><br><span class="line">�?I --- unsigned int类型，占4字节</span><br><span class="line">�?l --- long类型，占4字节�?2位机器上）或�?字节�?4位机器上�?</span><br><span class="line">�?L --- unsigned long类型，占4字节�?2位机器上）或�?字节�?4位机器上�?</span><br><span class="line">�?q --- long long类型，占8字节</span><br><span class="line">�?Q --- unsigned long long类型，占8字节</span><br><span class="line">�?f --- float类型，占4字节</span><br><span class="line">�?d --- double类型，占8字节</span><br><span class="line">�?s --- char[]类型，占指定字节个数，需要用数字指定长度</span><br><span class="line">�?p --- char[]类型，跟s一样，但通常用来表示字符�?</span><br><span class="line">�?? --- bool类型，占1字节</span><br></pre></td></tr></table></figure>
<ul>
<li>例题</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入模块</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义一个包含不同类型字段的格式字符�?</span></span><br><span class="line">format_string = <span class="string">&quot;i&quot;</span></span><br><span class="line"></span><br><span class="line">data_to_pack = <span class="string">&quot;ajeaedji0ejdpoadopdkmscoijaeciojei测测为的味道维持稳定饿挖的低洼d&quot;</span></span><br><span class="line"><span class="comment">#上面数据二进�?</span></span><br><span class="line">data_to_pack_bytes = data_to_pack.encode()</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算长度</span></span><br><span class="line">data_to_pack_len = <span class="built_in">len</span>(data_to_pack_bytes)</span><br><span class="line"><span class="built_in">print</span>(data_to_pack_len)<span class="comment">#80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 struct.pack 将数据打包成二进制字节串</span></span><br><span class="line">packed_data = struct.pack(format_string, data_to_pack_len)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(packed_data)<span class="comment">#b&#x27;P\x00\x00\x00&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#解析二进制字符串，恢复原始数�?</span></span><br><span class="line">unpacked_data = struct.unpack(format_string, packed_data)</span><br><span class="line"><span class="built_in">print</span>(unpacked_data)<span class="comment">#(80,)</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.8%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.8%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/" class="post-title-link" itemprop="url">1.8�������ֺ��Ĵλ���</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>TCP三次握手和四次挥�?</h1>
<ul>
<li>只发生在TCP协议�?</li>
</ul>
<h2 id="【一】三次握�">【一】三次握�?</h2>
<p>发生在连接阶�?</p>
<ul>
<li>第一次握�?
<ul>
<li>客户端发出请求（一定要有数据），需要和服务端建立联�?</li>
</ul>
</li>
<li>第二次握�?
<ul>
<li>服务端接收到客户端发来的请求</li>
<li>ACK=1：表示收到了当前客户端发送给我的请求</li>
</ul>
</li>
<li>第三次握�?
<ul>
<li>客户端收到服务端发来的请求（一定要带数据）</li>
<li>表示建立连接成功
<ul>
<li>ACK=1:表示已经被正确接�?</li>
<li>SYN=1:一个俩及请求或是连接接收内报文</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="【二】四次挥�">【二】四次挥�?</h2>
<p>发生在断开连接阶段</p>
<ul>
<li>第一次挥�?
<ul>
<li>客户端向服务端发出断开连接请求</li>
</ul>
</li>
<li>第二次挥�?
<ul>
<li>服务端接收到客户端发来的请求</li>
<li>服务端拒绝断开连接</li>
</ul>
</li>
<li>第三次挥�?
<ul>
<li>不断开的原因是，数据还没有处理完成</li>
<li>处理完之�?</li>
<li>向服务端请求表示可以断开连接</li>
</ul>
</li>
<li>第四次挥�?
<ul>
<li>客户端接收到服务端的断开连接的请�?</li>
<li>断开连接</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/10.0Django%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%A8%A1%E5%9E%8B%E5%B1%82/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/10.0Django%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%A8%A1%E5%9E%8B%E5%B1%82/" class="post-title-link" itemprop="url">10.0Django���֮ģ�Ͳ�</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Django框架之模型层</h1>
<h2 id="【一】模型层引入（测试环境搭建）">【一】模型层引入（测试环境搭建）</h2>
<ul>
<li>Django的orm框架必须是在Django的启动状态下才能使用</li>
<li>Django为我们提供了测试环境</li>
<li>这个测试环境只是临时启动而不是持久化活动</li>
</ul>
<p>创建测试环境</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复�?</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br></pre></td></tr></table></figure>
<h2 id="【二】Django的ORM的单表操�">【二】Django的ORM的单表操�?</h2>
<h3 id="�-】数据库配置">�?】数据库配置</h3>
<ul>
<li>在setting.py文件中配�?
<ul>
<li>将原来django自带的删�?</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,</span><br><span class="line">        <span class="comment"># 手动创建一个新的数据库</span></span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&quot;django_two&quot;</span>,</span><br><span class="line">        <span class="string">&quot;USER&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PASSWORD&quot;</span>: <span class="string">&quot;1234567&quot;</span>,</span><br><span class="line">        <span class="string">&quot;HOST&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PORT&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">        <span class="string">&quot;CHARSET&quot;</span>: <span class="string">&quot;utf8mb4&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>启动项目可能会报�?</li>
<li>原因是没有下载mysqlclient</li>
</ul>
<p>解决方法一</p>
<ul>
<li>
<p>打猴子补�?</p>
</li>
<li>
<p>随便找一个文件，一般都会选择<code>__init__.py</code>文件</p>
</li>
<li>
<p>把下面的数据复制进去即可</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure>
<p>方法�?</p>
<ul>
<li>下载mysqlclient</li>
</ul>
<h3 id="�-】在APP下的models-py文件中定义模型表">�?】在APP下的models.py文件中定义模型表</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfo</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>, verbose_name=<span class="string">&quot;名字&quot;</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField(verbose_name=<span class="string">&quot;年龄&quot;</span>)</span><br><span class="line">    <span class="comment"># 显示注册时间</span></span><br><span class="line">    <span class="comment"># auto_now_add=True</span></span><br><span class="line">    <span class="comment"># Django会在对象第一次被创建时自动设置该字段的值为当前的日期和时间。之后，无论对象如何被保存或修改，这个字段的值都不会再自动更�?</span></span><br><span class="line">    <span class="comment"># DateTimeField类型</span></span><br><span class="line">    <span class="comment"># 用于在数据库中存储日期和时间</span></span><br><span class="line">    register_time = models.DateTimeField(auto_now_add=<span class="literal">True</span>,</span><br><span class="line">                                         verbose_name=<span class="string">&quot;注册时间&quot;</span>)</span><br><span class="line">    <span class="comment"># auto_now：在创建数据库的时候会自动新增时间，每次修改都会刷�?</span></span><br><span class="line">    update_time = models.DateTimeField(auto_now=<span class="literal">True</span>,</span><br><span class="line">                                       verbose_name=<span class="string">&quot;更新时间&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>迁移数据�?</p>
<ul>
<li>执行两句�?</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line"></span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>
<ul>
<li>执行完后就迁移成功了</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240625202154249.png" alt="image-20240625202154249"></p>
</li>
</ul>
<h3 id="�-】对数据库的增删改查（必会N条）">�?】对数据库的增删改查（必会N条）</h3>
<ul>
<li>在你的测试环境下面写</li>
</ul>
<h4 id="�-）增">�?）增</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复�?</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line">    <span class="comment"># �?】对数据库增�?</span></span><br><span class="line">    <span class="comment"># 方式一 create()</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.create(name=&quot;jack&quot;, age=22)</span></span><br><span class="line">    <span class="comment"># print(data) # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># 方法�?先生成一个对象，然后在提交事�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo(name=&quot;tom&quot;, age=710)</span></span><br><span class="line">    <span class="comment"># print(data) # UserInfo object (None)</span></span><br><span class="line">    <span class="comment"># 提交事务，不提交事务不会添加数据</span></span><br><span class="line">    <span class="comment"># data.save()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="�-）删">�?）删</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复�?</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># �?】删除数�?</span></span><br><span class="line">    <span class="comment"># 方法一 获取到筛选的结果，然后对结果进行删除.delete()</span></span><br><span class="line">    <span class="comment"># 会把符合条件的全部删�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name=&quot;tom&quot;).delete()</span></span><br><span class="line">    <span class="comment"># print(data) # (2, &#123;&#x27;user.UserInfo&#x27;: 2&#125;)# 删除了两条数�?</span></span><br><span class="line">    <span class="comment"># 方法�?直接删除对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.get(name=&quot;dream&quot;).delete()</span></span><br><span class="line">    <span class="comment"># print(data)  # (1, &#123;&#x27;user.UserInfo&#x27;: 1&#125;) #删除了一条数�?</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）改">�?）改</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复�?</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># �?】对数据库修改数�?</span></span><br><span class="line">    <span class="comment"># 方法一 查完后直接修�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name=&quot;jack&quot;).update(name=&quot;dream&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # 2 # 代表修改了两条数�?</span></span><br><span class="line">    <span class="comment"># 方法�?先查对象，然后对�?属性名改�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.get(pk=1)</span></span><br><span class="line">    <span class="comment"># data.name = &quot;tom&quot;</span></span><br><span class="line">    <span class="comment"># print(data)  # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># # 一定要提交数据</span></span><br><span class="line">    <span class="comment"># data.save()</span></span><br><span class="line">    <span class="comment"># # 修改成功</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）查">�?）查</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复�?</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># �?】查询数据库里面的数�?</span></span><br><span class="line">    <span class="comment"># 方式一 get和values取出所有符合条件的值，all取出所有的数据对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.all()</span></span><br><span class="line">    <span class="comment"># # 得到的是所有数据的对象</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;, &lt;UserInfo: UserInfo object (2)&gt;, &lt;UserInfo: UserInfo object (3)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.all().values(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment"># # 取出所有人的名�?</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># # &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;jack&#x27;&#125;, &#123;&#x27;name&#x27;: &#x27;jack&#x27;&#125;, &#123;&#x27;name&#x27;: &#x27;tom&#x27;&#125;]&gt;</span></span><br><span class="line">    <span class="comment"># # 得到id�?的user对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.get(pk=1)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># # 得到数据</span></span><br><span class="line">    <span class="comment"># data = data.name</span></span><br><span class="line">    <span class="comment"># print(data)  # jack</span></span><br><span class="line">    <span class="comment"># 方法�?fileter过滤结果 结果是queryset对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(pk=1)</span></span><br><span class="line">    <span class="comment"># print(data)  # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># 获得结果集的第一个结�?</span></span><br><span class="line">    <span class="comment"># 因为就一个结果，都可以获�?</span></span><br><span class="line">    <span class="comment"># data = data.first()</span></span><br><span class="line">    <span class="comment"># print(data) # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># 获得结果集的最后一个结�?</span></span><br><span class="line">    <span class="comment"># 因为就一个结果，都可以获�?</span></span><br><span class="line">    <span class="comment"># data = data.last()</span></span><br><span class="line">    <span class="comment"># print(data)  # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># 获得结果集中的所有符合条件的结果</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name=&quot;jack&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;, &lt;UserInfo: UserInfo object (2)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># data = data.all()</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;, &lt;UserInfo: UserInfo object (2)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># 获取结果集中的对应字段对应的数据,values得到的是字典</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age=22).values(&quot;name&quot;, &quot;age&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;jack&#x27;, &#x27;age&#x27;: 22&#125;, &#123;&#x27;name&#x27;: &#x27;jack&#x27;, &#x27;age&#x27;: 22&#125;]&gt;</span></span><br><span class="line">    <span class="comment"># 获取结果集中的对应字段对应的数据,values_list得到的是字典</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age=22).values_list(&quot;name&quot;, &quot;age&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [(&#x27;jack&#x27;, 22), (&#x27;jack&#x27;, 22)]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）其它方�">�?）其它方�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复�?</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># �?】去�?</span></span><br><span class="line">	<span class="comment"># 筛选数的第一条数�?</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.values(&quot;age&quot;).distinct().first()</span></span><br><span class="line">    <span class="comment"># print(user, type(user))</span></span><br><span class="line">    <span class="comment"># &#123;&#x27;age&#x27;: 18&#125; &lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># �?】知道数据的结果�?</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.count()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># �?】排�?</span></span><br><span class="line">    <span class="comment"># 正序�?MySQL正序�?asc</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;age&quot;)</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line">    <span class="comment"># 倒序�?MySQL倒序�?desc</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;-age&quot;)</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line">    <span class="comment"># 将排序后的结果翻�?</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;age&quot;).reverse()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line">    <span class="comment"># 在Django的ORM语句中只要不是确切的某个对象 就可以一�?. 触发其他方法</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;age&quot;).count()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># �?】对某个条件以外的结果进行剔�?</span></span><br><span class="line">    <span class="comment"># 不会提出到你指定的这个年龄的结果</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.exclude(age=18)</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># �?】判断当前筛选到的结果是否存�?</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.filter(name=&quot;dream_1&quot;).exists()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 【必知必会N条�?</span></span><br><span class="line">	<span class="comment"># model是models.py文件中定义模型表的类名，需要提前导�?</span></span><br><span class="line">    <span class="comment"># �?】增�?</span></span><br><span class="line">    <span class="comment"># �?）model.objects.create(filed=value)</span></span><br><span class="line">    <span class="comment"># �?）model(filed=value).save()</span></span><br><span class="line">    <span class="comment"># �?】删�?</span></span><br><span class="line">    <span class="comment"># �?）model.objects.filter(filed=value).delete()</span></span><br><span class="line">    <span class="comment"># �?）model.objects.get(filed=value).delete()</span></span><br><span class="line">    <span class="comment"># �?】修�?</span></span><br><span class="line">    <span class="comment"># �?）model.objects.filter(filed=value).update(filed=new_value)</span></span><br><span class="line">    <span class="comment"># �?）obj = model.objects.get(filed=value)</span></span><br><span class="line">    <span class="comment"># obj.filed_name = value </span></span><br><span class="line">    <span class="comment"># obj.save()</span></span><br><span class="line">    <span class="comment"># �?】查�?</span></span><br><span class="line">    <span class="comment"># (7) model.objects.filter(field=value)</span></span><br><span class="line">    <span class="comment"># (8) model.objects.filter(field=value).first()</span></span><br><span class="line">    <span class="comment"># (9) model.objects.filter(field=value).last()</span></span><br><span class="line">    <span class="comment"># (10) model.objects.all() </span></span><br><span class="line">    <span class="comment"># (11) model.objects.get(filed=value)</span></span><br><span class="line">    <span class="comment"># �?】扩展方�?</span></span><br><span class="line">    <span class="comment"># (12) model.objects.filter(field=value).count() 计数</span></span><br><span class="line">    <span class="comment"># (13) model.objects.filter(field=value).values() 获取键值对结果</span></span><br><span class="line">    <span class="comment"># (14) model.objects.filter(field=value).values_list() 获取值结�?</span></span><br><span class="line">    <span class="comment"># (15) model.objects.values(&quot;field&quot;).distinct() 对结果进行去�?</span></span><br><span class="line">    <span class="comment"># (16) model.objects.filter(field=value).order_by(&quot;-filed&quot;) 降序</span></span><br><span class="line">    <span class="comment"># (17) model.objects.filter(field=value).order_by(&quot;filed&quot;) 升序</span></span><br><span class="line">    <span class="comment"># (18) model.objects.filter(field=value).exists() 判断结果是否存在</span></span><br><span class="line">    <span class="comment"># (19) model.objects.exclude(filed=value) 排除指定条件的数�?</span></span><br></pre></td></tr></table></figure>
<ul>
<li>数据库信�?</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4	jack	22	2024-06-25 13:02:38.766847	2024-06-25 13:02:38.766847</span><br><span class="line">5	jack	22	2024-06-25 13:02:43.551628	2024-06-25 13:02:43.551628</span><br><span class="line">6	tom	710	2024-06-25 13:03:09.526967	2024-06-25 13:03:09.526967</span><br><span class="line">7	tom	710	2024-06-25 13:03:11.030100	2024-06-25 13:03:11.030100</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240625213204352.png" alt="image-20240625213204352"></p>
<h2 id="【三】神奇的双下划线查询">【三】神奇的双下划线查询</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复�?</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 神奇的双下划�?</span></span><br><span class="line">    <span class="comment"># 大于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__gt=22)</span></span><br><span class="line">    <span class="comment"># # 两条数据符合</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 小于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__lt=22)</span></span><br><span class="line">    <span class="comment"># # 没有符合条件�?</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet []&gt;</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># # 大于等于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__gte=22)</span></span><br><span class="line">    <span class="comment"># # 四条符合的数�?</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;, &lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 小于等于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__lte=22)</span></span><br><span class="line">    <span class="comment"># 两条条符合的数据</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 或条�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__in=(18, 22))</span></span><br><span class="line">    <span class="comment"># # 两条条符合的数据</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 两个条件之间</span></span><br><span class="line">    <span class="comment"># 也包�?8�?2</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__range=(18, 22))</span></span><br><span class="line">    <span class="comment"># #两条条符合的数据</span></span><br><span class="line">    <span class="comment"># print(data)  # &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 模糊查询</span></span><br><span class="line">    <span class="comment"># 查人名中带有 m 的人的名�?</span></span><br><span class="line">    <span class="comment"># 强约�?区分大小�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__contains=&quot;m&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 弱约�?不区分大小写</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__icontains=&quot;M&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 以指定条件开�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__startswith=&quot;t&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 以指定条件结�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__endswith=&quot;m&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询指定那一�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(register_time__day=&quot;20&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet []&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#  查询指定那一�?</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(register_time__year=&quot;2024&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;, &lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询指定那一�?</span></span><br><span class="line">    data = UserInfo.objects.<span class="built_in">filter</span>(register_time__month=<span class="string">&quot;5&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(data) <span class="comment"># &lt;QuerySet []&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>数据库信�?</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4	jack	22	2024-06-25 13:02:38.766847	2024-06-25 13:02:38.766847</span><br><span class="line">5	jack	22	2024-06-25 13:02:43.551628	2024-06-25 13:02:43.551628</span><br><span class="line">6	tom	710	2024-06-25 13:03:09.526967	2024-06-25 13:03:09.526967</span><br><span class="line">7	tom	710	2024-06-25 13:03:11.030100	2024-06-25 13:03:11.030100</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240625213204352.png" alt="image-20240625213204352"></p>
<h2 id="【四】创建多表关�">【四】创建多表关�?</h2>
<ul>
<li>既然是多表查询，那就是不止一个表</li>
<li>在models.py文件中创建多个表</li>
<li>我们学过的表查询�?
<ul>
<li>一对一查询</li>
<li>一对多查询</li>
<li>多对多查�?</li>
</ul>
</li>
</ul>
<h3 id="�-】一对多的表">�?】一对多的表</h3>
<ul>
<li>ForeignKey方法创建一对多关系</li>
</ul>
<p>创建图书�?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建的是图书�?</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几�?</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类�?</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版�?</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>创建出版社表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建出版社表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Publisher</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br></pre></td></tr></table></figure>
<h3 id="�-】一对一的表">�?】一对一的表</h3>
<ul>
<li>OneToOneField方法创建一对一关系</li>
</ul>
<p>创建作者表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # 创建作者表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Author</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField()</span><br><span class="line">    <span class="comment"># 作者和作者详情表进行关联，一对一关系，一个作者只能有一个详�?</span></span><br><span class="line">    <span class="comment"># 一个详情对应一个作�?</span></span><br><span class="line">    author_detail = models.OneToOneField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表,作者详情表</span></span><br><span class="line">        to=<span class="string">&quot;AuthorDetail&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>创建作者详情表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建作者详情表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AuthorDetail</span>(models.Model):</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 电话</span></span><br><span class="line">    phone = models.CharField(max_length=<span class="number">11</span>)</span><br></pre></td></tr></table></figure>
<h3 id="�-】多对多的表">�?】多对多的表</h3>
<ul>
<li>
<p>ManyToManyField方法创建多对多关�?</p>
</li>
<li>
<p>需要第三张表存放两个表的关�?</p>
</li>
</ul>
<p>创建图书�?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建的是图书�?</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几�?</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类�?</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版�?</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多对多的关系</span></span><br><span class="line">    auther = models.ManyToManyField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete = models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>创建作者表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建作者表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Author</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField()</span><br><span class="line">    <span class="comment"># 作者和作者详情表进行关联，一对一关系，一个作者只能有一个详�?</span></span><br><span class="line">    <span class="comment"># 一个详情对应一个作�?</span></span><br><span class="line">    author_detail = models.OneToOneField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表,作者详情表</span></span><br><span class="line">        to=<span class="string">&quot;AuthorDetail&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># 与作者建立的第三张表</span></span><br><span class="line">    book = models.ManyToManyField(</span><br><span class="line">        <span class="comment"># 跟那张表进行关联</span></span><br><span class="line">        to=<span class="string">&quot;Book&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>创建图书和作者表关系�?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 作者和书的关系�?</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookToAuthor</span>(models.Model):</span><br><span class="line">    <span class="comment"># 字段关联作者表</span></span><br><span class="line">    author = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 关联作者的�?</span></span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删�?</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># 字段关联图书的表</span></span><br><span class="line">    book = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 关联图书的表</span></span><br><span class="line">        to=<span class="string">&quot;Book&quot;</span>,</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="�-】多对多的表方法�">�?】多对多的表方法�?</h3>
<ul>
<li>直接在这两张表的其中一张上建立第三张表</li>
</ul>
<p>比如我们在Book上建�?</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几�?</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类�?</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版�?</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多对多的关系</span></span><br><span class="line">    auther = models.ManyToManyField(</span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多对多的关系</span></span><br><span class="line">  auther = models.ManyToManyField(</span><br><span class="line">      to=<span class="string">&quot;Author&quot;</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<ul>
<li>Django会自动创建第三张�?</li>
</ul>
<h3 id="�-】总的创建表代�">�?】总的创建表代�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建出版社表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Publisher</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建的是图书�?</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几�?</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类�?</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版�?</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多对多的关系</span></span><br><span class="line">    auther = models.ManyToManyField(</span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建作者详情表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AuthorDetail</span>(models.Model):</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 电话</span></span><br><span class="line">    phone = models.CharField(max_length=<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># # 创建作者表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Author</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField()</span><br><span class="line">    <span class="comment"># 作者和作者详情表进行关联，一对一关系，一个作者只能有一个详�?</span></span><br><span class="line">    <span class="comment"># 一个详情对应一个作�?</span></span><br><span class="line">    author_detail = models.OneToOneField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表,作者详情表</span></span><br><span class="line">        to=<span class="string">&quot;AuthorDetail&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 记得迁移数据�?</span></span><br></pre></td></tr></table></figure>
<h2 id="【五】一对多的外键字�">【五】一对多的外键字�?</h2>
<h3 id="�-】添加�">�?】添加�?</h3>
<ul>
<li>create</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 【一】一对多表外键字�?</span></span><br><span class="line">   <span class="comment"># �?】添加数�? create</span></span><br><span class="line">   <span class="comment">#  Publish.objects.create(name=&quot;人民出版�?, addr=&quot;北京&quot;)</span></span><br><span class="line">   <span class="comment"># Publish.objects.create(name=&quot;上海出版�?, addr=&quot;上海&quot;)</span></span><br><span class="line">   <span class="comment"># Publish.objects.create(name=&quot;南京出版�?, addr=&quot;南京&quot;)</span></span><br><span class="line">   <span class="comment"># Publish.objects.create(name=&quot;东京出版�?, addr=&quot;东京&quot;)</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 在创建图书数据的时候要进行出版社的关联</span></span><br><span class="line">   <span class="comment"># publish_obj = Publish.objects.get(pk=2)</span></span><br><span class="line">   <span class="comment"># 方式一 �?直接�?字段 publish_id 值是指定出版社的id</span></span><br><span class="line">   <span class="comment"># Book.objects.create(title=&quot;西游�?, price=&quot;99&quot;,publish_id=publish_obj.id)</span></span><br><span class="line">   <span class="comment"># 方式�?�?在模型表中定义的字段是叫 publish 所�?直接将对象扔进去</span></span><br><span class="line">   <span class="comment"># Book.objects.create(title=&quot;红楼�?, price=&quot;88&quot;, publish=publish_obj)</span></span><br></pre></td></tr></table></figure>
<h3 id="�-】删除数�">�?】删除数�?</h3>
<ul>
<li>delete</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># �?】删除数�?-删除外键关系  delete</span></span><br><span class="line">    <span class="comment"># book中的publisher字段</span></span><br><span class="line">    <span class="comment"># 因为你在创建的时候已经添加了级联更新和级联删除所以你删除信息和修改信息都会发生变�?</span></span><br><span class="line">    <span class="comment"># Book.objects.get(pk=&quot;1&quot;).delete()# 删除了book id�?的数�?</span></span><br><span class="line">    <span class="comment"># Publisher.objects.get(pk=&quot;1&quot;).delete()# 删除了出版社的id，对应的图书也一并被删掉�?</span></span><br><span class="line">    <span class="comment"># 删除外键数据 出版社表中的数据 在图书表�?预支相关联的数据也会被删�?</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="�-】修改外键字�">�?】修改外键字�?</h3>
<ul>
<li>update</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># �?】修改外键字�?update</span></span><br><span class="line">   <span class="comment"># 我们将红楼梦�?出版社转�?出版社该怎么�?</span></span><br><span class="line">   <span class="comment"># 方法一</span></span><br><span class="line">   <span class="comment"># 我们先获得出版社的一个id</span></span><br><span class="line">   <span class="comment"># publisher_obj = Publisher.objects.get(pk=&quot;4&quot;)</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># Book.objects.filter(title=&quot;红楼�?).update(publisher=publisher_obj)</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 方法�?</span></span><br><span class="line">   <span class="comment"># 直接替换,指定书的id，替换指定印刷厂的id</span></span><br><span class="line">   <span class="comment"># id不存在就会报�?</span></span><br><span class="line">   <span class="comment"># books = Book.objects.filter(pk=6).update(publisher_id=6)</span></span><br><span class="line"><span class="comment"># 也可以放对象</span></span><br></pre></td></tr></table></figure>
<h2 id="【六】多对多的外键字�">【六】多对多的外键字�?</h2>
<h3 id="�-】添加数�">�?】添加数�?</h3>
<ul>
<li>一定要保证两个表里面有�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 图书和作者表</span></span><br><span class="line">    <span class="comment"># for i in range(1, 6):</span></span><br><span class="line">    <span class="comment">#     detail_obj = AuthorDetail.objects.create(addr=f&quot;上海_&#123;i&#125;&quot;, phone=f&quot;1&#123;i&#125;0&quot;)</span></span><br><span class="line">    <span class="comment">#     # print(detail_obj) # AuthorDetail object (1)</span></span><br><span class="line">    <span class="comment">#     Author.objects.create(name=f&quot;dream_&#123;i&#125;&quot;, age=18 * i, author_detail=detail_obj)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># for i in range(1, 6):</span></span><br><span class="line">    <span class="comment">#     Book.objects.create(</span></span><br><span class="line">    <span class="comment">#         title=f&quot;�?&#123;i&#125; 本书&quot;,</span></span><br><span class="line">    <span class="comment">#         price=str(60 * i),</span></span><br><span class="line">    <span class="comment">#         publish_id=random.randint(2, 6)</span></span><br><span class="line">    <span class="comment">#     )</span></span><br></pre></td></tr></table></figure>
<ul>
<li>要使用Django自带的机制自动生成的第三张表，models不会有第三张�?</li>
<li>需要跨表建立关�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获得书籍对象</span></span><br><span class="line">    data = book_obj = Book.objects.get(pk=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获得作者对�?</span></span><br><span class="line">    data = auther_obj = Author.objects.get(pk=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">     <span class="comment"># �?】添加多对多外键关系---关键字add</span></span><br><span class="line">    <span class="comment"># 方式一</span></span><br><span class="line">    <span class="comment"># 给book_obj书籍添加一个作�?</span></span><br><span class="line">    <span class="comment"># 获得书籍对象，在获得作者对象，书籍对象在跨到作者身�?</span></span><br><span class="line">    <span class="comment"># 你的第三章表建立建立谁的身上了就得到谁的对象然后在把和你建立多对多关系的表添加进�?</span></span><br><span class="line">    <span class="comment"># data = book_obj.auther.add(auther_obj)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># 方式�?直接放作者的id�?</span></span><br><span class="line">    <span class="comment"># book_obj.auther.add(1, 3,6,4,5)</span></span><br></pre></td></tr></table></figure>
<h3 id="�-】删除数�-2">�?】删除数�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获得书籍对象</span></span><br><span class="line">    data = book_obj = Book.objects.get(pk=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获得作者对�?</span></span><br><span class="line">    data = auther_obj = Author.objects.get(pk=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># �?】删除多对多外键关系 remove</span></span><br><span class="line">    <span class="comment"># book_obj.auther.remove(auther_obj)</span></span><br><span class="line">    <span class="comment"># 删除多个，直接给作者的id</span></span><br><span class="line">    <span class="comment"># book_obj.auther.remove(3, 1)</span></span><br></pre></td></tr></table></figure>
<h3 id="�-】修改外键关�">�?】修改外键关�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获得书籍对象</span></span><br><span class="line">   data = book_obj = Book.objects.get(pk=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 获得作者对�?</span></span><br><span class="line">   data = auther_obj = Author.objects.get(pk=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment"># �?】修改外键关�?--》set</span></span><br><span class="line">   <span class="comment"># 方式一 用set方法，弊端就是会清空其他的外键关�?</span></span><br><span class="line">   <span class="comment"># set关键字是一个列�?</span></span><br><span class="line">   <span class="comment"># 修改了数据，保留了book_obj�?6对应�?，其他的book_obj对应的书籍被清空�?</span></span><br><span class="line">   <span class="comment"># book_obj.auther.set([3])</span></span><br><span class="line">   <span class="comment"># 方式�?先用 remove 移除外键关系 再用 add 添加外键关系</span></span><br><span class="line">   <span class="comment"># book_obj.auther.remove(auther_obj)</span></span><br><span class="line">   <span class="comment"># book_obj.auther.add(auther_obj)</span></span><br></pre></td></tr></table></figure>
<h1>多表查询（正反向查询�?</h1>
<h2 id="【一】什么是正反向查�">【一】什么是正反向查�?</h2>
<h3 id="�-】正向查�">�?】正向查�?</h3>
<ul>
<li>外键字段在自己身上就叫正向查�?
<ul>
<li>有外键关系的两张�?从有外检字段的表向另一张无外键字段的表查询数据的时候就是正�?</li>
</ul>
</li>
<li>正向查询的时候，直接按照字段查询</li>
</ul>
<h3 id="�-】反向查�">�?】反向查�?</h3>
<ul>
<li>外键字段不在自己身上，我查你就叫反向查询
<ul>
<li>有外键关系的两张�?从无外键字段的表向另一张有外键字段表查询数据的时候就是反�?</li>
</ul>
</li>
<li>反向查询的时候，要使用关键字_set</li>
</ul>
<h2 id="【二】多表查询案�">【二】多表查询案�?</h2>
<h3 id="�-】子查询（基于对象的跨表查询�">�?】子查询（基于对象的跨表查询�?</h3>
<h4 id="�-）查询书籍主键为14的出版社">�?）查询书籍主键为14的出版社</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查询书籍主键�?的出版社</span></span><br><span class="line">   <span class="comment">#得到图书对象</span></span><br><span class="line">   book_obj = Book.objects.get(pk=<span class="number">14</span>)</span><br><span class="line">   <span class="comment">#图书与出版社是一对多关系</span></span><br><span class="line">   <span class="built_in">print</span>(book_obj)  <span class="comment"># Book object (14)</span></span><br><span class="line">   <span class="comment">#不要带_id</span></span><br><span class="line">   publisher_id = book_obj.publisher_id</span><br><span class="line">   <span class="built_in">print</span>(publisher_id)  <span class="comment"># 6</span></span><br><span class="line">   <span class="comment">#得到出版社对�?</span></span><br><span class="line">   publisher_obj = book_obj.publisher</span><br><span class="line">   <span class="built_in">print</span>(publisher_obj)  <span class="comment"># Publisher object (6)</span></span><br><span class="line">   <span class="comment">#对象.name得到出版�?</span></span><br><span class="line">   publisher_name = book_obj.publisher.name</span><br><span class="line">   <span class="built_in">print</span>(publisher_name)  <span class="comment"># 4出版�?</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）查询数据主键为1的作�">�?）查询数据主键为1的作�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键�?的作�?</span></span><br><span class="line">  <span class="comment"># 书籍与作者是多对多关�?</span></span><br><span class="line">  <span class="comment"># 得到主键id�?的对�?</span></span><br><span class="line">  book_obj = Book.objects.<span class="built_in">filter</span>(pk=<span class="number">1</span>).first()</span><br><span class="line">  <span class="built_in">print</span>(book_obj) <span class="comment"># Book object (1)</span></span><br><span class="line">  res = book_obj.auther</span><br><span class="line">  <span class="built_in">print</span>(res)  <span class="comment"># user.Author.None</span></span><br><span class="line">  auther_obj = book_obj.auther.<span class="built_in">all</span>()</span><br><span class="line">  <span class="built_in">print</span>(auther_obj)  <span class="comment"># &lt;QuerySet [&lt;Author: Author object (2)&gt;]&gt;</span></span><br><span class="line">  author_obj = book_obj.auther.<span class="built_in">all</span>().values(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(author_obj)  <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom2&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-查询作者主键为3的电话号�">(3)查询作者主键为3的电话号�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询作者主键为3的电话号�?</span></span><br><span class="line">   <span class="comment"># 得到作者对�?</span></span><br><span class="line">   <span class="comment"># 作者与作者详情是一对一关系</span></span><br><span class="line">   author_obj = Author.objects.<span class="built_in">filter</span>(pk=<span class="number">3</span>).first()</span><br><span class="line">   <span class="built_in">print</span>(author_obj)  <span class="comment"># Author object (3)</span></span><br><span class="line">   <span class="comment"># 得到作者详情对�?</span></span><br><span class="line">   author_detail_obj = author_obj.author_detail</span><br><span class="line">   <span class="built_in">print</span>(author_detail_obj)  <span class="comment"># AuthorDetail object (3)</span></span><br><span class="line">   <span class="comment"># 对象.字段</span></span><br><span class="line">   phone = author_detail_obj.phone</span><br><span class="line">   <span class="built_in">print</span>(phone)  <span class="comment"># 130</span></span><br></pre></td></tr></table></figure>
<h4 id="4-查询出版社是-1出版�-的书">(4)查询出版社是  1出版�? 的书</h4>
<ul>
<li>在下面<code>res</code>只是一个待执行的查询的“准备”状�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询出版社是  1出版�? 的书</span></span><br><span class="line">   <span class="comment"># 出版社与书是多对一关系</span></span><br><span class="line">   <span class="comment"># 没有外键关系的表要向有外键关系的表查，就是反向查询加_set</span></span><br><span class="line">   <span class="comment"># 得到出版社对�?</span></span><br><span class="line">   publisher_obj = Publisher.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;1出版�?).first()</span></span><br><span class="line"><span class="string">   print(publisher_obj)  # Publisher object (2)</span></span><br><span class="line"><span class="string">   # 反向查询加_set</span></span><br><span class="line"><span class="string">   # 只是一个执行状态的准备，并没有进行查询</span></span><br><span class="line"><span class="string">   res = publisher_obj.book_set</span></span><br><span class="line"><span class="string">   print(res)  # user.Book.None</span></span><br><span class="line"><span class="string">   # 得到图书对象</span></span><br><span class="line"><span class="string">   book_obj = publisher_obj.book_set.all()</span></span><br><span class="line"><span class="string">   print(book_obj)  # &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br><span class="line"><span class="string">   # values得到想要的数�?</span></span><br><span class="line"><span class="string">   publisher_name = publisher_obj.book_set.all().values(&quot;</span>title<span class="string">&quot;)</span></span><br><span class="line"><span class="string">   print(publisher_name)  # &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;�?本书&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）查询作者是tom1写过的书">�?）查询作者是tom1写过的书</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询作者是tom1写过的书</span></span><br><span class="line">   <span class="comment"># 作者和图书是多对多关系</span></span><br><span class="line">   <span class="comment"># 得到作者的对象</span></span><br><span class="line">   author_obj = Author.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;tom1&quot;</span>).first()</span><br><span class="line">   <span class="built_in">print</span>(author_obj)  <span class="comment"># Author object (1)</span></span><br><span class="line">   <span class="comment"># 得到图书对象</span></span><br><span class="line">   book_obj = author_obj.book_set</span><br><span class="line">   <span class="built_in">print</span>(book_obj)  <span class="comment"># user.Book.None</span></span><br><span class="line">   <span class="comment"># 得到图书的名�?</span></span><br><span class="line">   book_name = author_obj.book_set.<span class="built_in">all</span>().values(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(book_name)  <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;�?本书&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="6-查询手机号是110的作者姓�">(6)查询手机号是110的作者姓�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询手机号是110的作者姓�?</span></span><br><span class="line">    <span class="comment"># 作者和作者详情是一对一关系</span></span><br><span class="line">    <span class="comment"># 得到作者详情对�?</span></span><br><span class="line">    author_detail_obj = AuthorDetail.objects.<span class="built_in">filter</span>(phone=<span class="number">110</span>).first()</span><br><span class="line">    <span class="built_in">print</span>(author_detail_obj)</span><br><span class="line">    <span class="comment"># 主键在作者身上，反向查询，但是是一对一关系，不需要加_set</span></span><br><span class="line">    author_obj = author_detail_obj.author</span><br><span class="line">    <span class="built_in">print</span>(author_obj)  <span class="comment"># Author object (1)</span></span><br><span class="line">    <span class="comment"># 得到作者的名字</span></span><br><span class="line">    author_name = author_obj.name</span><br><span class="line">    <span class="built_in">print</span>(author_name)  <span class="comment"># tom1</span></span><br></pre></td></tr></table></figure>
<h4 id="7-小结">(7)小结</h4>
<ul>
<li>基于对象的反向查�?</li>
<li>什么时候需要加_set.all()
<ul>
<li>查询结果是多个的时候需要加</li>
</ul>
</li>
<li>一对一表关系不区分正反�?因为关系唯一</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正向查询：有外键字段向没有外键字段的表查 查询方式�?.字段�?</span></span><br><span class="line"><span class="comment"># 反向查询：没有外键字段向有外键字段的表查 查询方式�?.有外键字段的表明_set</span></span><br></pre></td></tr></table></figure>
<h3 id="�-】联表查�">�?】联表查�?</h3>
<ul>
<li>基于双下划线的跨表查�?</li>
<li>联表查询就是将两张表合并在一起查询数�?</li>
</ul>
<h4 id="�-）查询tom1的手机号和作者的名字">�?）查询tom1的手机号和作者的名字</h4>
<ul>
<li>
<p>正向查询</p>
</li>
<li>
<p>使用双下划线（查询信息的表明__字段�?</p>
</li>
<li>
<p>查询到作者信息在.value.(需要查询信息的表__需要查询的字段,其他字段)</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询tom1的手机号和作者的名字</span></span><br><span class="line">   <span class="comment"># 正向查询</span></span><br><span class="line">   <span class="comment"># 作者和作者详情是一对一关系</span></span><br><span class="line">   name_phone = Author.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;tom1&quot;</span>).values(</span><br><span class="line">       <span class="string">&quot;name&quot;</span>,</span><br><span class="line">       <span class="string">&quot;author_detail__phone&quot;</span></span><br><span class="line">   )</span><br><span class="line">   <span class="built_in">print</span>(name_phone)</span><br><span class="line">   <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom1&#x27;, &#x27;author_detail__phone&#x27;: &#x27;110&#x27;&#125;]&gt;</span></span><br><span class="line">   <span class="comment"># first：取到单个数�?</span></span><br><span class="line">   author_dict = name_phone.first()</span><br><span class="line">   <span class="built_in">print</span>(author_dict)  <span class="comment"># &#123;&#x27;name&#x27;: &#x27;tom1&#x27;, &#x27;author_detail__phone&#x27;: &#x27;110&#x27;&#125;</span></span><br><span class="line">   <span class="comment"># 取到名字</span></span><br><span class="line">   name = name_phone.first().get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(name)  <span class="comment"># tom1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>反向查询</li>
<li>先拿到详情，再用作者详情关联作者表，通过 __字段的方�?过滤出我们想要的指定数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询tom1的手机号和作者的名字</span></span><br><span class="line">    <span class="comment"># 反向查询</span></span><br><span class="line">    phone_name = AuthorDetail.objects.<span class="built_in">filter</span>(author__name=<span class="string">&quot;tom1&quot;</span>).values(</span><br><span class="line">        <span class="string">&quot;phone&quot;</span>,</span><br><span class="line">        <span class="string">&quot;author__name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(phone_name)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;phone&#x27;: &#x27;110&#x27;, &#x27;author__name&#x27;: &#x27;tom1&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）查询书籍主键为1的出版社的名字和书的名字">�?）查询书籍主键为1的出版社的名字和书的名字</h4>
<ul>
<li>正向查询</li>
<li>先过滤出书籍ID�?的书籍对象，再去关联出版者表，利用__字段取�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键�?的出版社的名字和书的名字</span></span><br><span class="line">    <span class="comment"># 正向查询</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(pk=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;title&quot;</span>,</span><br><span class="line">        <span class="string">&quot;publisher__name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;publisher__name&#x27;: &#x27;1出版�?&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>反向查询</li>
<li>先查询到指定出版社，再从出版社反向找到书籍名�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键�?的出版社的名字和书的名字</span></span><br><span class="line">    <span class="comment"># 反向查询</span></span><br><span class="line">    data = Publisher.objects.<span class="built_in">filter</span>(book__id=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;name&quot;</span>,</span><br><span class="line">        <span class="string">&quot;book__title&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;1出版�?, &#x27;book__title&#x27;: &#x27;�?本书&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-查询书籍主键�-的作者的名字">(3)查询书籍主键�?的作者的名字</h4>
<ul>
<li>正向</li>
<li>先拿�?书籍主键ID�?的对象，再关联作者信息表，通过__字段取�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键�?的作者的名字</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(pk=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;auther__name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;auther__name&#x27;: &#x27;tom2&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>反向</li>
<li>先拿�?书籍ID�?的作者数据再去取作者的名字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键�?的作者的名字</span></span><br><span class="line">    data = Author.objects.<span class="built_in">filter</span>(book__id=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom2&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="4-查询书籍主键�-的作者的手机�">(4)查询书籍主键�?的作者的手机�?</h4>
<ul>
<li>跨越了三个表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键�?的作者的手机�?</span></span><br><span class="line">    data = Author.objects.<span class="built_in">filter</span>(book__id=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;author_detail__phone&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;author_detail__phone&#x27;: &#x27;120&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）小�">�?）小�?</h4>
<ul>
<li>掌握了双下划线和正反向可以无限跨�?</li>
</ul>
<h2 id="【三】聚合函数（aggregate�">【三】聚合函数（aggregate�?</h2>
<ul>
<li>
<p>正常情况下我们需要进行分组才能进行聚合函数的运算</p>
</li>
<li>
<p>使用聚合函数时：利用关键字aggregate可以不分组进行某个字段的聚合函数</p>
</li>
</ul>
<h3 id="�-】引入聚合函�">�?】引入聚合函�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Max, Min, Sum, Count, Avg</span><br></pre></td></tr></table></figure>
<h3 id="�-】聚合函数案�">�?】聚合函数案�?</h3>
<ul>
<li>第一步需要先导入聚合函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Max, Min, Sum, Count, Avg</span><br></pre></td></tr></table></figure>
<h4 id="1-求所有书的平均价�">(1)求所有书的平均价�?</h4>
<ul>
<li>利用聚合函数不用分组就可以的到的结果的方法：aggregate</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求所有书的平均数</span></span><br><span class="line">    <span class="keyword">from</span> django.db.models <span class="keyword">import</span> Sum, Avg</span><br><span class="line">    book_avg_price = Book.objects.aggregate(Avg(<span class="string">&quot;price&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(book_avg_price)</span><br><span class="line">    <span class="comment"># &#123;&#x27;price__avg&#x27;: Decimal(&#x27;60.000000&#x27;)&#125;</span></span><br><span class="line">    <span class="keyword">from</span> django.db.models <span class="keyword">import</span> Sum, Avg</span><br><span class="line">    book_avg_price = Book.objects.aggregate(Avg(<span class="string">&quot;price&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(book_avg_price)</span><br><span class="line">    <span class="comment"># &#123;&#x27;price__avg&#x27;: Decimal(&#x27;60.000000&#x27;)&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-一次性用很多方法">(2)一次性用很多方法</h4>
<ul>
<li>利用聚合函数不用分组就可以的到的结果的方法：aggregate</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Sum, Avg, Max, Min, Count</span><br><span class="line"></span><br><span class="line">    book_avg_price = Book.objects.aggregate(Avg(<span class="string">&quot;price&quot;</span>), Max(<span class="string">&quot;price&quot;</span>), Min(<span class="string">&quot;price&quot;</span>), Sum(<span class="string">&quot;price&quot;</span>), Count(<span class="string">&quot;price&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(book_avg_price)</span><br><span class="line">    <span class="comment"># &#123;&#x27;price__avg&#x27;: Decimal(&#x27;60.000000&#x27;), &#x27;price__max&#x27;: Decimal(&#x27;100.00&#x27;), &#x27;price__min&#x27;: Decimal(&#x27;20.00&#x27;), &#x27;price__sum&#x27;: Decimal(&#x27;300.00&#x27;), &#x27;price__count&#x27;: 5&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="【四】分组查询（关键字：annotate�">【四】分组查询（关键字：annotate�?</h2>
<h3 id="�-】引�">�?】引�?</h3>
<ul>
<li>按照指定条件对数据进行分�?</li>
</ul>
<h3 id="�-】分组查询语�">�?】分组查询语�?</h3>
<ul>
<li>models 后面跟的是什么，就是按什么分�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res = models.Book.objects.annotate()</span><br></pre></td></tr></table></figure>
<h3 id="�-】案�">�?】案�?</h3>
<h4 id="�-）统计每一本书的作者个�">�?）统计每一本书的作者个�?</h4>
<ul>
<li>Book分组，然后计算作者的个数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line"><span class="keyword">from</span> user.models <span class="keyword">import</span> Book</span><br><span class="line">   <span class="comment"># 统计每一本书的作者个�?</span></span><br><span class="line">   <span class="comment"># 一定要看你的字段名写错了没，错了就会找不到数据</span></span><br><span class="line">   <span class="comment"># 获得分组后的对象</span></span><br><span class="line">   data = Book.objects.annotate(author_number=Count(<span class="string">&quot;auther&quot;</span>))</span><br><span class="line">   <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;, &lt;Book: Book object (2)&gt;, &lt;Book: Book object (15)&gt;, &lt;Book: Book object (16)&gt;, &lt;Book: Book object (17)&gt;]&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 获得分组后的数据</span></span><br><span class="line">   data = Book.objects.annotate(author_number=Count(<span class="string">&quot;auther&quot;</span>)).values(</span><br><span class="line">       <span class="string">&quot;title&quot;</span>,</span><br><span class="line">       <span class="string">&quot;author_number&quot;</span></span><br><span class="line">   )</span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 0&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 4&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 0&#125;]&gt;</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 等价�?</span></span><br><span class="line">    data = Book.objects.annotate(author_number=Count(<span class="string">&quot;auther__pk&quot;</span>)).values(</span><br><span class="line">       <span class="string">&quot;title&quot;</span>,</span><br><span class="line">       <span class="string">&quot;author_number&quot;</span></span><br><span class="line">   )</span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 0&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 4&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;author_number&#x27;: 0&#125;]&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="�-）统计每个出版社最便宜的书的价�">�?）统计每个出版社最便宜的书的价�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line"><span class="keyword">from</span> user.models <span class="keyword">import</span>  Publisher</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计每个出版社最便宜的书的价�?</span></span><br><span class="line">data = Publisher.objects.annotate(min_book_price=Min(<span class="string">&#x27;book__price&#x27;</span>)).values(</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;min_book_price&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;1出版�?, &#x27;min_book_price&#x27;: Decimal(&#x27;20.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;4出版�?, &#x27;min_book_price&#x27;: Decimal(&#x27;40.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;2出版�?, &#x27;min_book_price&#x27;: Decimal(&#x27;80.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;3出版�?, &#x27;min_book_price&#x27;: Decimal(&#x27;100.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;5出版�?, &#x27;min_book_price&#x27;: None&#125;]&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="�-）统计不止一个作者的图书">�?）统计不止一个作者的图书</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> Book</span><br><span class="line">    <span class="comment"># 统计不止一个作者的图书</span></span><br><span class="line">    <span class="comment"># 先按图书分组</span></span><br><span class="line">    <span class="comment"># 再筛选不止一个作者的图书</span></span><br><span class="line">    data = Book.objects.annotate(one_author=Count(<span class="string">&quot;auther&quot;</span>)).<span class="built_in">filter</span>(one_author__gt=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;title&quot;</span>,</span><br><span class="line">        <span class="string">&quot;one_author&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;�?本书&#x27;, &#x27;one_author&#x27;: 4&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="4-查询每个作者出的书总价�">(4)查询每个作者出的书总价�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> Author</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询每个作者出的书总价�?</span></span><br><span class="line">    data = Author.objects.annotate(sum_book_price=Sum(<span class="string">&quot;book__price&quot;</span>)).values(</span><br><span class="line">        <span class="string">&quot;name&quot;</span>,</span><br><span class="line">        <span class="string">&quot;sum_book_price&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom2&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;80.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;tom1&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;60.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;tom3&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;140.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;tom4&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;60.00&#x27;)&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="5-小结">(5)小结</h4>
<ul>
<li>
<p>下面这个语法</p>
</li>
<li>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Book.objects.values(<span class="string">&#x27;price&#x27;</span>).annotate()</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>如果annotate前面没东西，则会按照Book进行分组,如果前面有参数就会按照前面的参数’price’进行分组</p>
</li>
</ul>
<h2 id="【五】F和Q查询">【五】F和Q查询</h2>
<h3 id="�-】引�-2">�?】引�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="keyword">from</span> django.db.models <span class="keyword">import</span> F, Q</span><br></pre></td></tr></table></figure>
<h3 id="�-】F查询">�?】F查询</h3>
<ul>
<li>能够帮你获取到列表中的某个字段对应的数据</li>
<li>注意：在操作字符串类型的时候，F查询不能够直接做到字符串的拼�?</li>
</ul>
<h4 id="�-）查询库存数大于销量的书籍">�?）查询库存数大于销量的书籍</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># F 查询 : 帮助我们直接获取到表中的某个字段对应的数�?</span></span><br><span class="line">res = models.Book.objects.<span class="built_in">filter</span>(sales__gt=F(<span class="string">&#x27;stock&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(res)  <span class="comment"># &lt;QuerySet [&lt;Book: 水浒�?]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="�-）将所有的书籍价格提升100">�?）将所有的书籍价格提升100</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> user.models <span class="keyword">import</span> Book</span><br><span class="line">   <span class="keyword">from</span> django.db.models <span class="keyword">import</span> F</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 将所有的书籍价格提升100</span></span><br><span class="line">   data = Book.objects.update(price=F(<span class="string">&quot;price&quot;</span>) + <span class="number">100</span>)</span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   <span class="comment"># 5</span></span><br><span class="line">   <span class="comment"># 代表更新�?条数�?</span></span><br></pre></td></tr></table></figure>
<h4 id="3-将所有的数据后面添加-nb">(3)将所有的数据后面添加_nb</h4>
<ul>
<li>
<p>Value 是一个用于在查询中插入静态值的类，这个值可以是任何Django支持的数据库数据类型</p>
<ul>
<li>
<pre><code class="language-python">from django.db.models import Value
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- Concat:在操作字符串的时候F查询不能直接操作字符串，需要引入这个方�?</span><br><span class="line"></span><br><span class="line">  - ````python</span><br><span class="line">    from django.db.models.functions import Concat</span><br><span class="line">    ````</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">from user.models import Book</span><br><span class="line">    from django.db.models import F</span><br><span class="line">    from django.db.models import Value</span><br><span class="line">    from django.db.models.functions import Concat</span><br><span class="line">    # 将所有的书籍后面添加_nb</span><br><span class="line">    # 在操作字符串的时候F查询不能直接操作字符串，需要引入一个方法，Concat</span><br><span class="line">    # Value：Value 是一个用于在查询中插入静态值的类，这个值可以是任何Django支持的数据库数据类型</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    data = Book.objects.update(title=Concat(F(&quot;title&quot;),Value(&#x27;_nb&#x27;)))</span><br><span class="line">    print(data)</span><br><span class="line">    # 5</span><br><span class="line">    # 更新�?条数�?</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="�-】Q查询">�?】Q查询</h3>
<ul>
<li>关键字filter()方法中的关键字参数查询都是一起进�?and’</li>
<li>如果你需要执行更复杂的查�?列如ORM语句)，你可以使用Q对象</li>
</ul>
<h4 id="1-查询卖出数大�-00或者价格小�-00的书�">(1)查询卖出数大�?00或者价格小�?00的书�?</h4>
<ul>
<li>直接使用 filter 查询数据，逗号隔开,里面放的参数�?and 关系</li>
<li>两个条件都必须符�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询卖出数大�?00或者价格小�?00的书�?</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(sales__gt=<span class="number">100</span>, price__lt=<span class="number">500</span>)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>直接使用 Q 查询数据，逗号隔开,里面放的参数还是 and 关系
<ul>
<li>两个条件都必须成�?</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = Book.objects.<span class="built_in">filter</span>(Q(sales__gt=<span class="number">100</span>), Q(price__lt=<span class="number">500</span>))</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>直接使用 Q 查询数据，逗号可以换成其他连接符达到效�?</p>
<ul>
<li>
<p>or：任一个条件符合即�?</p>
</li>
<li>
<p>关键字作为连接符，会阉割条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = Book.objects.<span class="built_in">filter</span>(Q(sales__gt=<span class="number">100</span>) <span class="keyword">or</span> Q(price__lt=<span class="number">500</span>))</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>|：或关系</p>
<ul>
<li>有一个成立就可以</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = Book.objects.<span class="built_in">filter</span>(Q(sales__gt=<span class="number">100</span>) | Q(price__lt=<span class="number">500</span>))</span><br><span class="line">    <span class="built_in">print</span>(data) <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="�-）Q的高阶用�">�?）Q的高阶用�?</h4>
<ul>
<li>
<p>能够将查询条件的左边也变�?字符串形�?</p>
</li>
<li>
<p>自己创造查询条�?</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询卖出数大�?00或者价格小�?00的书�?</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成Q对象</span></span><br><span class="line">    q = Q()</span><br><span class="line">    <span class="comment"># 创建Q对象的连接条�?</span></span><br><span class="line">    <span class="comment"># or：满足一个条件即�?</span></span><br><span class="line">    <span class="comment"># and: 两个条件都要满足</span></span><br><span class="line">    <span class="comment"># 默认是and关系</span></span><br><span class="line">    q.connector = <span class="string">&quot;or&quot;</span></span><br><span class="line">    <span class="comment"># 添加第一个加条件--&gt;左边</span></span><br><span class="line">    q.children.append((<span class="string">&quot;sales__gt&quot;</span>, <span class="number">100</span>))</span><br><span class="line">    <span class="comment"># 添加第二个加条件--&gt;右边</span></span><br><span class="line">    q.children.append((<span class="string">&quot;price__lt&quot;</span>, <span class="number">500</span>))</span><br><span class="line">    <span class="comment"># 查询</span></span><br><span class="line">    <span class="comment"># filter 除了可以放条�?还可以放对象</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(q)</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>可以在去对象�?children里面 无限制的添加元素 添加元组，元组里两个元素</p>
</li>
<li>
<p>而且还支持修�?or 、and</p>
</li>
<li>
<p>默认是and</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 或查�?</span></span><br><span class="line">q = Q()</span><br><span class="line">q |= Q(条件一)</span><br><span class="line">q |= Q(条件�?</span><br><span class="line">qs = Model.objects.<span class="built_in">filter</span>(q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 并查�?</span></span><br><span class="line">q = Q()</span><br><span class="line">q &amp;= Q(条件一)</span><br><span class="line">q &amp;= Q(条件�?</span><br><span class="line">qs = Model.objects.<span class="built_in">filter</span>(q)</span><br></pre></td></tr></table></figure>
<h1>Django中开启事�?</h1>
<h2 id="【一】ACID特�">【一】ACID特�?</h2>
<ul>
<li>原子性（Atomicity�?
<ul>
<li>事务被称为一个不可再分隔的原子操作单�?</li>
<li>要么全部操作成功并永久保存，要么全部操作失败并回滚到事务开始前的状态，不存在部分成功或部分失败的情�?</li>
</ul>
</li>
<li>一致性（Consistency�?
<ul>
<li>事务执行前后，数据库应保持一致的状�?</li>
<li>在事务开始之前和结束之后，数据库必须满足所有的完整性约束，如列级别的约束、外键关系等</li>
</ul>
</li>
<li>隔离性（Isolation�?
<ul>
<li>事务的执行结果对其他并发执行的事务是隔离�?</li>
<li>一个事务的执行不应受到其他事务的干扰，各个事务之间应该相互独立工作，从而避免数据的不一致�?</li>
</ul>
</li>
<li>持久性（Durability�?
<ul>
<li>一旦事务被提交，其结果应该永久保存在数据库中，并且可以被系统故障恢�?</li>
<li>即使系统发生宕机或崩溃，事务提交后的更改也应该是永久性的</li>
</ul>
</li>
</ul>
<h2 id="【二】事务名�">【二】事务名�?</h2>
<ul>
<li>开启事务：Start Transaction</li>
<li>事务结束：End Transaction</li>
<li>提交事务：Commit Transaction</li>
<li>回滚事务：Rollback Transaction</li>
</ul>
<h2 id="【三】默认事务行�">【三】默认事务行�?</h2>
<ul>
<li>Django是支持事务操作的，它的默认事务行为是自动提交</li>
<li>具体表现形式为：每次数据库操�?比如调用save()方法)会立即被提交到数据库�?</li>
<li>如果你希望把连续的SQL操作包裹在一个事务里，就需要手动开启事�?</li>
</ul>
<h2 id="【四】开启事�">【四】开启事�?</h2>
<h3 id="�-】开启全局事务">�?】开启全局事务</h3>
<ul>
<li>在settings.py中的数据库中配置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,</span><br><span class="line">        <span class="comment"># 手动创建数据�?</span></span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&quot;django_two&quot;</span>,</span><br><span class="line">        <span class="string">&quot;USER&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PASSWORD&quot;</span>: <span class="string">&quot;1234567&quot;</span>,</span><br><span class="line">        <span class="string">&quot;HOST&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PORT&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">        <span class="string">&quot;CHARSET&quot;</span>: <span class="string">&quot;utf8mb4&quot;</span>,</span><br><span class="line">        <span class="comment"># 开启全局事务，绑定的是http请求响应整个过程</span></span><br><span class="line">        <span class="string">&quot;ATOMIC_REQUESTS&quot;</span>: <span class="literal">True</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>解析
<ul>
<li>每当有请求过来时，Django会在调用视图方法前开启一个事务�?</li>
<li>如果完成了请求处理并正确返回了结果，Django就会提交该事务�?</li>
<li>否则，Django会回滚该事务</li>
</ul>
</li>
</ul>
<h3 id="�-】取消局部的事务">�?】取消局部的事务</h3>
<ul>
<li>方法就是，在你要取消事务的视图函数上写一个添加一个装饰器</li>
<li>首先导入一个方�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>@transactionnon_atomic_requests</code>装饰器让某些视图函数方法不受事务的控�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@transaction.non_atomic_requests</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<ul>
<li>如有多个数据库，让使用otherdb的视图不受事务控�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@transaction.non_atomic_requests(<span class="params">using=<span class="string">&quot;otherdb&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<ul>
<li>虽然全局开启事务很简单，但Django并不推荐开启全局事务�?</li>
<li>因为一旦将事务�?HTTP 请求绑定到一起时，每一个请求都会开启事务，当访问量增长到一定的时候会造成很大的性能损�?</li>
<li>推荐使用局部开启事�?</li>
</ul>
<h3 id="�-】局部开启事�">�?】局部开启事�?</h3>
<ul>
<li>借助一个方�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>给视图函数添加装饰器</li>
</ul>
<h4 id="�-）在函数头上增加装饰�">�?）在函数头上增加装饰�?</h4>
<ul>
<li>第一步：引入Django内部的事务模�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>第二部：在视图函数上添加装饰�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加局部开启事务装饰器</span></span><br><span class="line"><span class="meta">@transaction.non_atomic_requests</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<h4 id="�-）在类内部的函数头上增加装饰�">�?）在类内部的函数头上增加装饰�?</h4>
<ul>
<li>第一步：引入模块</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>第二�?添加在类里面的函数头�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfo</span>(<span class="title class_ inherited__">View</span>):</span><br><span class="line">    <span class="comment"># 添加局部开启事务装饰器</span></span><br><span class="line"><span class="meta">    @transaction.atomic</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request</span>):</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, request</span>):</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<h4 id="�-）自定义事务�-–-Savepoint回滚">�?）自定义事务�?–&gt;<strong>Savepoint回滚</strong></h4>
<ul>
<li>自己设定开启事务的�?</li>
<li>一旦发生异常或错误，我们使用savepoint_rollback方法让程序回滚到指定的保存点</li>
<li>如果没有问题，就使用savepoint_commit方法提交事务</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 开启事�?</span></span><br><span class="line">    <span class="keyword">with</span> transaction.atomic():</span><br><span class="line">        <span class="comment"># 记录事务起点</span></span><br><span class="line">        sid = transaction.savepoint()</span><br><span class="line">        <span class="comment"># 异常捕获</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment">#执行你的代码</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment"># 进行事务的回�?</span></span><br><span class="line">            transaction.savepoint_rollback(sid)</span><br><span class="line">        <span class="comment"># 没有发生错误就提交事�?</span></span><br><span class="line">        transaction.savepoint_commit(sid)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<h4 id="4-事务提交后回调函�">(4)事务提交后回调函�?</h4>
<ul>
<li>意思就是：当前事务提交后立即执行额外的任务</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># �?</span></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_something</span>():</span><br><span class="line">  <span class="keyword">pass</span>  <span class="comment"># send a mail, invalidate a cache, fire off a Celery task, etc.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">transaction.on_commit(do_something)</span><br></pre></td></tr></table></figure>
<h1>字段及字段参数的补充</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># 【一】CharField 字符串类�?</span></span><br><span class="line"><span class="comment"># max_length 规定字符串的长度</span></span><br><span class="line"><span class="comment"># models.CharField(max_length=25)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【二】IntegerField 整数类型</span></span><br><span class="line"><span class="comment"># 只能放数字类�?</span></span><br><span class="line"><span class="comment"># 用数字表�?支付方式 微信 支付�?花呗 ...</span></span><br><span class="line"><span class="comment"># 用数字代表字符串</span></span><br><span class="line"><span class="comment"># models.IntegerField(choices=((1, &quot;微信&quot;), (2, &quot;支付�?), (3, &quot;花呗&quot;)))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【三】BooleanField 布尔值类�?</span></span><br><span class="line"><span class="comment"># 可以�?0 / 1 也可以放 True / False</span></span><br><span class="line"><span class="comment"># models.BooleanField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【四】EmailField 邮箱</span></span><br><span class="line"><span class="comment"># 必须符合邮箱格式才能被存进去</span></span><br><span class="line"><span class="comment"># models.EmailField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【五】TextField 大文本字�?</span></span><br><span class="line"><span class="comment"># 大量的文�?</span></span><br><span class="line"><span class="comment"># models.TextField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【六】AutoField 自动生成id</span></span><br><span class="line"><span class="comment"># models.AutoField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【七】DateTimeField 时间日期</span></span><br><span class="line"><span class="comment"># auto_now 第一次创建的时候的时间</span></span><br><span class="line"><span class="comment"># auto_now_add 以后每次更新的时候的时间</span></span><br><span class="line"><span class="comment"># models.DateTimeField(</span></span><br><span class="line"><span class="comment">#     auto_now=True,</span></span><br><span class="line"><span class="comment">#     auto_now_add=True</span></span><br><span class="line"><span class="comment"># )</span></span><br><span class="line"><span class="comment"># models.DateField()</span></span><br><span class="line"><span class="comment"># models.TimeField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># �?】FileField 文件数据</span></span><br><span class="line"><span class="comment"># models.FileField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># �?】ImageField 图片数据</span></span><br><span class="line"><span class="comment"># models.ImageField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># �?0】外键关系字�?</span></span><br><span class="line"><span class="comment"># 一对多关系</span></span><br><span class="line"><span class="comment"># models.ForeignKey()</span></span><br><span class="line"><span class="comment"># 一对一关系</span></span><br><span class="line"><span class="comment"># models.OneToOneField()</span></span><br><span class="line"><span class="comment"># 多对多关�?</span></span><br><span class="line"><span class="comment"># models.ManyToManyField()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【二】字段参�?</span></span><br><span class="line"><span class="comment"># default 默认�?</span></span><br><span class="line"><span class="comment"># null 是否为空</span></span><br><span class="line"><span class="comment"># blank 是否为空 从admin后台插入数据逇时候是否可以为�?</span></span><br><span class="line"><span class="comment"># unique 是否唯一</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【三】自己看 数据库字段优�?defer / only</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.9%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5%EF%BC%8C%E5%8F%91%E5%B1%95%E5%8F%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.9%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5%EF%BC%8C%E5%8F%91%E5%B1%95%E5%8F%B2/" class="post-title-link" itemprop="url">1.9����ϵͳ�����չʷ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>操作系统</h1>
<h2 id="【一】进程的概念">【一】进程的概念</h2>
<ul>
<li>进程就在电脑上正在执行的一个过�?</li>
<li>进程来源于操作系统，是操作系统最核心的概念，是一个抽象问�?</li>
</ul>
<h2 id="【二】为什么要有操作系�">【二】为什么要有操作系�?</h2>
<ul>
<li>筹备所有的硬件就有了操作系统的这个概念</li>
<li>硬盘包括：cpu，硬盘，内存条，显卡，主板。。�?</li>
</ul>
<ol>
<li>一开始要筹备所有操作硬件，必须掌握硬件的每一个细节，很繁琐，开发效率慢</li>
<li>优化：将一部分功能和硬件封装起来，进行优化
<ul>
<li>就像我们的面条版，包装成函数版，再到我们的类</li>
</ul>
</li>
<li>最后诞生了操作系统，将细节的操作功能和操作步骤封装起来，而是暴露给用户一些可以操作的接口和步�?
<ul>
<li>用户不需要了解自己的硬件细节就可以直接操作硬�?</li>
</ul>
</li>
</ol>
<h2 id="【三】什么是操作系统">【三】什么是操作系统</h2>
<ul>
<li>操作系统就是一个协调、管理和控制计算机硬件资源和软件资源的控制程�?</li>
<li>操作系统是位于系统硬件和应用程序之间的中间介�?</li>
</ul>
<h2 id="【四】操作系统的功能">【四】操作系统的功能</h2>
<h3 id="�-】隐藏硬件接�">�?】隐藏硬件接�?</h3>
<ul>
<li>将调用硬件的详细步骤隐藏起来，只会给你一�?..的步�?</li>
<li>根据这些接口自己高度定制自己的程序而不需要考虑硬件细节</li>
</ul>
<h3 id="�-】资源有序化">�?】资源有序化</h3>
<ul>
<li>将应用程序对硬件资源的竞争和请求变得有序�?</li>
</ul>
<h3 id="�-】对资源进行合理的调度和分配">�?】对资源进行合理的调度和分配</h3>
<ul>
<li>记录那个应用程序需要什么资�?</li>
<li>对请求的资源进行分配</li>
<li>中和每一个应用之间的请求</li>
</ul>
<h2 id="【五】如何实现资源有序化">【五】如何实现资源有序化</h2>
<ul>
<li>每一个电脑上有一个操作系统的基本流程：多路复�?</li>
</ul>
<h3 id="�-】时间上的复�">�?】时间上的复�?</h3>
<ul>
<li>方案一：程序一个一个执行，很慢
<ul>
<li>电脑上只有一个cpu就执行方案一</li>
</ul>
</li>
<li>方案二：程序同时执行，效率高一�?
<ul>
<li>电脑上有多个cpu的话就可以执行方案二</li>
</ul>
</li>
<li>这里的cpu是指：硬件cpu上面执行的cpu�?-�?0�?0线程–�?0cpu</li>
</ul>
<h3 id="�-】空间上的复�">�?】空间上的复�?</h3>
<ul>
<li>内存是用来临时存储数据和CPU进行交互�?</li>
<li>谁用就先把内存空间给他用</li>
<li>为啥你既能用qq又能用微信，是因为内存空间切换的足够�?</li>
</ul>
<h3 id="�-】多路复�">�?】多路复�?</h3>
<ul>
<li>我们现在用的电脑就是多路复用</li>
</ul>
<h2 id="【六】操作系统和普通软件的区别">【六】操作系统和普通软件的区别</h2>
<ul>
<li>操作系统
<ul>
<li>操作系统是普通软件的载体</li>
<li>操作系统比较�?</li>
<li>操作系统寿命�?-》开发出一个完整的系统你就会用很久</li>
</ul>
</li>
<li>普通软�?
<ul>
<li>寿命短，一年可能会更新很多个版�?</li>
</ul>
</li>
</ul>
<h2 id="【七】操作系统发展史">【七】操作系统发展史</h2>
<h3 id="�-�-第一代计算机�-940-1955）：真空管和穿孔卡片">�?�?<em>第一代计算机�?940~1955）：真空管和穿孔卡片</em>*</h3>
<h4 id="�-）产生背�">�?）产生背�?</h4>
<ul>
<li>第一代之前人类是想用机械取代人力</li>
<li>第一代计算机的产生是计算机由机械时代进入电子时代的标�?</li>
<li>从Babbage失败之后一直到第二次世界大战，数字计算机的建造几乎没有什么进�?</li>
<li>第二次世界大战刺激了有关计算机研究的爆炸性进展�?</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lowa州立大学的john Atanasoff教授和他的学生Clifford Berry建造了据认为是第一台可工作的数字计算机�?</span><br><span class="line"></span><br><span class="line">该机器使�?00个真空管。大约在同时，Konrad Zuse在柏林用继电器构建了Z3计算机，英格兰布莱切利园的一个小组在1944年构建了Colossus，Howard Aiken在哈佛大学建造了Mark 1，宾夕法尼亚大学的William Mauchley和他的学生J.Presper Eckert建造了ENIAC�?</span><br><span class="line"></span><br><span class="line">这些机器有的是二进制的，有的使用真空管，有的是可编程的，但都非常原始，设置需要花费数秒钟时间才能完成最简单的运算�?</span><br></pre></td></tr></table></figure>
<h4 id="�-）技术背�">�?）技术背�?</h4>
<ul>
<li>同一个小组里的工程师们，设计、建造、编程、操作及维护同一台机�?</li>
<li>所有的程序设计是用纯粹的机器语言编写的，甚至更糟�?</li>
<li>需要通过成千上万根电缆接到插件板上连成电路来控制机器的基本功能�?</li>
<li>没有程序设计语言（汇编也没有），操作系统则是从来都没听说过�?</li>
<li>使用机器的过程更加原始，详见下‘工作过程�?</li>
</ul>
<h4 id="�-）特�">�?）特�?</h4>
<ul>
<li>没有操作系统的概�?所有的程序设计都是直接操控硬件</li>
</ul>
<h4 id="�-）工作过�">�?）工作过�?</h4>
<ul>
<li>程序员在墙上的机时表预约一段时�?</li>
<li>然后程序员拿着他的插件版到机房�?</li>
<li>将自己的插件板街道计算机�?</li>
<li>这几个小时内他独享整个计算机资源</li>
<li>后面的一批人都得等着(两万多个真空管经常会有被烧坏的情况出�?�?</li>
<li>后来出现了穿孔卡片，可以将程序写在卡片上，然后读入机而不用插件板</li>
</ul>
<h4 id="�-）优�">�?）优�?</h4>
<ul>
<li>程序员在申请的时间段内独享整个资�?</li>
<li>可以即时地调试自己的程序（有bug可以立刻处理�?</li>
</ul>
<h4 id="�-）缺�">�?）缺�?</h4>
<ul>
<li>浪费计算机资源，一个时间段内只有一个人用。注意：同一时刻只有一个程序在内存中，被cpu调用执行，比方说10个程序的执行，是串行�?</li>
</ul>
<h3 id="�-�-第二代计算机�-955-1965）：晶体管和批处理系�">�?�?<em>第二代计算机�?955~1965）：晶体管和批处理系�?</em></h3>
<h4 id="�-）产生背�-2">�?）产生背�?</h4>
<ul>
<li>由于当时的计算机非常昂贵，自认很自然的想办法较少机时的浪费�?</li>
<li>通常采用的方法就是批处理系统�?</li>
</ul>
<h4 id="�-）特�-2">�?）特�?</h4>
<ul>
<li>设计人员、生产人员、操作人员、程序人员和维护人员直接有了明确的分�?</li>
<li>计算机被锁在专用空调房间�?</li>
<li>由专业操作人员运行，这便是‘大型机’�?</li>
</ul>
<h4 id="�-）技术背�-2">�?）技术背�?</h4>
<ul>
<li>
<p>有了操作系统的概�?</p>
</li>
<li>
<p>有了程序设计语言�?</p>
</li>
<li>
<ul>
<li>FORTRAN语言或汇编语言，写到纸�?</li>
<li>然后穿孔打成卡片</li>
<li>再将卡片盒带到输入室，交给操作员</li>
<li>然后喝着咖啡等待输出接口</li>
</ul>
</li>
</ul>
<p><img src="http://zhaochunze.dream521.site/2322215-20230625082040911-626478560.jpg" alt="img"></p>
<h4 id="�-）第二代如何解决第一代的问题-缺点">�?）第二代如何解决第一代的问题/缺点</h4>
<ul>
<li>把一堆人的输入攒成一大波输入�?</li>
<li>然后顺序计算（这是有问题的，但是第二代计算也没有解决�?</li>
<li>把一堆人的输出攒成一大波输出</li>
</ul>
<h3 id="�-�-第三代计算机�-965-1980）：集成电路芯片和多道程序设�">�?�?<em>第三代计算机�?965~1980）：集成电路芯片和多道程序设�?</em></h3>
<h4 id="�-）产生背�-3">�?）产生背�?</h4>
<ul>
<li>
<p>20世纪60年代初期，大多数计算机厂商都有两条完全不兼容的生产线�?</p>
</li>
<li>
<ul>
<li>一条是面向字的�?</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>大型的科学计算机</li>
<li>如IBM 7094，见上图，主要用于科学计算和工程计算</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>另外一条是面向字符的：</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>商用计算机，如IBM 1401，见上图</li>
<li>主要用于银行和保险公司从事磁带归档和打印服务</li>
</ul>
</li>
</ul>
</li>
<li>
<p>开发和维护完全不同的产品是昂贵�?</p>
</li>
<li>
<ul>
<li>同时不同的用户对计算机的用途不同�?</li>
</ul>
</li>
</ul>
<h4 id="�-）技术背�-3">�?）技术背�?</h4>
<ul>
<li>
<p>IBM公司试图通过引入system/360系列来同时满足科学计算和商业计算</p>
</li>
<li>
<ul>
<li>360系列低档机与1401相当，高档机�?094功能强很�?</li>
<li>不同的性能卖不同的价格</li>
</ul>
</li>
<li>
<p>360是第一个采用了（小规模）芯片（集成电路）的主流机型</p>
</li>
<li>
<ul>
<li>与采用晶体管的第二代计算机相比，性价比有了很大的提高�?</li>
<li>这些计算机的后代仍在大型的计算机中心里使用，<strong>此乃现在服务器的前身</strong></li>
<li>这些服务器每秒处理不小于千次的请求�?</li>
</ul>
</li>
</ul>
<h4 id="�-）如何解决第二代计算机的问题1">�?）如何解决第二代计算机的问题1</h4>
<ul>
<li>卡片被拿到机房后能够很快的将作业从卡片读入磁盘，于是任何时刻当一个作业结束时，操作系统就能将一个作业从磁带读出，装进空出来的内存区域运行，这种技术叫�?同时的外部设备联机操作：SPOOLING</li>
<li>该技术同时用于输出�?</li>
<li>当采用了这种技术后，就不在需要IBM1401机了，也不必将磁带搬来搬去了（中间俩小人不再需要）</li>
</ul>
<h4 id="�-）如何解决第二代计算机的问题2">�?）如何解决第二代计算机的问题2</h4>
<ul>
<li>
<p>第三代计算机的操作系统广泛应用了第二代计算机的操作系统没有的关键技术：</p>
</li>
<li>
<ul>
<li>多道技�?</li>
</ul>
</li>
<li>
<p>cpu在执行一个任务的过程�?</p>
</li>
<li>
<ul>
<li>若需要操作硬盘，则发送操作硬盘的指令</li>
<li>指令一旦发出，硬盘上的机械手臂滑动读取数据到内存中</li>
<li>这一段时间，cpu需要等待，时间可能很短</li>
<li>但对于cpu来说已经很长很长，长到可以让cpu做很多其他的任务</li>
<li>如果我们让cpu在这段时间内切换到去做其他的任务</li>
<li>这样cpu不就充分利用了吗。这正是多道技术产生的技术背�?</li>
</ul>
</li>
</ul>
<h4 id="�-）多道技�">�?）多道技�?</h4>
<ul>
<li>
<p>多道技术中的多道指的是多个程序</p>
</li>
<li>
<p>多道技术的实现是为了解决多个程序竞争或者说共享同一个资源（比如cpu）的有序调度问题</p>
</li>
<li>
<p>解决方式即多路复�?</p>
</li>
<li>
<ul>
<li>多路复用分为时间上的复用和空间上的复用�?</li>
</ul>
</li>
</ul>
<h5 id="1-空间上的复用"><strong>[1]空间上的复用</strong></h5>
<ul>
<li>将内存分为几部分，每个部分放入一个程序，这样，同一时间内存中就有了多道程序�?</li>
</ul>
<h5 id="2-时间上的复用">[2]<strong>时间上的复用</strong></h5>
<ul>
<li>当一个程序在等待I/O时，另一个程序可以使用cpu</li>
<li>如果内存中可以同时存放足够多的作业，则cpu的利用率可以接近100%</li>
<li>类似于我们小学数学所学的<strong>统筹方法</strong>�?</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">（操作系统采用了多道技术后，可以控制进程的切换</span><br><span class="line"></span><br><span class="line">或者说进程之间去争抢cpu的执行权限�?</span><br><span class="line"></span><br><span class="line">这种切换不仅会在一个进程遇到io时进行，一个进程占用cpu时间过长也会切换</span><br><span class="line"></span><br><span class="line">或者说被操作系统夺走cpu的执行权限）</span><br></pre></td></tr></table></figure>
<h5 id="3-详解�">[3]*<em>详解�?</em></h5>
<ul>
<li>
<p>空间上的复用最大的问题是：</p>
</li>
<li>
<ul>
<li>程序之间的内存必须分�?</li>
<li>这种分割需要在硬件层面实现，由操作系统控制�?</li>
<li>如果内存彼此不分割，则一个程序可以访问另外一个程序的内存�?</li>
</ul>
</li>
<li>
<p>首先丧失的是安全�?</p>
</li>
<li>
<ul>
<li>比如你的qq程序可以访问操作系统的内�?</li>
<li>这意味着你的qq可以拿到操作系统的所有权限�?</li>
</ul>
</li>
<li>
<p>其次丧失的是稳定�?</p>
</li>
<li>
<ul>
<li>某个程序崩溃时有可能把别的程序的内存也给回收�?</li>
<li>比方说把操作系统的内存给回收了，则操作系统崩溃�?</li>
</ul>
</li>
</ul>
<p>第三代计算机的操作系统仍然是批处�?</p>
<ul>
<li>
<p>许多程序员怀念第一代独享的计算�?</p>
</li>
<li>
<ul>
<li>可以即时调试自己的程序�?</li>
<li>为了满足程序员们很快可以得到响应，出现了分时操作系统</li>
</ul>
</li>
</ul>
<h4 id="�-）如何解决第二代计算机的问题3">�?）如何解决第二代计算机的问题3</h4>
<p>分时操作系统�?多个联机终端+多道技�?</p>
<ul>
<li>
<p>20个客户端同时加载到内�?</p>
</li>
<li>
<ul>
<li>�?7在思考，3个在运行</li>
<li>cpu就采用多道的方式处理内存中的�?个程�?</li>
<li>由于客户提交的一般都是简短的指令而且很少有耗时长的</li>
<li>索引计算机能够为许多用户提供快速的交互式服�?</li>
<li>所有的用户都以为自己独享了计算机资�?</li>
</ul>
</li>
<li>
<p>CTTS:</p>
</li>
<li>
<ul>
<li>麻省理工（MIT）在一台改装过�?094机上开发成功的</li>
<li>CTSS兼容分时系统�?<em>第三代计算机广泛采用了必须的保护硬件（程序之间的内存彼此隔离）之后，分时系统才开始流�?</em></li>
</ul>
</li>
<li>
<p>MIT:</p>
</li>
<li>
<ul>
<li>贝尔实验室和通用电气在CTTS成功研制后决定开发能够同时支持上百终端的MULTICS（其设计者着眼于建造满足波士顿地区所有用户计算需求的一台机器）</li>
<li>很明显真是要上天啊，最后摔死了�?</li>
</ul>
</li>
<li>
<p>后来</p>
</li>
<li>
<ul>
<li>一位参加过MULTICS研制的贝尔实验室计算机科学家Ken Thompson开发了一个简易的，单用户版本的MULTICS</li>
<li><strong>这就是后来的UNIX系统</strong>�?</li>
<li>基于它衍生了很多其他的Unix版本，为了使程序能在任何版本的unix上运行，IEEE提出了一个unix标准，即**posix（可移植的操作系统接口Portable Operating System Interface�?*</li>
</ul>
</li>
<li>
<p>后来</p>
</li>
<li>
<ul>
<li>�?987年，出现了一个UNIX的小型克隆，即minix，用于教学使用�?</li>
<li>芬兰学生Linus Torvalds基于它编写了Linux</li>
</ul>
</li>
</ul>
<h3 id="�-�-第四代计算机�-980-至今）：个人计算�">�?�?<em>第四代计算机�?980~至今）：个人计算�?</em></h3>
<ul>
<li>即使可以利用的cpu只有一个（早期的计算机确实如此），也能保证支持（伪）并发的能力�?</li>
<li>将一个单独的cpu变成多个虚拟的cpu（多道技术：时间多路复用和空间多路复�?硬件上支持隔离），没有进程的抽象，现代计算机将不复存在�?</li>
</ul>
<h3 id="�-】发展史概览">�?】发展史概览</h3>
<table>
<thead>
<tr>
<th>计算机发展阶�?</th>
<th>时间</th>
<th>组成</th>
<th>改进</th>
<th>缺陷</th>
</tr>
</thead>
<tbody>
<tr>
<td>第一代计算机</td>
<td>1940~1955</td>
<td>真空管和穿孔卡片</td>
<td></td>
<td>没有操作系统的概�?所有的程序设计都是直接操控硬件</td>
</tr>
<tr>
<td>第二代计算机</td>
<td>1955~1965</td>
<td>晶体管和批处理系�?</td>
<td>批处理，节省机时</td>
<td>全程需要人参与，仍是串行，无法及时调试程序</td>
</tr>
<tr>
<td>第三代计算机</td>
<td>1965~1980</td>
<td>集成电路芯片和多道程序设�?</td>
<td>运用多道技�?</td>
<td></td>
</tr>
<tr>
<td>第四代计算机</td>
<td>1980至今</td>
<td>个人计算�?</td>
<td>支持（伪）并发的能力</td>
<td></td>
</tr>
</tbody>
</table>
<h1>总结</h1>
<h3 id="�-】操作系统的作用">�?】操作系统的作用</h3>
<ul>
<li>隐藏丑陋复杂的硬件接口，提供良好的抽象接�?</li>
<li>管理，调度进程，并且将多个进程对硬件的竞争变得有�?</li>
</ul>
<h3 id="�-】多道技�">�?】多道技�?</h3>
<h4 id="�-）产生背景：针对单核，实现并�">�?）产生背景：针对单核，实现并�?</h4>
<ul>
<li>现在的主机一般是多核，那么每个核都会利用多道技�?�?个cpu，运行于cpu1的某个程序遇到io阻塞，会等到io结束再重新调度，会被调度�?个cpu中的任意一个，具体由操作系统调度算法决定�?</li>
</ul>
<h4 id="�-）空间上的复用：如内存中同时由多道程�">�?）空间上的复用：如内存中同时由多道程�?</h4>
<ul>
<li>空间上的复用指定是在内存中同时运行多个程序，这样可以有效地利用内存资源�?</li>
</ul>
<h4 id="�-）时间上的复用：复用一个cpu的时间片">�?）时间上的复用：复用一个cpu的时间片</h4>
<ul>
<li>
<p>指共享同一台机器的多个进程可以轮流使用CPU，从而避免了长时间等待的情况发生�?</p>
</li>
<li>
<p>强调：遇到io切，占用cpu时间过长也切，核心在于切之前将进程的状态保存下来，这样才能保证下次切换回来时，能基于上次切走的位置继续运行</p>
</li>
</ul>
<h3 id="�-】操作系统发展史">�?】操作系统发展史</h3>
<ul>
<li>第一代计算机�?940-1955）：真空管和穿孔卡片</li>
<li>第二代计算机�?955-1965）：*<em>晶体管和批处理系�?</em></li>
<li>**第三代计算机�?965~1980�?*：集成电路芯片和多道程序设计</li>
<li>第四代计算机�?980-至今）：个人计算�?</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/11.0Django%E6%A1%86%E6%9E%B6%E4%B9%8B%E5%88%86%E9%A1%B5%E5%99%A8%E6%8E%A8%E5%88%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/11.0Django%E6%A1%86%E6%9E%B6%E4%B9%8B%E5%88%86%E9%A1%B5%E5%99%A8%E6%8E%A8%E5%88%B0/" class="post-title-link" itemprop="url">11.0Django���֮��ҳ���Ƶ�</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Django框架之分页器推到</h1>
<h2 id="【一】引�">【一】引�?</h2>
<ul>
<li>前端展示的数据有时候会有很�?</li>
<li>一页展示了很多数据，数据量很大，查找不方便</li>
</ul>
<p>解决办法</p>
<ul>
<li>做分页处�?</li>
</ul>
<h2 id="【二】分页推�">【二】分页推�?</h2>
<h3 id="�-】分�">�?】分�?</h3>
<ul>
<li>get请求是可以携带参数的</li>
<li>由此我们可以在前端点击页数的时候，把这个页数一起发送给后端</li>
<li>queryset对象是支持索引取值和切片操作�?
<ul>
<li>不支持负索引取�?</li>
</ul>
</li>
</ul>
<h3 id="�-】代码分�">�?】代码分�?</h3>
<ul>
<li>后端代码分析
<ul>
<li>在后端通过model.objects.all()得到所有数据的quertset对象</li>
<li>queryset对象可以进行切分，但是不支持反向切分</li>
</ul>
</li>
<li>前端展示数据
<ul>
<li>在前端需传入当前的页�?</li>
<li>在后端根据指定的页面进行切分</li>
<li>在前端的url上声明当前的页码</li>
<li><code>http://127.0.0.1:8000/?page=1</code></li>
<li>后端的request.GET.get(‘page’)就可以拿到当前的页码</li>
</ul>
</li>
<li>在后端处�?
<ul>
<li>我们需�?</li>
<li>当前的页码curreny_page</li>
<li>每一页展示的数据量size</li>
<li>起始的页�?start_page</li>
<li>结束的页�?end_page</li>
<li>queryset对象[起始位置：结束位置]
<ul>
<li>列入<code> book_queryset = models.Book.objects.all()[start_page:end_page]</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="�-】代码分�-2">�?】代码分�?</h3>
<h4 id="1-页器组件参考bootstrap">(1)页器组件参考bootstrap</h4>
<ul>
<li>参考bootstrap官方文档，拷贝分页器代码进行优化</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">&quot;Page navigation&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;pagination&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Previous&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;laquo;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>3<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>4<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>5<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Next&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;raquo;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-优化后的代码">(2)优化后的代码</h4>
<ul>
<li>前端</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line">`(妯℃澘鏍囩)`</span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>`&#123;&#123; user_obj.username &#125;&#125;` : `&#123;&#123; user_obj.password &#125;&#125;`<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">`(妯℃澘鏍囩)`</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">nav</span> <span class="attr">aria-label</span>=<span class="string">&quot;Page navigation&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">&quot;pagination&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Previous&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;laquo;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        &#123;# safe取消转义 - 将后端的html页面进行转义，转为前端页�?也可以后端做这件�? #&#125;</span><br><span class="line">        `&#123;&#123; page_html|safe &#125;&#125;`</span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> <span class="attr">aria-label</span>=<span class="string">&quot;Next&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">aria-hidden</span>=<span class="string">&quot;true&quot;</span>&gt;</span><span class="symbol">&amp;raquo;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">nav</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>后端</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> .models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 分页操作 推导</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># �?�?支持切片models.Book.objects.all()[1:20] --- 展示�?0条数�?</span></span><br><span class="line">    <span class="comment"># �?�?分页操作</span></span><br><span class="line">    <span class="comment"># user对象</span></span><br><span class="line">    user_obj = UserInfo.objects.<span class="built_in">all</span>()</span><br><span class="line">    <span class="comment"># 想访问的页数</span></span><br><span class="line">    current_page = request.GET.get(<span class="string">&#x27;page&#x27;</span>, <span class="number">1</span>)  <span class="comment"># 如果获取不到当前页码就展示第一�?</span></span><br><span class="line">    <span class="comment"># 异常捕获</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        current_page = <span class="built_in">int</span>(current_page)</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        current_page = <span class="number">1</span></span><br><span class="line">    <span class="comment"># 每页展示多少�?</span></span><br><span class="line">    per_page_num = <span class="number">10</span></span><br><span class="line">    <span class="comment"># 动态计算出需要的总页�?</span></span><br><span class="line">    all_count = user_obj.count()</span><br><span class="line">    <span class="comment"># divmod得到的是商和余数的元�?</span></span><br><span class="line">    page_count, more = <span class="built_in">divmod</span>(all_count, per_page_num)</span><br><span class="line">    <span class="comment"># 要是有余数的话，页面也要�?</span></span><br><span class="line">    <span class="keyword">if</span> more:</span><br><span class="line">        page_count += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 纠正左侧负数页的问题</span></span><br><span class="line">    left_page_count = current_page</span><br><span class="line">    <span class="keyword">if</span> current_page &lt; <span class="number">6</span>:</span><br><span class="line">        current_page = <span class="number">6</span></span><br><span class="line">    page_html = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># 前端动态页面展�?- 后端写好页面传给前端</span></span><br><span class="line">    <span class="keyword">for</span> count <span class="keyword">in</span> <span class="built_in">range</span>(current_page - <span class="number">5</span>, current_page + <span class="number">6</span>):</span><br><span class="line">        <span class="keyword">if</span> left_page_count == count:</span><br><span class="line">            <span class="comment"># 第一页高亮显�?</span></span><br><span class="line">            page_html += <span class="string">f&#x27;&lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?page=<span class="subst">&#123;count&#125;</span>&quot; &gt;<span class="subst">&#123;count&#125;</span>&lt;/a&gt;&lt;/li&gt;&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            page_html += <span class="string">f&#x27;&lt;li&gt;&lt;a href=&quot;?page=<span class="subst">&#123;count&#125;</span>&quot; &gt;<span class="subst">&#123;count&#125;</span>&lt;/a&gt;&lt;/li&gt;&#x27;</span></span><br><span class="line">    <span class="comment"># 起始位置</span></span><br><span class="line">    start_page = (current_page - <span class="number">1</span>) * per_page_num</span><br><span class="line">    <span class="comment"># 终止位置</span></span><br><span class="line">    end_page = current_page * per_page_num</span><br><span class="line">    <span class="comment"># 切片</span></span><br><span class="line">    user_queryset = user_obj[start_page:end_page]</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    start_page = (current_page-1) * per_page_num</span></span><br><span class="line"><span class="string">    end_page = current_page * per_page_num</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<h3 id="�-】分页器模板">�?】分页器模板</h3>
<ul>
<li>创建一个py文件，把下面的代码放进去</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Pagination</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, current_page, all_count, per_page_num=<span class="number">2</span>, pager_count=<span class="number">11</span></span>):</span><br><span class="line">        <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">        封装分页相关数据</span></span><br><span class="line"><span class="string">        :param current_page: 当前�?</span></span><br><span class="line"><span class="string">        :param all_count:    数据库中的数据总条�?</span></span><br><span class="line"><span class="string">        :param per_page_num: 每页显示的数据条�?</span></span><br><span class="line"><span class="string">        :param pager_count:  最多显示的页码个数</span></span><br><span class="line"><span class="string">        &quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            current_page = <span class="built_in">int</span>(current_page)</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            current_page = <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> current_page &lt; <span class="number">1</span>:</span><br><span class="line">            current_page = <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">        <span class="variable language_">self</span>.current_page = current_page</span><br><span class="line"> </span><br><span class="line">        <span class="variable language_">self</span>.all_count = all_count</span><br><span class="line">        <span class="variable language_">self</span>.per_page_num = per_page_num</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># 总页�?</span></span><br><span class="line">        all_pager, tmp = <span class="built_in">divmod</span>(all_count, per_page_num)</span><br><span class="line">        <span class="keyword">if</span> tmp:</span><br><span class="line">            all_pager += <span class="number">1</span></span><br><span class="line">        <span class="variable language_">self</span>.all_pager = all_pager</span><br><span class="line"> </span><br><span class="line">        <span class="variable language_">self</span>.pager_count = pager_count</span><br><span class="line">        <span class="variable language_">self</span>.pager_count_half = <span class="built_in">int</span>((pager_count - <span class="number">1</span>) / <span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">start</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> (<span class="variable language_">self</span>.current_page - <span class="number">1</span>) * <span class="variable language_">self</span>.per_page_num</span><br><span class="line"> </span><br><span class="line"><span class="meta">    @property</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">end</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">self</span>.current_page * <span class="variable language_">self</span>.per_page_num</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">page_html</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 如果总页�?&lt; 11个：</span></span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.all_pager &lt;= <span class="variable language_">self</span>.pager_count:</span><br><span class="line">            pager_start = <span class="number">1</span></span><br><span class="line">            pager_end = <span class="variable language_">self</span>.all_pager + <span class="number">1</span></span><br><span class="line">        <span class="comment"># 总页�? &gt; 11</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># 当前页如�?=页面上最多显�?1/2个页�?</span></span><br><span class="line">            <span class="keyword">if</span> <span class="variable language_">self</span>.current_page &lt;= <span class="variable language_">self</span>.pager_count_half:</span><br><span class="line">                pager_start = <span class="number">1</span></span><br><span class="line">                pager_end = <span class="variable language_">self</span>.pager_count + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">            <span class="comment"># 当前页大�?</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="comment"># 页码翻到最�?</span></span><br><span class="line">                <span class="keyword">if</span> (<span class="variable language_">self</span>.current_page + <span class="variable language_">self</span>.pager_count_half) &gt; <span class="variable language_">self</span>.all_pager:</span><br><span class="line">                    pager_end = <span class="variable language_">self</span>.all_pager + <span class="number">1</span></span><br><span class="line">                    pager_start = <span class="variable language_">self</span>.all_pager - <span class="variable language_">self</span>.pager_count + <span class="number">1</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    pager_start = <span class="variable language_">self</span>.current_page - <span class="variable language_">self</span>.pager_count_half</span><br><span class="line">                    pager_end = <span class="variable language_">self</span>.current_page + <span class="variable language_">self</span>.pager_count_half + <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">        page_html_list = []</span><br><span class="line">        <span class="comment"># 添加前面的nav和ul标签</span></span><br><span class="line">        page_html_list.append(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">                    &lt;nav aria-label=&#x27;Page navigation&gt;&#x27;</span></span><br><span class="line"><span class="string">                    &lt;ul class=&#x27;pagination&#x27;&gt;</span></span><br><span class="line"><span class="string">                &#x27;&#x27;&#x27;</span>)</span><br><span class="line">        first_page = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;首页&lt;/a&gt;&lt;/li&gt;&#x27;</span> % (<span class="number">1</span>)</span><br><span class="line">        page_html_list.append(first_page)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.current_page &lt;= <span class="number">1</span>:</span><br><span class="line">            prev_page = <span class="string">&#x27;&lt;li class=&quot;disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;上一�?/a&gt;&lt;/li&gt;&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            prev_page = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;上一�?/a&gt;&lt;/li&gt;&#x27;</span> % (<span class="variable language_">self</span>.current_page - <span class="number">1</span>,)</span><br><span class="line"> </span><br><span class="line">        page_html_list.append(prev_page)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(pager_start, pager_end):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="variable language_">self</span>.current_page:</span><br><span class="line">                temp = <span class="string">&#x27;&lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;?page=%s&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&#x27;</span> % (i, i,)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                temp = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;%s&lt;/a&gt;&lt;/li&gt;&#x27;</span> % (i, i,)</span><br><span class="line">            page_html_list.append(temp)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> <span class="variable language_">self</span>.current_page &gt;= <span class="variable language_">self</span>.all_pager:</span><br><span class="line">            next_page = <span class="string">&#x27;&lt;li class=&quot;disabled&quot;&gt;&lt;a href=&quot;#&quot;&gt;下一�?/a&gt;&lt;/li&gt;&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            next_page = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;下一�?/a&gt;&lt;/li&gt;&#x27;</span> % (<span class="variable language_">self</span>.current_page + <span class="number">1</span>,)</span><br><span class="line">        page_html_list.append(next_page)</span><br><span class="line"> </span><br><span class="line">        last_page = <span class="string">&#x27;&lt;li&gt;&lt;a href=&quot;?page=%s&quot;&gt;尾页&lt;/a&gt;&lt;/li&gt;&#x27;</span> % (<span class="variable language_">self</span>.all_pager,)</span><br><span class="line">        page_html_list.append(last_page)</span><br><span class="line">        <span class="comment"># 尾部添加标签</span></span><br><span class="line">        page_html_list.append(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">                                           &lt;/nav&gt;</span></span><br><span class="line"><span class="string">                                           &lt;/ul&gt;</span></span><br><span class="line"><span class="string">                                       &#x27;&#x27;&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(page_html_list)</span><br></pre></td></tr></table></figure>
<ul>
<li>前端</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/jquery/3.7.1/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;col-md-8 col-md-offset-2&quot;</span>&gt;</span></span><br><span class="line">            `(妯℃澘鏍囩)`</span><br><span class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>`&#123;&#123; user.username &#125;&#125;`<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">            `(妯℃澘鏍囩)`</span><br><span class="line">            `&#123;&#123; page_obj.page_html|safe &#125;&#125;`</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>后端</p>
<ul>
<li>
<p>使用引入创建的py文件</p>
</li>
<li>
<pre><code class="language-python">from user.paginations import Pagination
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```python</span><br><span class="line">from user.paginations import Pagination</span><br><span class="line"></span><br><span class="line">def index(request):</span><br><span class="line">    # 拿到模型表里面的所有数�?</span><br><span class="line">    user_list = UserInfo.objects.all()</span><br><span class="line">    # 从路径里面拿到页�?默认第一�?</span><br><span class="line">    current_page = request.GET.get(&#x27;page&#x27;, 1)</span><br><span class="line">    # 拿到总页�?</span><br><span class="line">    all_count = user_list.count()</span><br><span class="line">    # current_page 得到的页码数，all_count总页数，per_page_num每个页面只能展示多少条数�?</span><br><span class="line">    page_obj = Pagination(current_page =current_page, all_count=all_count, per_page_num=10)</span><br><span class="line">    # 对象进行切分</span><br><span class="line">    page_queryset = user_list[page_obj.start:page_obj.end]</span><br><span class="line">    return render(request, &#x27;index.html&#x27;, locals())</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="�-】总结">�?】总结</h3>
<ul>
<li>
<p>创建一个py文件</p>
</li>
<li>
<p>将分页器源码放进�?</p>
</li>
<li>
<p>在视图函数中使用</p>
<ul>
<li>
<p>再导入分页器�?</p>
<ul>
<li>
<pre><code class="language-python">from user.paginations import Pagination
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 查询模型表所有数�?</span><br><span class="line"></span><br><span class="line">  - ```python</span><br><span class="line">    user_list = UserInfo.objects.all()</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
</ul>
</li>
<li>
<p>获取当前页面</p>
<ul>
<li>
<pre><code class="language-python">current_page = request.GET.get(&quot;page&quot;, 1)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 创建分页器对�?</span><br><span class="line"></span><br><span class="line">  - ```python</span><br><span class="line">    all_count = user_list.count()</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
<li>
<pre><code class="language-python">page_obj = Pagination(current_page=current_page, all_count=all_count, per_page_num=10)
</code></pre>
</li>
</ul>
</li>
<li>
<p>对原始数据进行切�?</p>
<ul>
<li>
<pre><code class="language-python">page_queryset = user_list[page_obj.start:page_obj.end]
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 返回前端进行渲染</span><br><span class="line"></span><br><span class="line">  - ```python</span><br><span class="line">    return render(request,&#x27;index.html&#x27;, locals())</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>前端使用</p>
<ul>
<li>
<pre><code class="language-html">
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">```python</span><br><span class="line">`(妯℃澘鏍囩)`</span><br><span class="line">    &lt;p&gt;`&#123;&#123; user.username &#125;&#125;`&lt;/p&gt;</span><br><span class="line">`(妯℃澘鏍囩)`</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
</ul>
</li>
<li>
<p>添加分页�?</p>
<ul>
<li>在下面添加分页器</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`&#123;&#123; page_obj.page_html|safe &#125;&#125;`</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/10.0selenium%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/10.0selenium%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">10.0selenium���֮���������</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>selenium框架之浏览器操作</h1>
<h2 id="【一】页面的操作">【一】页面的操作</h2>
<h3 id="�-】初始化浏览器对�">�?】初始化浏览器对�?</h3>
<ul>
<li>前期我们将Chrome驱动添加到环境变量了，所以我们可以直接初始化界面。（或者也可以通过指定绝对路径的方式）</li>
</ul>
<h4 id="�-）方式一：使用环境变�">�?）方式一：使用环境变�?</h4>
<ul>
<li>我们不指定驱动位置，在selenium打开浏览器的时间会很�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="comment"># 初始化浏览器为chrome浏览�?</span></span><br><span class="line">browser = Chrome()</span><br><span class="line"></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 关闭浏览�?</span></span><br><span class="line">browser.close()</span><br></pre></td></tr></table></figure>
<h4 id="�-）方式二：使用绝对路�">�?）方式二：使用绝对路�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="�-】访问页�">�?】访问页�?</h3>
<ul>
<li>进行页面访问使用的是get方法，传入参数为待访问页面的URL地址即可</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="�-】设置浏览器的大�">�?】设置浏览器的大�?</h3>
<ul>
<li>方法：set_window_size（宽度，高度�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览�?</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置浏览器的打开的大�?</span></span><br><span class="line">browser.set_window_size(<span class="number">1000</span>,<span class="number">500</span>)</span><br></pre></td></tr></table></figure>
<h3 id="�-】设置浏览器为全�">�?】设置浏览器为全�?</h3>
<ul>
<li>方法：maximize_window（）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览�?</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置浏览器全�?</span></span><br><span class="line">browser.maximize_window()</span><br></pre></td></tr></table></figure>
<h3 id="�-】前进和后退页面">�?】前进和后退页面</h3>
<ul>
<li>前进页面：forward（）</li>
<li>后退页面：back（）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览�?</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 前进和后退页面</span></span><br><span class="line"><span class="comment"># 先打开一个网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.jd.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 后退回百�?</span></span><br><span class="line">browser.back()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 前进到京东页�?</span></span><br><span class="line">browser.forward()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="�-】获得页面的基础属�">�?】获得页面的基础属�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览�?</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得网页标题</span></span><br><span class="line"><span class="built_in">print</span>(browser.title)  <span class="comment"># 百度一下，你就知道</span></span><br><span class="line"><span class="comment"># 获得当前网址</span></span><br><span class="line"><span class="built_in">print</span>(browser.current_url)  <span class="comment"># https://www.baidu.com/</span></span><br><span class="line"><span class="comment"># 获得浏览器的名字</span></span><br><span class="line"><span class="built_in">print</span>(browser.name)  <span class="comment"># chrome</span></span><br><span class="line"><span class="comment"># 获得网页源码</span></span><br><span class="line"><span class="built_in">print</span>(browser.page_source)</span><br></pre></td></tr></table></figure>
<h3 id="�-】在浏览器中切换，新开，关闭，页面">�?】在浏览器中切换，新开，关闭，页面</h3>
<ul>
<li>隐士等待：<code>browser.implicitly_wait(2)</code>
<ul>
<li>如果在这两秒（或指定的时间）内WebDriver找到了元�?会立即停止等待并继续执行后续的代�?</li>
<li>如果过了这两秒之后，元素仍然没有被找�?WebDriver会抛出一个NoSuchElementException异常</li>
</ul>
</li>
<li><code>browser.window_handles</code>：获得浏览器打开的所有页面的句柄，得到的是一个列�?
<ul>
<li>得到这个句柄切换页面</li>
<li>也可以说或的页面的所有选项�?</li>
</ul>
</li>
<li><code>browser.switch_to.window(all_handles[0])</code>：切换到第一个选项卡页�?</li>
<li>在本页面打开新的页面：<code>browser.get('https://www.pinduoduo.com/')</code></li>
<li>关闭当前选项卡：<code>browser.close()</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览�?</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.jd.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># time.sleep(2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 隐士等待两秒，确保页面加载完�?</span></span><br><span class="line"><span class="comment"># 当你使用browser.implicitly_wait(2)设置了隐式等待时间后，如果在这两秒（或指定的时间）内WebDriver找到了元素，</span></span><br><span class="line"><span class="comment"># 那么它就会立即停止等待并继续执行后续的代码�?</span></span><br><span class="line"><span class="comment"># 但是，如果过了这两秒之后，元素仍然没有被找到�?</span></span><br><span class="line"><span class="comment"># 那么WebDriver会抛出一个NoSuchElementException异常，表示它无法在指定的时间内找到该元素</span></span><br><span class="line">browser.implicitly_wait(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># browser.window_handles是一个属性，它返回当前会话中打开的所有窗口（或标签页）的句柄列表�?</span></span><br><span class="line"><span class="comment"># 每个句柄都是一个唯一的标识符，用于区分不同的窗口或标签页</span></span><br><span class="line"><span class="built_in">print</span>(browser.window_handles)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在当前浏览器实例中新打开一个选项�?</span></span><br><span class="line">browser.execute_script(<span class="string">&#x27;window.open(&quot;https://www.baidu.com&quot;)&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取所有选项�?</span></span><br><span class="line">all_handles = browser.window_handles</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到第一个选项�?</span></span><br><span class="line">browser.switch_to.window(all_handles[<span class="number">0</span>])</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在第一个选项中打开拼多�?</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.pinduoduo.com/&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到第二个选项卡上，打开百度</span></span><br><span class="line">browser.switch_to.window(all_handles[<span class="number">1</span>])</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭当前选项�?</span></span><br><span class="line">browser.close()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 关闭当前浏览�?</span></span><br><span class="line">browser.quit()</span><br></pre></td></tr></table></figure>
<h2 id="【二】定位页面元�">【二】定位页面元�?</h2>
<h3 id="�-】前言">�?】前言</h3>
<ul>
<li>我们熟知�?百度为例，我们进入首页，�?【F12�?进入开发者工具�?</li>
<li>红框中显示的就是页面的代码，我们要做的就是从代码中定位获取我们需要的元素</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cee02bd15-8922-4f62-8ce7-91baf3ab2401.png" alt="ee02bd15-8922-4f62-8ce7-91baf3ab2401"></p>
<h3 id="�-】八大选择器介�">�?】八大选择器介�?</h3>
<ul>
<li>通过webdriver对象�?find_element(by=“属性名�? value=“属性值�?</li>
</ul>
<table>
<thead>
<tr>
<th>属�?</th>
<th>函数</th>
</tr>
</thead>
<tbody>
<tr>
<td>CLASS</td>
<td>find_element(by=By.CLASS_NAME, value=‘�?</td>
</tr>
<tr>
<td>XPATH</td>
<td>find_element(by=By.XPATH, value=‘�?</td>
</tr>
<tr>
<td>LINK_TEXT</td>
<td>find_element(by=By.LINK_TEXT, value=‘�?</td>
</tr>
<tr>
<td>PARTIAL_LINK_TEXT</td>
<td>find_element(by=By.PARTIAL_LINK_TEXT, value=‘�?</td>
</tr>
<tr>
<td>TAG</td>
<td>find_element(by=By.TAG_NAME, value=‘�?</td>
</tr>
<tr>
<td>CSS</td>
<td>find_element(by=By.CSS_SELECTOR, value=‘�?</td>
</tr>
<tr>
<td>ID</td>
<td>find_element(<a target="_blank" rel="noopener" href="http://by=By.ID">by=By.ID</a>, value=‘�?</td>
</tr>
</tbody>
</table>
<h3 id="�-】八大选择器示�">�?】八大选择器示�?</h3>
<h4 id="�-）ID">�?）ID</h4>
<ul>
<li>通过ID进行定位</li>
<li><code>browser</code>: 生成的浏览器对象</li>
<li><code>real_id</code>：查找元素的真实ID</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">label_position = browser.find_element(By.ID, <span class="string">&quot;real_id&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）Name">�?）Name</h4>
<ul>
<li>通过元素name的属性进行定�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.NAME, <span class="string">&#x27;real_name&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）Class">�?）Class</h4>
<ul>
<li>通过元素�?Class 属性进行定�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.CLASS_NAME, <span class="string">&#x27;real_class&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）Tag定位">�?）Tag定位</h4>
<ul>
<li>通过标签名进行定�?</li>
<li>�?‘div’ 替换为你要查找的具体标签名，�?‘a’�?span’</li>
<li>使用 find_element<strong>s</strong> 方法，通过标签名进行定�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_elements(By.TAG_NAME, <span class="string">&#x27;div&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）Link文字进行定位">�?）Link文字进行定位</h4>
<ul>
<li>精准定位</li>
<li>�?‘link_text’ 替换为你要查找的链接文字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.LINK_TEXT, <span class="string">&#x27;link_text&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）Partial-Link文字">�?）Partial Link文字</h4>
<ul>
<li>模糊定位</li>
<li>�?‘partial_link_text’ 替换为你要查找的部分链接文字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.PARTIAL_LINK_TEXT, <span class="string">&#x27;partial_link_text&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）Xpath">�?）Xpath</h4>
<ul>
<li>xpath表达式进行定�?</li>
<li>�?‘xpath_expression’ 替换为你要使用的实际 XPath 表达�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.XPATH, <span class="string">&#x27;xpath_expression&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）CSS选择�">�?）CSS选择�?</h4>
<ul>
<li>�?‘css_selector’ 替换为你要使用的实际 CSS 选择�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element = bro.find_element(By.CSS_SELECTOR, <span class="string">&#x27;css_selector&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="�-】百度案�">�?】百度案�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 八大选择器案�?</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 查找到驱�?</span></span><br><span class="line">service = Service(<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"><span class="comment"># 创建浏览器对�?</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 打开百度</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 通过类属性查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.CLASS_NAME, <span class="string">&quot;s_ipt&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过id属性查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.ID, <span class="string">&quot;kw&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过name属性查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.NAME, <span class="string">&quot;wd&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Tag标签名查找所有的input�?</span></span><br><span class="line">search_input = browser.find_elements(By.TAG_NAME, <span class="string">&quot;input&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Xpath方法查找百度搜索�?</span></span><br><span class="line">search_input = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Link文字查找百度的新闻标�?</span></span><br><span class="line">search_input = browser.find_element(By.LINK_TEXT, <span class="string">&#x27;新闻&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Partial Link文字查找百度的新闻标�?</span></span><br><span class="line">search_input = browser.find_element(By.PARTIAL_LINK_TEXT, <span class="string">&#x27;�?)</span></span><br><span class="line"><span class="string">print(search_input)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 通过CSS选择器查找百度搜索框</span></span><br><span class="line"><span class="string">search_input = browser.find_element(By.CSS_SELECTOR, &#x27;</span><span class="comment">#kw&#x27;)</span></span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br></pre></td></tr></table></figure>
<h3 id="�-】小�">�?】小�?</h3>
<ul>
<li>
<p>以上示例中的定位方式都是通过 find_element �?find_elements 方法配合相应的定位器（如 <a target="_blank" rel="noopener" href="http://By.ID">By.ID</a>、<a target="_blank" rel="noopener" href="http://By.NAME">By.NAME</a> 等）来定位元素�?</p>
</li>
<li>
<ul>
<li>find_element 方法返回第一个匹配到的元�?</li>
<li>find_elements 方法返回所有匹配到的元素的列表</li>
</ul>
</li>
</ul>
<h2 id="【三】元素操作（节点交互�">【三】元素操作（节点交互�?</h2>
<ul>
<li>
<p>Selenium可以驱动浏览器来执行一些操作，也就是说可以让浏览器模拟执行一些动作�?</p>
</li>
<li>
<ul>
<li>比较常见的用法有�?</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>输入文字时用send_keys()方法�?</li>
<li>清空文字时用clear()方法�?</li>
<li>点击按钮时用click()方法</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">kw1.clear()        <span class="comment">#清除元素的�?</span></span><br><span class="line">kw1.click()        <span class="comment">#点击元素</span></span><br><span class="line">kw1.<span class="built_in">id</span>             <span class="comment">#Selenium所使用的内部ID</span></span><br><span class="line">kw1.get_property(<span class="string">&#x27;background&#x27;</span>) <span class="comment">#获取元素的属性的�?</span></span><br><span class="line">kw1.get_attribute(<span class="string">&#x27;id&#x27;</span>) <span class="comment">#获取元素的属性的�?</span></span><br><span class="line">kw1.location       <span class="comment">#不滚动获取元素的坐标</span></span><br><span class="line">kw1.location_once_scrolled_into_view  <span class="comment">#不滚动且底部对齐并获取元素的坐标</span></span><br><span class="line">kw1.parent         <span class="comment">#父元�?</span></span><br><span class="line">kw1.send_keys(<span class="string">&#x27;&#x27;</span>)  <span class="comment">#向元素内输入�?</span></span><br><span class="line">kw1.size           <span class="comment">#大小</span></span><br><span class="line">kw1.submit         <span class="comment">#提交</span></span><br><span class="line">kw1.screenshot(<span class="string">&#x27;2.png&#x27;</span>) <span class="comment">#截取元素形状并保存为图片</span></span><br><span class="line">kw1.tag_name       <span class="comment">#标签�?</span></span><br><span class="line">kw1.text           <span class="comment">#内容，如果是表单元素则无法获�?</span></span><br><span class="line">kw1.is_selected()  <span class="comment">#判断元素是否被选中</span></span><br><span class="line">kw1.is_enabled()   <span class="comment">#判断元素是否可编�?</span></span><br><span class="line">kw1.is_displayed   <span class="comment">#判断元素是否显示</span></span><br><span class="line">kw1.value_of_css_property(<span class="string">&#x27;color&#x27;</span>) <span class="comment">#获取元素属性的�?</span></span><br><span class="line">kw1._upload(<span class="string">&#x27;2.png&#x27;</span>) <span class="comment">#上传文件</span></span><br></pre></td></tr></table></figure>
<ul>
<li>find_element方法仅仅能够获取元素对象，接下来就可以对元素执行以下操作 从定位到的元素中提取数据的方�?</li>
</ul>
<h3 id="�-】从定位到的元素中获取数�">�?】从定位到的元素中获取数�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">el.get_attribute(key)           <span class="comment"># 获取key属性名对应的属性�?</span></span><br><span class="line">el.text                        	<span class="comment"># 获取开闭标签之间的文本内容</span></span><br></pre></td></tr></table></figure>
<h3 id="�-】对定位到的元素的操�">�?】对定位到的元素的操�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">el.click()                      <span class="comment"># 对元素执行点击操�?</span></span><br><span class="line">el.submit()                     <span class="comment"># 对元素执行提交操�?</span></span><br><span class="line">el.clear()                      <span class="comment"># 清空可输入元素中的数�?</span></span><br><span class="line">el.send_keys(data)              <span class="comment"># 向可输入元素输入数据</span></span><br></pre></td></tr></table></figure>
<h3 id="�-】百度登入案�">�?】百度登入案�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入模块</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="comment"># 引入Service</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="comment"># 时间</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Service对象，指定ChromeDriver的路�?</span></span><br><span class="line">service = Service(executable_path=<span class="string">&quot;./chromedriver.exe&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成浏览器对�?</span></span><br><span class="line">browser = Chrome(</span><br><span class="line">    service=service</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置浏览器为全屏</span></span><br><span class="line">browser.maximize_window()</span><br><span class="line"><span class="comment"># 控制浏览器打开百度</span></span><br><span class="line">browser.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置你打开的浏览器的分辨率</span></span><br><span class="line"><span class="comment"># browser.set_window_size(1920, 1080)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到百度的登入按�?</span></span><br><span class="line">search_btn = browser.find_element(By.ID, <span class="string">&quot;s-top-loginbtn&quot;</span>)</span><br><span class="line"></span><br><span class="line">search_btn.click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到登入界面的手机号输入�?</span></span><br><span class="line">search_input_phone = browser.find_element(By.XPATH,<span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__userName&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 渲染数据</span></span><br><span class="line">search_input_phone.send_keys(<span class="string">&quot;17746302958&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到登入界面的密码输入框</span></span><br><span class="line">search_input_psw = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__password&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 渲染数据</span></span><br><span class="line">search_input_psw.send_keys(<span class="string">&quot;lsk2lmy1314&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先点击阅读接�?</span></span><br><span class="line">search_receive_btn = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__isAgree&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击</span></span><br><span class="line">search_receive_btn.click()</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后找到登入按钮</span></span><br><span class="line">search_btn = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__submit&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击按钮</span></span><br><span class="line">search_btn.click()</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 获得点击发送验证码的按�?</span></span><br><span class="line">search_input_verification_btn = browser.find_element(By.XPATH,<span class="string">&#x27;//*[@id=&quot;goToVerify&quot;]&#x27;</span>)</span><br><span class="line"><span class="comment"># 点击发送验证码</span></span><br><span class="line">search_input_verification_btn.click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得输入验证码的�?</span></span><br><span class="line">search_input_verification = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;passAuthVcode&quot;]&#x27;</span>)</span><br><span class="line"><span class="comment"># 将得到的验证码在一分钟之内，输入进�?</span></span><br><span class="line"><span class="comment"># 第一次见进入的时候，会发送验证码，你随机填的验证码肯定不正确</span></span><br><span class="line"><span class="comment"># 但是你第二次，启动之前把你获得的验证码放在括号里，就可以登入成功</span></span><br><span class="line">search_input_verification.send_keys(<span class="string">&quot;913879&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得校验验证码的按钮</span></span><br><span class="line">search_verification_btn = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;passAuthSubmitCode&quot;]&#x27;</span>)</span><br><span class="line"><span class="comment"># 点击下一�?</span></span><br><span class="line">search_verification_btn.click()</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 可以用input标签不让程序自动关闭</span></span><br><span class="line"><span class="comment"># input(&quot;阻止它关闭：&quot;)</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/13.0Django%E6%A1%86%E6%9E%B6Form%E7%BB%84%E4%BB%B6%E4%B9%8B%E6%B8%B2%E6%9F%93HTML%E4%BB%A3%E7%A0%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/13.0Django%E6%A1%86%E6%9E%B6Form%E7%BB%84%E4%BB%B6%E4%B9%8B%E6%B8%B2%E6%9F%93HTML%E4%BB%A3%E7%A0%81/" class="post-title-link" itemprop="url">13.0Django���Form���֮��ȾHTML����</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Django框架Form组件之渲染HTML代码</h1>
<h2 id="【一】渲染方�">【一】渲染方�?</h2>
<h3 id="�-】直接渲�">�?】直接渲�?</h3>
<ul>
<li>直接渲染form组件对象</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>form登入页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    `&#123;&#123; form_obj &#125;&#125;`</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240701231854916.png" alt="image-20240701231854916"></p>
<h3 id="�-】渲染成无序列表as-ul">�?】渲染成无序列表as_ul</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>form登入页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    `&#123;&#123; form_obj.as_ul &#125;&#125;`</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240701232027825.png" alt="image-20240701232027825"></p>
<h3 id="�-】渲染成p标签as-p">�?】渲染成p标签as_p</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>form登入页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    `&#123;&#123; form_obj.as_p &#125;&#125;`</span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240702155528712.png" alt="image-20240702155528712"></p>
<h3 id="�-】渲染成表格">�?】渲染成表格</h3>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>form登入页面<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">        `&#123;&#123; form_obj.as_table &#125;&#125;`</span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240701232500428.png" alt="image-20240701232500428"></p>
<h3 id="�-】后端的代码">�?】后端的代码</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_one</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">UserForm</span>(forms.Form):</span><br><span class="line">        username = forms.CharField(</span><br><span class="line">            <span class="comment"># 最大长�?</span></span><br><span class="line">            max_length=<span class="number">8</span>,</span><br><span class="line">            <span class="comment"># 最小长�?</span></span><br><span class="line">            min_length=<span class="number">3</span>,</span><br><span class="line">            <span class="comment"># label是显示在输入框之前的提示文本</span></span><br><span class="line">            label=<span class="string">&#x27;用户�?,</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">        password = forms.CharField(</span></span><br><span class="line"><span class="string">            # 输入的额信息是保密的</span></span><br><span class="line"><span class="string">            widget=forms.PasswordInput(</span></span><br><span class="line"><span class="string">                attrs=&#123;&#x27;</span><span class="keyword">class</span><span class="string">&#x27;: &#x27;</span>c1<span class="string">&#x27;&#125;, render_value=True</span></span><br><span class="line"><span class="string">            )</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">    # 得到的是处理好的input标签</span></span><br><span class="line"><span class="string">    form_obj = UserForm()</span></span><br><span class="line"><span class="string">    print(form_obj)</span></span><br><span class="line"><span class="string">    # &lt;tr&gt;&lt;th&gt;&lt;label for=&quot;id_username&quot;&gt;用户�?&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;username&quot; maxlength=&quot;8&quot; minlength=&quot;3&quot; required id=&quot;id_username&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span></span><br><span class="line"><span class="string">	#&lt;tr&gt;&lt;th&gt;&lt;label for=&quot;id_password&quot;&gt;Password:&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; class=&quot;c1&quot; required id=&quot;id_password&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span></span><br><span class="line"><span class="string">    # 返回的是bool值，校验你数据是否有�?</span></span><br><span class="line"><span class="string">    # 如果所有校验都通过，返�?True；如果任何校验失败，返回 False</span></span><br><span class="line"><span class="string">    form_obj.is_valid()</span></span><br><span class="line"><span class="string">    # 打印错误信息</span></span><br><span class="line"><span class="string">    print(form_obj.errors)</span></span><br><span class="line"><span class="string">    # 获取校验成功的数�?</span></span><br><span class="line"><span class="string">    # print(form_obj.cleaned_data)</span></span><br><span class="line"><span class="string">    # print(request.POST)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    return render(request, &#x27;</span>form_one.html<span class="string">&#x27;, locals())</span></span><br><span class="line"><span class="string"></span></span><br></pre></td></tr></table></figure>
<h3 id="�-】form表单里面的label属�">�?】form表单里面的label属�?</h3>
<ul>
<li>obj.label  找到 的是定义的字段名�?</li>
<li>form.errors 提取当前form组件验证当前字段数据对应的错误信�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1&gt;form登入页面&lt;/h1&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    `(妯℃澘鏍囩)`</span><br><span class="line">        `&#123;&#123; obj.label &#125;&#125;`</span><br><span class="line">    	`&#123;&#123; obj &#125;&#125;`</span><br><span class="line">        `&#123;&#123; obj.errors &#125;&#125;`</span><br><span class="line">    `(妯℃澘鏍囩)`</span><br><span class="line">&lt;p&gt;&lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django <span class="keyword">import</span> forms</span><br><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_one</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">class</span> <span class="title class_">UserForm</span>(forms.Form):</span><br><span class="line">        username = forms.CharField(</span><br><span class="line">            <span class="comment"># 最大长�?</span></span><br><span class="line">            max_length=<span class="number">8</span>,</span><br><span class="line">            <span class="comment"># 最小长�?</span></span><br><span class="line">            min_length=<span class="number">3</span>,</span><br><span class="line">            <span class="comment"># label是显示在输入框之前的提示文本</span></span><br><span class="line">            label=<span class="string">&#x27;用户�?,</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">        password = forms.CharField(</span></span><br><span class="line"><span class="string">            min_length=3,</span></span><br><span class="line"><span class="string">            # 输入的额信息是保密的</span></span><br><span class="line"><span class="string">            widget=forms.PasswordInput(</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                attrs=&#123;&#x27;</span><span class="keyword">class</span><span class="string">&#x27;: &#x27;</span>c1<span class="string">&#x27;&#125;, render_value=True</span></span><br><span class="line"><span class="string">            )</span></span><br><span class="line"><span class="string">        )</span></span><br><span class="line"><span class="string">    data = &#123;&quot;username&quot;: &quot;admin&quot;, &quot;password&quot;: &quot;11&quot;&#125;</span></span><br><span class="line"><span class="string">    form_obj = UserForm(data)</span></span><br><span class="line"><span class="string">    print(form_obj)</span></span><br><span class="line"><span class="string">    # &lt;tr&gt;&lt;th&gt;&lt;label for=&quot;id_username&quot;&gt;用户�?&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;text&quot; name=&quot;username&quot; maxlength=&quot;8&quot; minlength=&quot;3&quot; required id=&quot;id_username&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span></span><br><span class="line"><span class="string">    # &lt;tr&gt;&lt;th&gt;&lt;label for=&quot;id_password&quot;&gt;Password:&lt;/label&gt;&lt;/th&gt;&lt;td&gt;&lt;input type=&quot;password&quot; name=&quot;password&quot; class=&quot;c1&quot; required id=&quot;id_password&quot;&gt;&lt;/td&gt;&lt;/tr&gt;</span></span><br><span class="line"><span class="string">    form_obj.is_valid()</span></span><br><span class="line"><span class="string">    # 打印错误信息</span></span><br><span class="line"><span class="string">    print(form_obj.errors)</span></span><br><span class="line"><span class="string">    # 获取校验成功的数�?</span></span><br><span class="line"><span class="string">    print(form_obj.cleaned_data)</span></span><br><span class="line"><span class="string">    # print(request.POST)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    return render(request, &#x27;</span>form_one.html<span class="string">&#x27;, locals())</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/14.0Django%E6%A1%86%E6%9E%B6%E4%B9%8BCookie%E5%92%8CSession.m/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/14.0Django%E6%A1%86%E6%9E%B6%E4%B9%8BCookie%E5%92%8CSession.m/" class="post-title-link" itemprop="url">14.0Django���֮Cookie��Session.m</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Django框架之Cookie和Session</h1>
<h2 id="【一】Cookie和Session的发展史">【一】Cookie和Session的发展史</h2>
<h3 id="�-】Cookie">�?】Cookie</h3>
<p>1994年，网景通信公司推出了第一个浏览器Cookie技�?</p>
<ul>
<li>Cookie是储存在用户计算机上的小型文本文件，用于跟踪在网站上的活�?</li>
<li>初始版的Cookie只能存储很少的数据，并且没有很强的加密机制，容易被人恶意修改和窃�?</li>
</ul>
<h3 id="�-】Session">�?】Session</h3>
<p>1997年，Sun Microsystems提出了基于服务器的会话管理方案，即Session</p>
<ul>
<li>Cookie存在的局限性，Web开发人员开始寻找更安全、可靠的替代方案</li>
<li>Session是服务器存储用户会话数据的一种技�?</li>
<li>每当访问数据时，服务器会为其创建一个唯一的Session标识符（Session ID），并将会话数据存储在服务器�?</li>
<li>Session ID一般通过Cookie或URL参数传递给客户端，用于识别用户的会话状�?</li>
</ul>
<h3 id="�-】Coookie和Session两者之间的关系">�?】Coookie和Session两者之间的关系</h3>
<ul>
<li>
<p>在实际应用中，Cookie和Session通常结合使用。当用户首次访问网站时，服务器会为其分配一个唯一的Session ID，并将其存储在Cookie中，发送给客户端保�?</p>
</li>
<li>
<p>随后，客户端在每次请求中都会携带该Cookie，服务器通过解析Cookie中的Session ID，读取对应的会话数据，实现用户状态的跟踪和管�?</p>
</li>
</ul>
<h3 id="�-】总结">�?】总结</h3>
<ul>
<li>Cookie和Session是Web应用程序中常用的用户会话跟踪技术�?</li>
<li>Cookie通过在客户端存储小型文本文件，并将会话标识符传递给服务器，实现会话状态的保持�?</li>
<li>而Session则是在服务器端存储会话数据，通过Session ID实现对用户会话的追踪�?</li>
<li>它们的发展历程与互联网的发展紧密相关，为开发人员提供了更多的选择，以保障安全性和用户体验的提�?</li>
</ul>
<h2 id="【二】Cookie和Session的介�">【二】Cookie和Session的介�?</h2>
<h3 id="�-】Cookie-2">�?】Cookie</h3>
<ul>
<li>服务端保存在客户端浏览器上的信息都可以称之为Cookie</li>
<li>指代服务端让客户端保存的数据(存储在客户端上与用户信息相关的数�?</li>
<li>表现格式一般为k:v键值对，可以有多个</li>
</ul>
<h3 id="�-】Session-2">�?】Session</h3>
<ul>
<li>
<p>保存在服务端上的数据都可以叫做Session</p>
</li>
<li>
<p>指代服务端保存的跟用户信息相关的数据</p>
</li>
<li>
<p>表现格式一般为k:v键值对，可以有多个</p>
</li>
</ul>
<h3 id="�-】token">�?】token</h3>
<ul>
<li>
<p>session虽然数据是保存在服务端的，但是挡不住数据量大</p>
</li>
<li>
<p>解决办法：服务端不再保存数据</p>
</li>
<li>
<ul>
<li>登陆成功之后，将一段信息加密处�?用自己独特的加密方式进行加密)</li>
</ul>
</li>
<li>
<p>将加密之后的结果拼接在信息后面，整体返回给浏览器保存</p>
</li>
<li>
<p>浏览器下次访问的时候带着该信息，服务端自动切取前面的一段信息再次使用自己的加密算法进行加密</p>
</li>
<li>
<p>然后用这段密文与携带过来的密文进行比�?</p>
</li>
</ul>
<h3 id="�-】总结-2">�?】总结</h3>
<ul>
<li>cookie就是保存在客户端浏览器上的信�?</li>
<li>session就是保存在服务端的数据库中的</li>
<li>session是基于cookie工作�?其实大部分的保存用户状态的操作都需要使用cookie)</li>
</ul>
<h2 id="【三】Django操作Cookie">【三】Django操作Cookie</h2>
<h3 id="�-】操作Cookie返回的三板斧对象有所改变">�?】操作Cookie返回的三板斧对象有所改变</h3>
<ul>
<li>返回的三板斧数据要被赋值返�?</li>
<li>操作Cookie就要</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">obj1 = render()</span><br><span class="line"><span class="keyword">return</span> obj1</span><br><span class="line"></span><br><span class="line">obj2 = HttpResponse()</span><br><span class="line"><span class="keyword">return</span> obj2</span><br><span class="line"></span><br><span class="line">obj3 = redirect()</span><br><span class="line"><span class="keyword">return</span> obj3</span><br></pre></td></tr></table></figure>
<h3 id="�-】设置Cookie">�?】设置Cookie</h3>
<h4 id="�-）案例：用户登入以后才可以进入浏览器页面">�?）案例：用户登入以后才可以进入浏览器页面</h4>
<ul>
<li>设置Cookie</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置coookie</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.POST.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.POST.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="comment"># 我们把值设置死�?</span></span><br><span class="line">        <span class="keyword">if</span> username != <span class="string">&quot;tom&quot;</span> <span class="keyword">or</span> password != <span class="string">&quot;710&quot;</span>:</span><br><span class="line">            <span class="comment"># 不对的话再次返回登入页面</span></span><br><span class="line">            <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">        <span class="comment"># 如果登入成功，保存登入的Cookie状�?</span></span><br><span class="line">        <span class="comment"># 创建三板斧对象并赋�?</span></span><br><span class="line">        login_obj = redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">        <span class="comment"># print(login_obj)</span></span><br><span class="line">        <span class="comment"># 设置Cookie信息</span></span><br><span class="line">        <span class="comment"># 里面的参数是k:v</span></span><br><span class="line">        <span class="comment"># login_obj.set_cookie(&#x27;sign&#x27;, &#x27;555&#x27;)</span></span><br><span class="line">        <span class="built_in">print</span>(login_obj.set_cookie(<span class="string">&#x27;sign&#x27;</span>, <span class="string">&#x27;555&#x27;</span>))</span><br><span class="line">        <span class="comment"># 最后记得返回的是你将三板斧赋值的对象</span></span><br><span class="line">        <span class="keyword">return</span> login_obj</span><br><span class="line">    obj = render(request, <span class="string">&#x27;login.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line">    <span class="keyword">return</span> obj</span><br></pre></td></tr></table></figure>
<ul>
<li>获取Cookie
<ul>
<li>能获得Cookie的信息，代表已经登入</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取cookie</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    cookie = request.COOKIES.get(<span class="string">&#x27;sign&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> cookie == <span class="string">&#x27;555&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br></pre></td></tr></table></figure>
<ul>
<li>删除Cookie
<ul>
<li>�?点击退出按钮，进入到清除cookie的函数里，清除cookie信息</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除cookie</span></span><br><span class="line"><span class="comment"># 清除电脑上刚签发的Cookie</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 退出之�?</span></span><br><span class="line">    obj = redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">    <span class="comment"># 删除Cookie,把你定义的cookie信息删除</span></span><br><span class="line">    obj.delete_cookie(<span class="string">&#x27;sign&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> obj</span><br></pre></td></tr></table></figure>
<ul>
<li>进入的主页面</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;home.html&#x27;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<ul>
<li>前端页面</li>
<li>主页面home.html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;```(妯℃澘鏍囩)```&quot;</span>&gt;</span>点击登入<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;```(妯℃澘鏍囩)```&quot;</span>&gt;</span>登入之后进入首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;```(妯℃澘鏍囩)```&quot;</span>&gt;</span>点击退出登�?/a&gt;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>首页index.html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是首页index<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>登入页面login.html</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;form action=<span class="string">&quot;&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">    &lt;p&gt;username:&lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;username&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;password:&lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;password&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;<span class="built_in">input</span> <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span>&gt;&lt;/p&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="http://xn--urls-u65j293j.py">路由urls.py</a></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> user.views <span class="keyword">import</span> index, login, home, logout</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;login/&#x27;</span>, login, name=<span class="string">&#x27;login&#x27;</span>),</span><br><span class="line">    path(<span class="string">&#x27;logout/&#x27;</span>, logout, name=<span class="string">&#x27;logout&#x27;</span>),</span><br><span class="line">    path(<span class="string">&#x27;index/&#x27;</span>, index, name=<span class="string">&#x27;index&#x27;</span>),</span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, home, name=<span class="string">&#x27;home&#x27;</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="�-】Cookie的方法介�">�?】Cookie的方法介�?</h3>
<h4 id="�-）key-设置Cookie的键">�?）key:设置Cookie的键</h4>
<ul>
<li>sign就是�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_obj.set_cookie(<span class="string">&#x27;sign&#x27;</span>, <span class="string">&#x27;555&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="2-value：设置Cookie的�">(2)value：设置Cookie的�?</h4>
<ul>
<li>555就是�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_obj.set_cookie(<span class="string">&#x27;sign&#x27;</span>, <span class="string">&#x27;555&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）max-age：Cookie设置的键值多久时间过�">�?）max_age：Cookie设置的键值多久时间过�?</h4>
<ul>
<li>max_age=5�?秒后过期�?秒后重新登入</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">login_obj.set_cookie(<span class="string">&#x27;sign&#x27;</span>, <span class="string">&#x27;555&#x27;</span>, max_age=<span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<h4 id="�-）expires：也是过期时�">�?）expires：也是过期时�?</h4>
<ul>
<li>针对于IE浏览�?</li>
<li>以秒为单�?</li>
</ul>
<h4 id="�-）domain：域�">�?）domain：域�?</h4>
<h4 id="�-）path：路�">�?）path：路�?</h4>
<h4 id="�-）secure：安全组策略">�?）secure：安全组策略</h4>
<h4 id="�-）httponly：只限制�-HTTP-请求">�?）httponly：只限制�?HTTP 请求</h4>
<h3 id="�-】增加装饰器">�?】增加装饰器</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.POST.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.POST.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="comment"># 我们把值设置死�?</span></span><br><span class="line">        <span class="keyword">if</span> username != <span class="string">&quot;tom&quot;</span> <span class="keyword">or</span> password != <span class="string">&quot;710&quot;</span>:</span><br><span class="line">            <span class="comment"># 不对的话再次返回登入页面</span></span><br><span class="line">            <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">        <span class="comment"># 如果登入成功，保存登入的Cookie状�?</span></span><br><span class="line">        <span class="comment"># 创建三板斧对象并赋�?</span></span><br><span class="line">        login_obj = redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">        <span class="comment"># print(login_obj)</span></span><br><span class="line">        <span class="comment"># 设置Cookie信息</span></span><br><span class="line">        <span class="comment"># 里面的参数是k:v</span></span><br><span class="line">        <span class="comment"># login_obj.set_cookie(&#x27;sign&#x27;, &#x27;555&#x27;)</span></span><br><span class="line">        <span class="built_in">print</span>(login_obj.set_cookie(<span class="string">&#x27;sign&#x27;</span>, <span class="string">&#x27;555&#x27;</span>))</span><br><span class="line">        <span class="comment"># 最后记得返回的是你将三板斧赋值的对象</span></span><br><span class="line">        <span class="keyword">return</span> login_obj</span><br><span class="line">    obj = render(request, <span class="string">&#x27;login.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line">    <span class="keyword">return</span> obj</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">outer</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">request, *args, **kwargs</span>):</span><br><span class="line">        <span class="comment"># 校验是否已经的登入过</span></span><br><span class="line">        <span class="comment"># tag_url = request.get_full_path()</span></span><br><span class="line">        <span class="built_in">print</span>(request)  <span class="comment"># &lt;WSGIRequest: GET &#x27;/index/&#x27;&gt;</span></span><br><span class="line">        <span class="built_in">print</span>(func)  <span class="comment"># &lt;function index at 0x000002359ACA7910&gt;</span></span><br><span class="line">        <span class="comment"># print(f&#x27;outer装饰�?---》&#123;tag_url&#125;&#x27;)</span></span><br><span class="line">        <span class="comment"># outer装饰�?---�?index/</span></span><br><span class="line">        <span class="keyword">if</span> request.COOKIES.get(<span class="string">&#x27;sign&#x27;</span>) == <span class="string">&#x27;555&#x27;</span>:</span><br><span class="line">            res = func(request, *args, **kwargs)</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取cookie</span></span><br><span class="line"><span class="meta">@outer</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    obj = render(request, <span class="string">&#x27;index.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line">    <span class="keyword">return</span> obj</span><br></pre></td></tr></table></figure>
<h2 id="【四】Django操作Session">【四】Django操作Session</h2>
<ul>
<li>
<p>session数据是保存在服务端的，就是保存到数据库中，给客户端返回的是一个随机字符串</p>
</li>
<li>
<p>sessionid：随机字符串</p>
</li>
<li>
<p><strong>首先，操作Session的前提是要迁移数据库</strong></p>
</li>
</ul>
<h3 id="�-】设置Session，案�">�?】设置Session，案�?</h3>
<h4 id="1-案例：用户登入以后才可以进入浏览器页�">(1)案例：用户登入以后才可以进入浏览器页�?</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect, reverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;home.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置coookie</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&#x27;POST&#x27;</span>:</span><br><span class="line">        username = request.POST.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.POST.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="comment"># 我们把值设置死�?</span></span><br><span class="line">        <span class="keyword">if</span> username != <span class="string">&quot;tom&quot;</span> <span class="keyword">or</span> password != <span class="string">&quot;710&quot;</span>:</span><br><span class="line">            <span class="comment"># 不对的话再次返回登入页面</span></span><br><span class="line">            <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">        <span class="comment"># 登入成功---》储存登入的状�?</span></span><br><span class="line">        request.session[<span class="string">&#x27;sign&#x27;</span>] = <span class="string">&#x27;555&#x27;</span></span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;login.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    session = request.session.get(<span class="string">&#x27;sign&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(session)  <span class="comment"># 555</span></span><br><span class="line">    <span class="keyword">if</span> session == <span class="string">&#x27;555&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除cookie</span></span><br><span class="line"><span class="comment"># 清除电脑上刚签发的Cookie</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 完全退出浏览器--清除掉你刚才签发的session</span></span><br><span class="line">    <span class="comment"># Django会帮助你自动�?Django-session表中�?sessionid 对应的数据删除掉</span></span><br><span class="line">    <span class="comment"># 但是浏览器还会就看到 session �?但是那个串没有用</span></span><br><span class="line">    request.session.delete()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 实现服务端和客户端都删除</span></span><br><span class="line">    request.session.flush()</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;home.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="�-】session的方法介�">�?】session的方法介�?</h3>
<h4 id="�-）request-session-sign-555">�?）<code>request.session['sign'] = '555'</code></h4>
<ul>
<li>储存数据的状�?</li>
<li>并且数据库的session会多一条数据，保存的数据是一�?</li>
</ul>
<h4 id="�-）session-request-session-get-sign">�?）<code>session = request.session.get('sign')</code></h4>
<ul>
<li>获取到你签发的�?</li>
</ul>
<h4 id="�-）request-session-delete">�?）<code>request.session.delete()</code></h4>
<ul>
<li>
<p>完全退出浏览器–清除掉你刚才签发的session</p>
</li>
<li>
<p>删除签发数据，并将数据库里面的数据一并删�?</p>
</li>
</ul>
<h4 id="�-）request-session-flush">�?）<code>request.session.flush()</code></h4>
<ul>
<li>
<p>服务端和客户端都删除</p>
</li>
<li>
<p>该方法用于完全删除当前用户的Session，包括Session对象和所有相关数�?</p>
</li>
</ul>
<h4 id="�-）request-session-set-expiry-value">�?）<code>request.session.set_expiry(value)</code></h4>
<ul>
<li>
<p>设置过期时间</p>
</li>
<li>
<p>如果value是个整数，session会在些秒数后失效</p>
</li>
<li>
<p>如果value是个datatime或timedelta，session就会在这个时间后失效</p>
</li>
<li>
<p>如果value�?,用户关闭浏览器session就会失效</p>
</li>
<li>
<p>如果value是None,session会依赖全局session失效策略</p>
</li>
<li>
<p>参数</p>
</li>
<li>
<ul>
<li>整数</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>多少秒过�?</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>日期对象</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>到指定日期失�?</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>0</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>一旦退出当前浏览器窗口就失�?</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>不写</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>失效时间取决于Django内部全局session失效的时�?</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Django默认的session失效时间�?4�?</p>
<h3 id="【session的装饰器�">【session的装饰器�?</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect, reverse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;home.html&quot;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_cookie</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = request.POST.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.POST.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;admin&quot;</span> <span class="keyword">and</span> password == <span class="string">&quot;123456&quot;</span>:</span><br><span class="line">            <span class="comment"># �?】获取三板斧对象</span></span><br><span class="line">            response = redirect(reverse(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">            <span class="comment"># �?】向三板斧对象中设置 Cookie</span></span><br><span class="line">            <span class="comment"># max_age : 过期时间 s</span></span><br><span class="line">            response.set_cookie(<span class="string">&quot;sign&quot;</span>, <span class="string">f&quot;666&quot;</span>)</span><br><span class="line">            <span class="comment"># �?】将三板斧对象返�?</span></span><br><span class="line">            <span class="keyword">return</span> response</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login_cookie.html&quot;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_session</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">        username = request.POST.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">        password = request.POST.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> username == <span class="string">&quot;admin&quot;</span> <span class="keyword">and</span> password == <span class="string">&quot;123456&quot;</span>:</span><br><span class="line">            <span class="comment"># 使用session的前提是先要迁移数据�?---&gt; django-session ---&gt; 存session</span></span><br><span class="line">            <span class="comment"># �?】设�?session</span></span><br><span class="line">            request.session[<span class="string">&quot;sign&quot;</span>] = <span class="string">f&quot;666&quot;</span></span><br><span class="line">            <span class="comment"># �?】重定向到首�?</span></span><br><span class="line">            <span class="keyword">return</span> redirect(reverse(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login_session.html&quot;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout_cookie</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 删除cookie删除cookie</span></span><br><span class="line">    response = redirect(reverse(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">    response.delete_cookie(<span class="string">&quot;sign&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout_session</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 删除session</span></span><br><span class="line">    request.session.delete()  <span class="comment"># 只能清除�?数据库中的session 清除不掉前端�?session</span></span><br><span class="line">    <span class="comment"># 删除客户端和服务端的session</span></span><br><span class="line">    request.session.flush()</span><br><span class="line">    <span class="keyword">return</span> redirect(reverse(<span class="string">&quot;home&quot;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 做一�?Cookie的登录认证装饰器</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decorator_login</span>(<span class="params">tag</span>):</span><br><span class="line">    <span class="keyword">if</span> tag == <span class="string">&quot;cookie&quot;</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">outer</span>(<span class="params">func</span>):</span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">request, *args, **kwargs</span>):</span><br><span class="line">                cookie_data = request.COOKIES.get(<span class="string">&quot;sign&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> cookie_data == <span class="string">&quot;666&quot;</span>:</span><br><span class="line">                    response = func(request, *args, **kwargs)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    response = redirect(reverse(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> outer</span><br><span class="line">    <span class="keyword">elif</span> tag == <span class="string">&quot;session&quot;</span>:</span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">outer</span>(<span class="params">func</span>):</span><br><span class="line">            <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">request, *args, **kwargs</span>):</span><br><span class="line">                session_data = request.session.get(<span class="string">&quot;sign&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> session_data == <span class="string">&quot;666&quot;</span>:</span><br><span class="line">                    response = func(request, *args, **kwargs)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    response = redirect(reverse(<span class="string">&quot;home&quot;</span>))</span><br><span class="line">                <span class="keyword">return</span> response</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> outer</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator_login(<span class="params">tag=<span class="string">&quot;cookie&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index_cookie</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;index_cookie.html&quot;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@decorator_login(<span class="params">tag=<span class="string">&quot;session&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index_session</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;index_session.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<h2 id="【源码解析�">【源码解析�?</h2>
<ul>
<li>
<p><em>request</em>.session[‘sign’] = &quot;555&quot;内部发生了哪些事</p>
<ul>
<li>Django内部会帮我们自动生成一个随机字符串</li>
<li>Django内部会将随机字符串和对应的数据存储到django_sessoin表中</li>
<li>
<ul>
<li>
<ul>
<li>先在内存中产生操作数据的内存</li>
<li>在响应经过Django中间件的时候才去操作数据数据库</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>将产生的随机字符串返回给和客户端浏览器保�?</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;django.middleware.security.SecurityMiddleware&#x27;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>request.session.get(“sign”)内部发生了哪些事</p>
</li>
<li>
<ul>
<li>自动从浏览器请求中获�?sessionid 对应的随机字符串</li>
<li>根据该随机字符串去django_session表中查找对应的数�?</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>如果匹配成功，则将对应的数据取出并以字典的形式封装到request.session�?</li>
<li>如果匹配不成功，则request.session中的数据为None</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="【注意�">【注意�?</h2>
<ul>
<li>
<p>使用session之前一定先迁移数据�?</p>
<ul>
<li>因为使用session,Django会讲数据自动保存到数据库的django_sessoin表中</li>
</ul>
</li>
<li>
<p>设置多个同名的session</p>
<ul>
<li>
<p>使用的是最后一个session</p>
</li>
<li>
<p>得到的也是最后一�?</p>
</li>
<li>
<pre><code class="language-python"># 设置很多同名�?session ---&gt; 拿到哪一个session
        # 拿到的是最后的一�?session�?
         request.session[&quot;sign&quot;] = &quot;888&quot;
         request.session[&quot;sign&quot;] = &quot;999&quot;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 设置不同名的多个 session  ---&gt; 拿到哪一个session</span><br><span class="line"></span><br><span class="line">  ```python</span><br><span class="line">      # 获取指定键的时候能够获取到指定的�?</span><br><span class="line">       request.session[&quot;sign_one&quot;] = &quot;888&quot;</span><br><span class="line">       request.session[&quot;sign_two&quot;] = &quot;999&quot;</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
</ul>
</li>
<li>
<p>使用cookie�?</p>
<ul>
<li>return 出去的一定不能是三板斧，讲三板斧赋值返回出�</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/15.0Django%E6%A1%86%E6%9E%B6%E4%B9%8BCBV%E6%B7%BB%E5%8A%A0%E8%A3%85%E9%A5%B0%E5%99%A8%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/15.0Django%E6%A1%86%E6%9E%B6%E4%B9%8BCBV%E6%B7%BB%E5%8A%A0%E8%A3%85%E9%A5%B0%E5%99%A8%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">15.0Django���֮CBV���װ���������ַ�ʽ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Django框架之CBV添加装饰器的三种方式</h1>
<h2 id="【一】引入一个第三方模块">【一】引入一个第三方模块</h2>
<ul>
<li>给类定义需要引入一个第三方模块</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.utils.decorators <span class="keyword">import</span> method_decorator</span><br></pre></td></tr></table></figure>
<h2 id="【二】三种添加装饰器的方�">【二】三种添加装饰器的方�?</h2>
<h3 id="�-】方式一：给类里面的指定的函数加">�?】方式一：给类里面的指定的函数加</h3>
<ul>
<li>视图文件</li>
<li>给登入类里面的POST函数增加装饰�?</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render, redirect, reverse</span><br><span class="line"><span class="keyword">from</span> django.utils.decorators <span class="keyword">import</span> method_decorator</span><br><span class="line"><span class="keyword">from</span> django.views <span class="keyword">import</span> View</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&#x27;index.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_one</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner</span>(<span class="params">request, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">            username = request.POST.get(<span class="string">&quot;username&quot;</span>)</span><br><span class="line">            password = request.POST.get(<span class="string">&quot;password&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> username != <span class="string">&quot;tom&quot;</span> <span class="keyword">or</span> password != <span class="string">&quot;666&quot;</span>:</span><br><span class="line">                <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;home&#x27;</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="keyword">return</span> func(request, *args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> inner</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginInfo</span>(<span class="title class_ inherited__">View</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;login.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line"><span class="meta">    @method_decorator(<span class="params">login_one</span>)</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;index&#x27;</span>))</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>前端</li>
<li>login.html</li>
<li>登入首页，用户名和密码错误原地跳�?</li>
<li>用户名密码正确，跳转到index.html</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">&quot;&quot;</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>username:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>password:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>index.html</li>
<li>登入以后成功自动跳转到的页面</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是首页index<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><a target="_blank" rel="noopener" href="http://urls.py">urls.py</a></li>
<li>配置路径</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> user.views <span class="keyword">import</span> LoginInfo, index</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    path(<span class="string">&#x27;index/&#x27;</span>, index, name=<span class="string">&#x27;index&#x27;</span>),</span><br><span class="line">    path(<span class="string">&quot;&quot;</span>, LoginInfo.as_view(), name=<span class="string">&#x27;login_info&#x27;</span>)</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="�-】方式二：把装饰器放在类上面">�?】方式二：把装饰器放在类上面</h3>
<ul>
<li>就是在装饰器的头上加一个装饰器</li>
<li>参数介绍
<ul>
<li>第一个参数是：装饰器的，名字</li>
<li>第二个参数是：类自己本身的函数的名字
<ul>
<li>写那个函数名就是给那个函数添加装饰器</li>
<li>实现的结果和方法一一�?</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@method_decorator(<span class="params">login_one, name=<span class="string">&#x27;post&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">LoginInfo</span>(<span class="title class_ inherited__">View</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> render(request, <span class="string">&#x27;login.html&#x27;</span>, <span class="built_in">locals</span>())</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">        <span class="keyword">return</span> redirect(reverse(<span class="string">&#x27;index&#x27;</span>))</span><br></pre></td></tr></table></figure>
<h3 id="�-】方法三：重写dispatch方法">�?】方法三：重写dispatch方法</h3>
<ul>
<li>在类中定义dispatch方法（直接cv�?
<ul>
<li>dispatch方法在哪<code>（类视图 ---&gt; as_view() ---&gt; 里面�?view() ---&gt; self.dispatch()）</code></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每个类视图函数都会走的函数，相当于给所有人都加了装饰器</span></span><br><span class="line"><span class="meta">@method_decorator(<span class="params">login_one</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dispatch</span>(<span class="params">self, request, *args, **kwargs</span>):</span><br><span class="line">    <span class="comment"># Try to dispatch to the right method; if a method doesn&#x27;t exist,</span></span><br><span class="line">    <span class="comment"># defer to the error handler. Also defer to the error handler if the</span></span><br><span class="line">    <span class="comment"># request method isn&#x27;t on the approved list.</span></span><br><span class="line">    <span class="keyword">if</span> request.method.lower() <span class="keyword">in</span> <span class="variable language_">self</span>.http_method_names:</span><br><span class="line">        handler = <span class="built_in">getattr</span>(<span class="variable language_">self</span>, request.method.lower(), <span class="variable language_">self</span>.http_method_not_allowed)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        handler = <span class="variable language_">self</span>.http_method_not_allowed</span><br><span class="line">    <span class="keyword">return</span> handler(request, *args, **kwargs)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/2.0Django%E5%AE%89%E8%A3%85/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/2.0Django%E5%AE%89%E8%A3%85/" class="post-title-link" itemprop="url">2.0Django��װ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 17:47:38" itemprop="dateModified" datetime="2025-10-11T17:47:38+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Django安装</h1>
<h2 id="【一】建�">【一】建�?</h2>
<ul>
<li>首先要知道自己的环境变量</li>
<li>区分我们现在的python版本
<ul>
<li>根据你在环境变量里面python解释器的定义顺序决定�?</li>
<li>那个解释器在上默认就是那个解释器</li>
</ul>
</li>
<li>默认是那个解释器pip安装<code>Django</code>就安装在那个解释器上</li>
<li><code>pip install django</code></li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617194848746.png" alt="image-20240617194848746"></p>
<h2 id="【二】安装Django注意事项">【二】安装Django注意事项</h2>
<ul>
<li>安装Django的时候，计算机名称不建议设置成中�?</li>
<li>python解释器不同可能会引起报错</li>
<li>Django项目名和路径名不能出现中�?—&gt;****</li>
<li>一个Django项目是一个单独的项目----&gt;****
<ul>
<li>不要出现其他无关紧要的文件或文件夹，都不可以</li>
</ul>
</li>
</ul>
<h2 id="【三】Django安装">【三】Django安装</h2>
<h3 id="�-】安装命�">�?】安装命�?</h3>
<ul>
<li>直接<code>insatall</code>回安装最新版本的<code>Django</code></li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django</span><br></pre></td></tr></table></figure>
<ul>
<li>查看所有的<code>Django</code>版本信息</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django==</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617200314336.png" alt="image-20240617200314336"></p>
<ul>
<li>安装指定的<code>Django</code>的版�?</li>
<li>比如你安装的有<code>Django</code>它会自动把你的删掉，然后把你指定的下载上</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install django==3.2.12</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617200330468.png" alt="image-20240617200330468"></p>
<ul>
<li>下载好以后会提示你安装到了那个python解释器身上了</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Requirement already satisfied: pytz in d:\pycharm\python310\lib\site-packages (from django==3.2.12) (2024.1)</span><br></pre></td></tr></table></figure>
<h2 id="【四】如何验�">【四】如何验�?</h2>
<ul>
<li>下面这句话代表安装成�?</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Successfully installed asgiref-3.8.1 django-3.2.12 pytz-2024.1 sqlparse-0.5.0 typing-extensions-4.12.2</span><br></pre></td></tr></table></figure>
<h3 id="�-】命令行">�?】命令行</h3>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">django-admin</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617201117322.png" alt="image-20240617201117322"></p>
<h3 id="�-】直接去指定的文件目录下�">�?】直接去指定的文件目录下�?</h3>
<ul>
<li>在python解释器下的Scripts文件夹下</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617201545725.png" alt="image-20240617201545725"></p>
<h2 id="【五】使用Django创建项目">【五】使用Django创建项目</h2>
<h3 id="�-】命令行创建">�?】命令行创建</h3>
<h4 id="�-）创建目�">�?）创建目�?</h4>
<ul>
<li>创建步骤看下�?</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">django-admin startproject 项目�?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">django-admin startproject first-django</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617202357023.png" alt="image-20240617202357023"></p>
<ul>
<li>弹出一个框，输入cmd，回�?</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617202440933.png" alt="image-20240617202440933"></p>
<ul>
<li>进入cmd命令窗口，然后输入<code>pip install  starproject fisrt_django</code></li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617202752116.png" alt="image-20240617202752116"></p>
<ul>
<li>创建成功</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617202814424.png" alt="image-20240617202814424"></p>
<h4 id="�-）解释创建的fisrt-django文件夹的解释">�?）解释创建的<code>fisrt_django</code>文件夹的解释</h4>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617203001706.png" alt="image-20240617203001706"></p>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617203013755.png" alt="image-20240617203013755"></p>
<ul>
<li>用<code>pycharm</code>软件打开创建好的文件夹，新窗口打开</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617115555576-17186276759811.png" alt="image-20240617115555576"></p>
<h4 id="3-APP-应用">(3)APP(应用)</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Django框架就相当于一个大�? 大学</span><br><span class="line">在大学里面开设很多个专业  养猪</span><br><span class="line">专业下面又有很多单位和相应功�?老师 学生</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Django框架 电商平台的后�?</span><br><span class="line">商品业务 商品信息 添加商品 删除商品 修改商品 ...</span><br><span class="line">订单业务 订单信息 支付订单 订单超时 ...</span><br><span class="line">用户业务 用户自己的数据库信息 登陆/ 注册 / 下单 ...</span><br></pre></td></tr></table></figure>
<ul>
<li><code>cd</code>到你创建好的<code>django</code>文件夹里，首先你要在这个文件夹的终端里面</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd fisrt_django</span><br><span class="line"></span><br><span class="line">python manage.py startapp app名字</span><br><span class="line"></span><br><span class="line">python manage.py startapp user</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617204447523.png" alt="image-20240617204447523"></p>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617120247458.png" alt="image-20240617120247458"></p>
<h4 id="�-）启动Django项目">�?）启动Django项目</h4>
<ul>
<li>前提是你要确保你在创建好的django文件夹下</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617204857698.png" alt="image-20240617204857698"></p>
<ul>
<li>代表启动成功</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617204847771.png" alt="image-20240617204847771"></p>
<h4 id="�-）指定IP和端�">�?）指定IP和端�?</h4>
<ul>
<li>直接指定端口</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python manage.py runserver 127.0.0.1:9000</span><br></pre></td></tr></table></figure>
<h3 id="�-】通过pycharm创建">�?】通过pycharm创建</h3>
<h4 id="�-）创建项�">�?）创建项�?</h4>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617120941219.png" alt="image-20240617120941219"></p>
<ul>
<li>创建成功</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617205859056.png" alt="image-20240617205859056"></p>
<h4 id="2-创建APP">(2)创建APP</h4>
<ul>
<li>直接用命令行创建</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617210045846.png" alt="image-20240617210045846"></p>
<ul>
<li>方式�?</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617210206964.png" alt="image-20240617210206964"></p>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617210239974.png" alt="image-20240617210239974"></p>
<h4 id="�-）指定启动IP">�?）指定启动IP</h4>
<ul>
<li>打开�?</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617210750051.png" alt="image-20240617210750051"></p>
<ul>
<li>输入ip</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240617121427129.png" alt="image-20240617121427129"></p>
<h4 id="�-）两个错�">�?）两个错�?</h4>
<ul>
<li>一个是没有启动Django支持</li>
<li>一个是没有选择Django项目根路径及配置文件</li>
</ul>
<h3 id="�-】注册APP使用APP">�?】注册<code>APP</code>使用<code>APP</code></h3>
<h4 id="�-）注册APP">�?）注册<code>APP</code></h4>
<ul>
<li><code>settings.py</code>
<ul>
<li>在<code>pycharm</code>里面创建的<code>app</code>自动注册<code>app</code></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">INSTALLED_APPS = [</span><br><span class="line">    <span class="string">&#x27;django.contrib.admin&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.auth&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.contenttypes&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.sessions&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.messages&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;django.contrib.staticfiles&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;user1.apps.User1Config&quot;</span></span><br><span class="line">    <span class="comment"># 必须注册app才能使用app</span></span><br><span class="line">    <span class="string">&#x27;user&#x27;</span></span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="2-使用app">(2)使用app</h4>
<ul>
<li>第一�?前提是注册appl�?</li>
<li>第二�?定义视图函数user/views.py
<ul>
<li>视图函数必须有一个位置参数交repuest</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create your views here.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个视图函�?必须有一个位置参�?</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login</span>(<span class="params">request</span>):</span><br><span class="line"></span><br><span class="line">    <span class="comment"># render 渲染前端页面的语�?</span></span><br><span class="line">    <span class="comment"># 前端文件名必须在 templates 文件夹下</span></span><br><span class="line">    <span class="comment"># 返回的是一�?HTML 页面</span></span><br><span class="line">    <span class="keyword">return</span> render(request,<span class="string">&quot;login.html&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>第三�?要在路由映射关系 <code>first_django/urls.py</code> 注册映射关系</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.contrib <span class="keyword">import</span> admin</span><br><span class="line"><span class="keyword">from</span> django.urls <span class="keyword">import</span> path</span><br><span class="line"><span class="keyword">from</span> user.views <span class="keyword">import</span> login</span><br><span class="line"></span><br><span class="line">urlpatterns = [</span><br><span class="line">    path(<span class="string">&#x27;admin/&#x27;</span>, admin.site.urls),</span><br><span class="line">    <span class="comment"># 默认访问根目录的时�?会执�?login 视图函数返回数据</span></span><br><span class="line">    path(<span class="string">&#x27;&#x27;</span>, login),</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<ul>
<li>启动项目 访问指定的路�</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/21/">21</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">坤</p>
  <div class="site-description" itemprop="description">选择有时候比努力更重要，但是你不努力，选择就只是空谈</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">201</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">坤</span>
</div>
  <div class="powered-by">由 <a href="https://github.com/lsk-0912" class="theme-link" rel="noopener" target="_blank">lsk-0912</a> & <a href="https://github.com/lsk-0912" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
