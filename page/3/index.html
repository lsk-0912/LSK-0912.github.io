<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 8.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"aurora-lsk.asia","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
<meta property="og:type" content="website">
<meta property="og:title" content="坤博客">
<meta property="og:url" content="https://aurora-lsk.asia/page/3/index.html">
<meta property="og:site_name" content="坤博客">
<meta property="og:description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="坤">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://aurora-lsk.asia/page/3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>坤博客</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">坤博客</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.3%E7%BB%88%E7%AB%AF%E8%BD%AF%E4%BB%B6Tabby/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.3%E7%BB%88%E7%AB%AF%E8%BD%AF%E4%BB%B6Tabby/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Tabby</h1>
<h2 id="【一】Tabby介绍">【一】Tabby介绍</h2>
<p>●与Bash相同的行编辑（来自<a target="_blank" rel="noopener" href="https://www.yuque.com/yichufanhuayiyejian/cd14nq/_tiswww.case.edu_php_chet_readline_rltop">GNU Readline库</a>版本8.1）。</p>
<p>●会话之间的历史记录持久性。</p>
<p>●上下文相关完成;</p>
<p>○可执行文件（和别名）。</p>
<p>○目录命令。</p>
<p>○环境变量。</p>
<p>●上下文相关的彩色输入文本。</p>
<p>●来自历史记录和完成的自动建议。</p>
<p>●新的键盘快捷键;</p>
<p>○交互式完成列表 （+）。CtrlSpace</p>
<p>○增量历史记录搜索（+和+）。CtrlRCtrlS</p>
<p>○强大的完成 （）。Tab</p>
<p>○撤消 （+）。CtrlZ</p>
<p>○环境变量扩展 （++）。CtrlAltE</p>
<p>○Doskey 别名扩展 （++）。CtrlAltF</p>
<p>○滚动屏幕缓冲区 （+等）。AltUp</p>
<p>○Shift+箭头键选择文本，键入替换所选文本等。</p>
<p>○（按 + 查看更多…AltH</p>
<p>●目录快捷方式;</p>
<p>○键入目录名称后跟路径分隔符是该目录的快捷方式。cd /d</p>
<p>○键入 or 是 or 的快捷方式（每增加一个 ）。…<code>...</code>cd …<code>cd ..\..</code>.``..</p>
<p>○键入或更改以前的当前工作目录。-``cd -</p>
<p>●带有Lua的脚本化自动建议。</p>
<p>●使用 Lua 完成脚本化。</p>
<p>●使用 Lua 的可脚本化键绑定。</p>
<p>●彩色和可编写脚本的提示。</p>
<p>●自动应答“终止批处理作业？”提示。</p>
<p>默认情况下，Clink 绑定 + 以显示当前的键绑定。更多的功能也可以在GNU的<a target="_blank" rel="noopener" href="https://www.yuque.com/yichufanhuayiyejian/cd14nq/_tiswww.cwru.edu_php_chet_readline_readline">Readline</a>中找到。AltH</p>
<h2 id="【二】下载">【二】下载</h2>
<p>●访问可能会有点慢，自己解决</p>
<h3 id="【1】官网">【1】官网</h3>
<p>●官网：<a target="_blank" rel="noopener" href="https://tabby.sh/">https://tabby.sh/</a></p>
<p>●Github链接：<a target="_blank" rel="noopener" href="https://github.com/eugeny/tabby">https://github.com/eugeny/tabby</a></p>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C85df55c1-0af3-482c-8897-29afcb59f0b0.png" alt=""></p>
<h3 id="【2】下载">【2】下载</h3>
<ul>
<li>下载链接：<a target="_blank" rel="noopener" href="https://github.com/Eugeny/tabby/releases/tag/v1.0.205">https://github.com/Eugeny/tabby/releases/tag/v1.0.205</a></li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Ce9ec1043-5104-4931-895d-e42d085907fa.png" alt=""></p>
<ul>
<li>百度盘链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1XwEfhnLo-6_TM9UqsInyQA?pwd=jnuf">https://pan.baidu.com/s/1XwEfhnLo-6_TM9UqsInyQA?pwd=jnuf</a></li>
</ul>
<h2 id="【三】安装">【三】安装</h2>
<h3 id="【1】双击安装程序">【1】双击安装程序</h3>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Ce9fe1491-9fc9-4d0c-8274-378e79a40849.png" alt=""></p>
<h3 id="【2】为所有用户安装">【2】为所有用户安装</h3>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C4fa6f768-6bcd-4d5b-baac-12f5d4445386.png" alt=""></p>
<h3 id="【3】选择安装位置">【3】选择安装位置</h3>
<h3 id="【4】安装成功">【4】安装成功</h3>
<h2 id="【四】使用">【四】使用</h2>
<h3 id="【1】软件主界面">【1】软件主界面</h3>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C44290f54-e3c2-4440-827d-4afa2b5d8095.png" alt=""></p>
<h3 id="【2】设置语言">【2】设置语言</h3>
<h4 id="（1）开始界面">（1）开始界面</h4>
<ul>
<li>可以在开始界面选择自己想要的语言版本</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C1c2f6c25-8d5c-40fa-add2-066e18633475.png" alt=""></p>
<h4 id="（2）设置">（2）设置</h4>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Ce3ecfdc1-f076-4103-81f8-40c7c5426930.png" alt="e3ecfdc1-f076-4103-81f8-40c7c5426930"></p>
<h3 id="【3】连接服务器">【3】连接服务器</h3>
<h4 id="（1）选择管理配置">（1）选择管理配置</h4>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C4c09cc27-5861-495d-88af-0c1b52734eb3.png" alt="4c09cc27-5861-495d-88af-0c1b52734eb3"></p>
<h4 id="（2）设置新配置">（2）设置新配置</h4>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C4fcbceec-c4a4-466f-8168-74d4b8dd8285-17171595192393.png" alt="4fcbceec-c4a4-466f-8168-74d4b8dd8285"></p>
<h4 id="（3）选择SSH会话">（3）选择SSH会话</h4>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cacaaf924-1607-40d8-af86-470a49eeae0b-17171593908241.png" alt="acaaf924-1607-40d8-af86-470a49eeae0b"></p>
<h4 id="（4）输入自己的服务器信息">（4）输入自己的服务器信息</h4>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C6697ab15-6f56-455c-bdff-8a94ed4f2443.png" alt="6697ab15-6f56-455c-bdff-8a94ed4f2443"></p>
<h4 id="（5）连接成功">（5）连接成功</h4>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.4TCP%E4%BA%94%E5%B1%82%E5%8D%8F%E8%AE%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.4TCP%E4%BA%94%E5%B1%82%E5%8D%8F%E8%AE%AE/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>TCP五层协议</h1>
<h2 id="【一】物理层">【一】物理层</h2>
<h3 id="（1）物理层由来">（1）物理层由来</h3>
<ul>
<li>上面提到，孤立的计算机之间要想一起玩，就必须接入<code>internet</code>，言外之意就是计算机之间必须完成组网</li>
</ul>
<h3 id="（2）物理层功能">（2）物理层功能</h3>
<ul>
<li>主要是基于电器特性发送高低电压（电信号），高电压对应数字1，低电压对应数字0</li>
</ul>
<h2 id="【二】数据链路层">【二】数据链路层</h2>
<h3 id="（1）数据链路层的由来">（1）数据链路层的由来</h3>
<ul>
<li>单纯的电信号0和1没有任何意义，必须规定电信号多少位一组，每组什么意思</li>
</ul>
<h3 id="（2）数据链路层的功能">（2）数据链路层的功能</h3>
<ul>
<li>定义了电信号的分组形式</li>
</ul>
<h3 id="（3）补充">（3）补充</h3>
<h4 id="【1】以太网协议">【1】以太网协议</h4>
<ul>
<li>早期各个公司都有自己的分组方式，后来形成了统一的标准，叫<strong>以太网协议（<code>ethernet</code>）</strong></li>
<li><code>ethernet</code>规定
<ul>
<li>一组电信号构成一个数据包，叫做“帧”</li>
<li>每一数据帧分成：报头head和数据data两部分
<ul>
<li><code>head：Head</code>方法常用于检查资源是否存在、检查资源的更新情况或获取HTTP响应的头部信息等场景。</li>
</ul>
</li>
</ul>
</li>
<li><code>head</code>包含（固定18个字节）：
<ul>
<li>字节就是：计算机信息技术中用于计量存储容量的一种计量单位</li>
<li>发送者/源地址：6个字节</li>
<li>接收者/目标地址：6个字节</li>
<li>数据类型，6个字节</li>
</ul>
</li>
<li>data包含（最短46字节，最长1500字节）：
<ul>
<li>数据包的具体内容</li>
</ul>
</li>
<li>head长度+data长度=最短64字节，最长1518字节，超过最大限制就分片发送</li>
</ul>
<h4 id="2-mac地址">[2]mac地址</h4>
<ul>
<li>head中包含的源和目标地址由来：<code>ethernet</code>规定接入<code>internet</code>的设备都必须具备网卡，发送端和接收端的地址便是指网卡的地址，即mac地址</li>
<li>mac地址：每块网卡出厂时都被烧制上一个世界唯一的mac地址，长度为48位二进制，通常由12位16进制数表示（<strong>前六位是厂商编号，后六位是流水线号</strong>）
<ul>
<li>ether <code>00：16：3e：1a：83：a0</code></li>
</ul>
</li>
</ul>
<h4 id="3-广播">[3]广播</h4>
<ul>
<li>有了mac地址，同一网络内的两台主机就可以通信了（一台主机通过<code>arp</code>协议获取另外一台主机的mac地址）</li>
<li><code>ethernet</code>采用最原始的方式，广播的方式进行通信，即计算机通信基本靠吼</li>
</ul>
<h2 id="【三】网络层">【三】网络层</h2>
<h3 id="（1）网络层的由来">（1）网络层的由来</h3>
<ul>
<li>有了<code>ethernet</code>、mac地址、广播的发送方式，世界上的计算机就可以通信了</li>
<li>问题是世界范围的互联网是由一个个彼此隔离的小的局域网组成的，那么如果所有的通信都采用以太网的广播方式，那么一台机器发送的包全世界都会收到</li>
<li>这将会是一场灾难，不仅仅是效率低</li>
<li>必须找出一种方法来区分哪些计算机属于同一广播域，哪些不是，如果是就采用广播的方式发送</li>
<li>如果不是，就采用路由的方式（向不同广播域／子网分发数据包），mac地址是无法区分的，它只跟厂商有关</li>
</ul>
<h3 id="（2）网络层功能">（2）网络层功能</h3>
<ul>
<li>网络地址：引入一套新的地址用来区分不同的广播域/子网，这套地址就叫网络地址。</li>
</ul>
<h3 id="（3）补充-2">（3）补充</h3>
<h4 id="【1】网络知识补充">【1】网络知识补充</h4>
<h5 id="（1）什么是互联网">（1）什么是互联网</h5>
<ul>
<li>将计算机连接起来的介质</li>
<li>互联网是一种全球性的计算机网络，通过将数十亿台设备、网络、数据中心互相连接的方式实现信息共享</li>
</ul>
<h5 id="（2）互联网建立的目的">（2）互联网建立的目的</h5>
<ul>
<li>方便大家在全球范围内进行信息交互和数据交换</li>
<li>基于互联网的数据交互可以使用户在任何时间，任何地点获取所需的信息和服务，大大提高了信息传递的速度和效率</li>
<li>就是基于互联网做数据交互或服务器进行通信。在这种通信中，用户可以通过发送请求来获取所需的资源，如网页内容、电子邮件、文件等，同时也可以向其他用户提供自己的资源。</li>
</ul>
<h4 id="（3）上网的本质">（3）上网的本质</h4>
<ul>
<li>基于网线去访问其它计算机的资源</li>
<li>我们的计算机也可以称之为服务器/服务端（专门对外提供服务）</li>
</ul>
<h4 id="【2】ip">【2】<code>ip</code></h4>
<h5 id="【1】ip协议">【1】<code>ip</code>协议</h5>
<ul>
<li>规定网络地址的协议叫做<code>ip</code>协议，它定义的地址称之为<code>ip</code>地址，广泛采用的<code>v4</code>版本即<code>ipv4</code>，它规定网络地址由32位2进制表示</li>
<li>ip的范围：0.0.0.0-255.255.255.255</li>
<li>一个<code>ip</code>地址通常写成四段十进制数
<ul>
<li>172.16.10.1</li>
</ul>
</li>
</ul>
<h5 id="【2】ip地址分成两部分">【2】<code>ip</code>地址分成两部分</h5>
<ul>
<li>网络部分：标识子网</li>
<li>主机部分：标识主机</li>
<li>**：单纯的<code>ip</code>地址段只是标识了<code>ip</code>地址的种类，从网络部分或主机部分都无法辨识一个<code>ip</code>所处的子网
<ul>
<li>172.16.10.1与172.16.10.2并<strong>不能确定二者处于同一子网</strong></li>
</ul>
</li>
</ul>
<h5 id="【3】子网掩码">【3】子网掩码</h5>
<ul>
<li>
<p>所谓”子网掩码”，就是表示子网络特征的一个参数。</p>
</li>
<li>
<p>它在形式上等同于IP地址，也是一个32位二进制数字，它的网络部分全部为1，主机部分全部为0。</p>
<p>○比如，IP地址172.16.10.1，如果已知网络部分是前24位，主机部分是后8位</p>
<p>○那么子网络掩码就是11111111.11111111.11111111.00000000</p>
<p>○写成十进制就是255.255.255.0。</p>
<p>●知道”子网掩码”，我们就能判断，任意两个<code>IP</code>地址是否处在同一个子网络。</p>
<p>○方法是将两个<code>IP</code>地址与子网掩码分别进行AND运算（两个数位都为1，运算结果为1，否则为0），然后比较结果是否相同</p>
<p>○如果是的话，就表明它们在同一个子网络中，否则就不是。</p>
<p>●比如，已知<code>IP</code>地址172.16.10.1和172.16.10.2的子网掩码都是255.255.255.0，请问它们是否在同一个子网络？两者与子网掩码分别进行AND运算，</p>
<p>○<code>172.16.10.1：10101100.00010000.00001010.000000001</code></p>
<p>○<code>255255.255.255.0:11111111.11111111.11111111.00000000</code></p>
<p>●AND运算得网络地址结果：<code>10101100.00010000.00001010.000000001-&gt;172.16.10.0</code></p>
<p>○<code>172.16.10.2：10101100.00010000.00001010.000000010</code></p>
<p>○<code>255255.255.255.0:11111111.11111111.11111111.00000000</code></p>
<p>●AND运算得网络地址结果：10101100.00010000.00001010.000000001-&gt;172.16.10.0</p>
<p>●结果都是172.16.10.0，因此它们在同一个子网络。</p>
</li>
<li>
<p>****:<strong><code>ip</code>协议的作用主要有两个，一个是为每一台计算机分配IP地址，另一个是确定哪些地址在同一个子网络。</strong></p>
</li>
</ul>
<h5 id="【4】ip数据包">【4】<code>ip</code>数据包</h5>
<ul>
<li>
<p>ip数据包也分为head和data部分，无须为ip包定义单独的栏位，直接放入以太网包的data部分</p>
<ul>
<li>
<p>head：长度为20到60字节</p>
</li>
<li>
<p>data：最长为65,515字节。</p>
</li>
</ul>
</li>
<li>
<p>而以太网数据包的”数据”部分，最长只有1500字节。</p>
</li>
<li>
<p>因此，如果IP数据包超过了1500字节，它就需要分割成几个以太网数据包，分开发送了。</p>
</li>
</ul>
<table>
<thead>
<tr>
<th>以太网头</th>
<th>ip 头</th>
<th>ip数据</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h5 id="【5】ARP协议">【5】ARP协议</h5>
<ul>
<li>
<p>arp协议由来：计算机通信基本靠吼，即广播的方式，所有上层的包到最后都要封装上以太网头，然后通过以太网协议发送，在谈及以太网协议时候，我们了解到通信是基于mac的广播方式实现，计算机在发包时，获取自身的mac是容易的，如何获取目标主机的mac，就需要通过arp协议</p>
</li>
<li>
<p>arp协议功能：广播的方式发送数据包，获取目标主机的mac地址</p>
</li>
<li>
<p>协议工作方式：每台主机ip都是已知的</p>
<ul>
<li>例如：主机172.16.10.10/24访问172.16.10.11/24</li>
<li>一：首先通过ip地址和子网掩码区分出自己所处的子网</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>场景</th>
<th>数据包地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>同一子网</td>
<td>目标主机mac，目标主机ip</td>
</tr>
<tr>
<td>不同子网</td>
<td>网关mac，目标主机ip</td>
</tr>
</tbody>
</table>
<ul>
<li>二：分析172.16.10.10/24与172.16.10.11/24处于同一网络(如果不是同一网络，那么下表中目标ip为172.16.10.1,通过arp获取的是网关的mac)</li>
</ul>
<table>
<thead>
<tr>
<th></th>
<th>源mac</th>
<th>目标mac</th>
<th>源ip</th>
<th>目标ip</th>
<th>数据部分</th>
</tr>
</thead>
<tbody>
<tr>
<td>发送端主机</td>
<td>发送端mac</td>
<td>FF:FF:FF:FF:FF:FF</td>
<td>172.16.10.10/24</td>
<td>172.16.10.11/24</td>
<td>数据</td>
</tr>
</tbody>
</table>
<ul>
<li>三：这个包会以广播的方式在发送端所处的自网内传输，所有主机接收后拆开包，发现目标ip为自己的，就响应，返回自己的mac</li>
</ul>
<h2 id="【四】传输层">【四】传输层</h2>
<h3 id="（1）传输层的由来">（1）传输层的由来</h3>
<ul>
<li>网络层的ip帮我们区分子网，以太网层的mac帮我们找到主机，然后大家使用的都是应用程序，你的电脑上可能同时开启qq，暴风影音，等多个应用程序，</li>
<li>那么我们通过ip和mac找到了一台特定的主机，如何标识这台主机上的应用程序，答案就是端口，<strong>端口即应用程序与网卡关联的编号</strong>。</li>
</ul>
<h3 id="（2）传输层功能">（2）传输层功能</h3>
<ul>
<li>建立端口到端口的通信</li>
<li>补充：端口范围0-65535，0-1023为系统占用端口</li>
</ul>
<h3 id="（3）tcp协议与adp协议">（3）tcp协议与adp协议</h3>
<h4 id="【1】tcp协议">【1】tcp协议</h4>
<ul>
<li>可靠传输，TCP数据包没有长度限制，理论上<strong>可以无限长</strong></li>
<li>但是为了保证网络的效率，通常<strong>TCP数据包的长度不会超过IP数据包的长度</strong>，以确保单个TCP数据包不必再分割。</li>
</ul>
<table>
<thead>
<tr>
<th>以太网头</th>
<th>ip 头</th>
<th>tcp头</th>
<th>数据</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ul>
<li>tcp报文</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5C7fcb3a52-ff09-4bbe-9e3d-c6678db563ea.png" alt=""></p>
<ul>
<li>tcp三次握手和四次挥手</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cd0d84b41-e43c-4254-a62a-b7dd8a61d75a.png" alt=""></p>
<h4 id="【2】udp协议">【2】udp协议</h4>
<ul>
<li>不可靠传输，”报头”部分一共只有8个字节，总长度不超过65,535字节，正好放进一个IP数据包。</li>
</ul>
<table>
<thead>
<tr>
<th>以太网头</th>
<th>ip头</th>
<th>udp头</th>
<th>数据</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h2 id="【五】应用层">【五】应用层</h2>
<h3 id="（1）应用层的由来">（1）应用层的由来</h3>
<ul>
<li>用户使用的都是应用程序，均工作于应用层，互联网是开发的，大家都可以开发自己的应用程序，数据多种多样，必须规定好数据的组织形式</li>
</ul>
<h3 id="（2）应用层功能">（2）应用层功能</h3>
<ul>
<li>规定应用层的数据格式</li>
<li>例：TCP协议可以为各种各样的程序传递数据</li>
<li>比如Email、WWW、FTP等等。</li>
<li>那么，必须有不同协议规定电子邮件、网页、FTP数据的格式，这些应用程序协议就构成了”应用层”。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.5%20%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.5%20%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E8%AF%AD%E5%8F%A5/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>【一】流程控制语句</h1>
<ul>
<li>用来控制程序执行的条件</li>
<li>控制条件的方式有很多</li>
<li>流程结构：
<ul>
<li>顺序结构(依次乡下执行)</li>
<li>分支结构(相当于给了两个条件来进行判断)</li>
<li>循环结构(直到条件为否才结束当前循环)</li>
</ul>
</li>
</ul>
<h2 id="【1】顺序结构">【1】顺序结构</h2>
<ul>
<li>程序按照顺序依次执行，直到报错或者程序条件为否的情况才会终</li>
<li>按照程序顺序从上依次向下逐行执行</li>
</ul>
<p><img src="C:%5CUsers%5C86177%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240330112840643.png" alt="image-20240330112840643"></p>
<ul>
<li>顺序结构用于按照既定的顺序执行一系列的操作，这是程序执行的最基本模式。</li>
<li>通过良好的顺序结构，可以清晰地表达程序的逻辑流程，使代码易读易懂。</li>
<li>这有助于开发者理解和维护代码，也方便调试。</li>
</ul>
<h2 id="【2】分支结构">【2】分支结构</h2>
<ul>
<li>分支结构是计算机程序中的一种控制结构，它根据条件的成立与否选择性地执行不同的代码块。</li>
<li>在分支结构中，根据条件的判断结果，程序会有不同的执行路径。</li>
</ul>
<h3 id="（1）分支结构的作用">（1）分支结构的作用</h3>
<ul>
<li>分支结构的主要作用是根据不同的条件执行不同的代码，从而实现灵活的程序逻辑。</li>
<li>通过分支结构，程序可以根据用户的输入、计算的结果等情况来选择执行不同的代码块，增加程序的智能性和适应性。</li>
</ul>
<h3 id="（2）单分支结构（if）">（2）单分支结构（if）</h3>
<ul>
<li>单分支条件指的是程序根据条件的成立与否，执行两个分支中的一个。</li>
<li>常见的单分支语法是if</li>
</ul>
<p><img src="C:%5CUsers%5C86177%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240330114936778.png" alt="image-20240330114936778"></p>
<h4 id="1-语法">{1}语法</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件：</span><br><span class="line">    前面空四个空格<span class="comment">#如果条件成立执行这里的代码体。</span></span><br><span class="line">    </span><br><span class="line">例子：</span><br><span class="line">age = <span class="number">18</span></span><br><span class="line"><span class="keyword">if</span> age &gt;= <span class="number">18</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;你已成年，可以参加投票。&quot;</span>)<span class="comment">#你已成年，可以参加投票。</span></span><br><span class="line">    </span><br><span class="line">例子：</span><br><span class="line">score = <span class="number">99</span></span><br><span class="line"><span class="keyword">if</span> score &gt; <span class="number">90</span>:</span><br><span class="line">    <span class="comment"># 这里面的代码我们称之为代码体/代码块</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;当前成绩为 <span class="subst">&#123;score&#125;</span> ， 评级为优秀!&quot;</span>)<span class="comment">#如果成绩在90分以上，执行这里的代码块 #&#123;当前成绩为 99 ， 评级为优秀!&#125;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;当前成绩<span class="subst">&#123;score&#125;</span>不合格&quot;</span>)<span class="comment">#如果成绩在90分以下包括90分，执行这个代码块 #&#123;当前成绩90不合格&#125;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>单分支结构会依次向下执行代码，并且在遇到条件时进行判断，如果条件为真则执行当前代码体</li>
</ul>
<h4 id="2-补充">{2}补充</h4>
<ul>
<li>Python用相同缩进(4个空格表示一个缩进)来标识一组代码块，同一组代码会自上而下依次运行</li>
<li>条件可以是任意表达式，但执行结果<strong>必须为布尔类型</strong></li>
<li>在if判断中所有的数据类型也都会自动转换成布尔类型
<ul>
<li>None，0，空（空字符串，空列表，空字典等）三种情况下转换成的布尔值为False</li>
<li>其余均为True</li>
</ul>
</li>
</ul>
<h3 id="【3】双分支结构（if-else）">【3】双分支结构（if-else）</h3>
<ul>
<li>双分支结构也是根据条件的成立与否，选择性地执行不同的代码块。</li>
<li>与单分支结构不同的是，双分支结构<strong>有两个分支</strong>，分别对应条件成立和条件不成立的情况。</li>
</ul>
<p><img src="C:%5CUsers%5C86177%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240330120403185.png" alt="image-20240330120403185"></p>
<h4 id="1-语法-2">{1}语法</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件:</span><br><span class="line">    <span class="comment"># 如果条件成立，执行这里的代码块</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 如果条件不成立，执行这里的代码块</span></span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">age = <span class="number">16</span></span><br><span class="line"><span class="keyword">if</span> age &gt;= <span class="number">18</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;你已成年，可以参加投票。&quot;</span>) <span class="comment">#age大于等于18的时候，执行这里的代码块 #你已成年，可以参加投票。</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;你还未成年，不能参加投票。&quot;</span>) <span class="comment">#age小于18的时候，执行这里的代码块 #你还未成年，不能参加投票。</span></span><br></pre></td></tr></table></figure>
<h3 id="【4】多分支结构（if-elif-else）">【4】多分支结构（if-elif-else）</h3>
<ul>
<li>多分支结构是在双分支结构的基础上扩展，<strong>它包含多个分支</strong>，每个分支都对应<strong>不同的条件。</strong></li>
<li>程序根据条件的成立情况选择性地执行相应的代码块。</li>
</ul>
<p><img src="C:%5CUsers%5C86177%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240330123818246.png" alt="image-20240330123818246"></p>
<h4 id="1-语法-3">{1}语法</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> 条件<span class="number">1</span>:</span><br><span class="line">    <span class="comment"># 如果条件1成立，执行这里的代码块</span></span><br><span class="line"><span class="keyword">elif</span> 条件<span class="number">2</span>:</span><br><span class="line">    <span class="comment"># 如果条件1不成立且条件2成立，执行这里的代码块</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="comment"># 如果条件1和条件2都不成立，执行这里的代码块</span></span><br><span class="line">    </span><br><span class="line">例子：</span><br><span class="line">score = <span class="number">85</span></span><br><span class="line"><span class="keyword">if</span> score &gt;= <span class="number">90</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;优秀&quot;</span>) <span class="comment">#score大于等于90的时候执行这个代码体#优秀</span></span><br><span class="line"><span class="keyword">elif</span> score &gt;= <span class="number">80</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;良好&quot;</span>) <span class="comment">#score大于等于80的时候执行这个代码体#良好</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;一般&quot;</span>)<span class="comment">#低于80执行这个代码体#一般</span></span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">score = <span class="number">70</span></span><br><span class="line"><span class="keyword">if</span> score &gt;= <span class="number">90</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;优秀&quot;</span>)  <span class="comment"># score大于等于90的时候执行这个代码体#优秀</span></span><br><span class="line"><span class="keyword">elif</span> score &gt;= <span class="number">80</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;良好&quot;</span>)  <span class="comment"># score大于等于80的时候执行这个代码体#良好</span></span><br><span class="line"><span class="keyword">elif</span> score &gt;= <span class="number">60</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;一般&quot;</span>)  <span class="comment"># score大于等于60的时候执行这个代码块#一般</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;不及格&quot;</span>)  <span class="comment"># 低于60执行这个代码块#不及格</span></span><br></pre></td></tr></table></figure>
<h3 id="【5】多层嵌套结构">【5】多层嵌套结构</h3>
<ul>
<li>多层嵌套结构是将多个分支结构嵌套在一起形成的复杂结构。</li>
<li>每一层的分支结构都可以根据不同的条件进行选择性的执行。</li>
<li>多层嵌套结构的使用需要注意代码的可读性和维护性。</li>
</ul>
<h3 id="1-语法-4">{1}语法</h3>
<ul>
<li>
<p>多层嵌套结构是通过在不同层次上使用if语句嵌套形成的结构。</p>
</li>
<li>
<p>多层嵌套结构可以根据多个条件的组合选择性地执行代码块。</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">height = <span class="number">181</span></span><br><span class="line"><span class="keyword">if</span> height &gt;= <span class="number">170</span>:</span><br><span class="line">    <span class="keyword">if</span> height &lt;= <span class="number">180</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;身高在170~180之间&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;身高大于180&quot;</span>)<span class="comment">#身高高于180</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;身高太低&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">例题：</span><br><span class="line"><span class="comment">#前提：创建一个字典存了用户的用户名和密码</span></span><br><span class="line"><span class="comment"># 有一个输入框输入用户名和密码</span></span><br><span class="line"><span class="comment"># 有了用户名以后去去字典中查密码</span></span><br><span class="line"><span class="comment"># 有了用户名但是字典中不存在的情况，打印当前用户名不存在</span></span><br><span class="line"><span class="comment"># 将字典中的密码和输入的密码进行比对</span></span><br><span class="line"><span class="comment"># 一致打印登陆成功</span></span><br><span class="line"><span class="comment"># 否则提示登录失败</span></span><br><span class="line"></span><br><span class="line">info = &#123;<span class="string">&quot;dream&quot;</span>: <span class="string">&quot;1314&quot;</span>&#125;</span><br><span class="line">username = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：&gt;&gt;&gt;&gt;&quot;</span>)</span><br><span class="line">password = <span class="built_in">input</span>(<span class="string">&quot;请输入密码:&gt;&gt;&gt;&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> username <span class="keyword">not</span> <span class="keyword">in</span> info:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;用户名<span class="subst">&#123;username&#125;</span>不存在&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> password == info.get(username):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;密码正确&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;密码错误&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="【3】循环结构">【3】循环结构</h2>
<h3 id="（1）什么是分支结构">（1）什么是分支结构</h3>
<ul>
<li>循环结构是一种程序控制结构，用于反复执行一组语句，直到满足某个条件为止。</li>
<li>循环结构使得程序可以更有效地重复执行某段代码，节省了编写重复代码的工作。</li>
</ul>
<p><img src="C:%5CUsers%5C86177%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20240330134120998.png" alt="image-20240330134120998"></p>
<h3 id="（2）循环结构的作用">（2）循环结构的作用</h3>
<ul>
<li>循环结构的主要作用是重复执行一组语句，直到满足某个条件。</li>
<li>这种重复执行的过程可以是固定次数的，也可以是根据条件动态确定的。</li>
<li>循环结构使得程序可以更灵活、高效地处理需要重复执行的任务。</li>
</ul>
<h3 id="（3）while循环">（3）while循环</h3>
<h4 id="1-语法-5">(1)语法</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> condition:</span><br><span class="line">    <span class="comment"># 循环体</span></span><br></pre></td></tr></table></figure>
<ul>
<li>while是循环的关键字。</li>
<li>condition是循环条件，当条件为真时，循环体会一直执行。</li>
<li>循环体是重复执行的代码块。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">列子：</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">5</span>:</span><br><span class="line">    <span class="built_in">print</span>( count)</span><br><span class="line">    count +=<span class="number">1</span></span><br><span class="line">结果是：</span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">2</span></span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="number">4</span></span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">5</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;number:&quot;</span>, count)</span><br><span class="line">    count +=<span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Loop finished!&quot;</span>)</span><br><span class="line">结果是：</span><br><span class="line">number: <span class="number">0</span></span><br><span class="line">number: <span class="number">1</span></span><br><span class="line">number: <span class="number">2</span></span><br><span class="line">number: <span class="number">3</span></span><br><span class="line">number: <span class="number">4</span></span><br><span class="line">Loop finished!</span><br></pre></td></tr></table></figure>
<h4 id="（2）登入认证案例">（2）登入认证案例</h4>
<ul>
<li>用户认证程序的基本逻辑就是接收用户输入的用户名密码然后与程序中存放的用户名密码进行判断，判断成功则登陆成功，判断失败则输出账号或密码错误</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">username = <span class="string">&quot;Tom&quot;</span></span><br><span class="line">password = <span class="string">&quot;710&quot;</span></span><br><span class="line">user_name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：》》》&quot;</span>)</span><br><span class="line">pass_word = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：》》》》&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> user_name == username <span class="keyword">and</span> pass_word == password:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码正确&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码错误&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>通常认证失败的情况下，会要求用户重新输入用户名和密码进行验证</li>
<li>如果我们想给用户三次试错机会，本质就是将上述代码重复运行三遍</li>
<li>你总不会想着把代码复制3次吧</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">复杂方法</span><br><span class="line">username = <span class="string">&quot;Tom&quot;</span></span><br><span class="line">password = <span class="string">&quot;710&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#第一次验证</span></span><br><span class="line">user_name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：》》》&quot;</span>)</span><br><span class="line">pass_word = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：》》》》&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> user_name == username <span class="keyword">and</span> pass_word == password:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码正确&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码错误&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment">#第二次验证</span></span><br><span class="line">user_name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：》》》&quot;</span>)</span><br><span class="line">pass_word = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：》》》》&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> user_name == username <span class="keyword">and</span> pass_word == password:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码正确&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码错误&quot;</span>)</span><br><span class="line">   </span><br><span class="line"><span class="comment">#第三次验证</span></span><br><span class="line">user_name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：》》》&quot;</span>)</span><br><span class="line">pass_word = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：》》》》&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> user_name == username <span class="keyword">and</span> pass_word == password:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码正确&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;密码错误&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>上面的方法太麻烦</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">username = <span class="string">&quot;Tom&quot;</span></span><br><span class="line">password = <span class="string">&quot;710&quot;</span></span><br><span class="line">count=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt;<span class="number">3</span>:</span><br><span class="line">    user_name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：》》》&quot;</span>)</span><br><span class="line">    pass_word = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：》》》》&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> user_name == username <span class="keyword">and</span> pass_word == password:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;密码正确&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;密码错误&quot;</span>)</span><br><span class="line">        count +=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="4-for循环">(4)for循环</h2>
<h3 id="（1）语法">（1）语法</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> variable <span class="keyword">in</span> sequence:</span><br><span class="line">    <span class="comment">#循环体</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> 是循环的关键字。</span><br><span class="line">variable是循环变量，它会在每次循环中取sequence中的一个值。</span><br><span class="line">senqence是一个序列，可以是列表、元组、字符串等。</span><br><span class="line"></span><br><span class="line">案例</span><br><span class="line"></span><br><span class="line">fruits = [<span class="string">&quot;apple&quot;</span>,<span class="string">&quot;banana&quot;</span>,<span class="string">&quot;cherry&quot;</span>]</span><br><span class="line"><span class="keyword">for</span> fruit <span class="keyword">in</span> fruits:</span><br><span class="line">    <span class="built_in">print</span>(fruit)</span><br><span class="line">输出结果</span><br><span class="line"><span class="comment"># apple</span></span><br><span class="line"><span class="comment"># banana</span></span><br><span class="line"><span class="comment"># cherry</span></span><br></pre></td></tr></table></figure>
<h2 id="（5）退出循环（break）">（5）退出循环（break）</h2>
<h3 id="（1）语法-2">（1）语法</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> condition:</span><br><span class="line">    <span class="comment">#循环体</span></span><br><span class="line">    <span class="keyword">if</span> some_condition:</span><br><span class="line">        <span class="keyword">break</span><span class="comment">#退出循环</span></span><br><span class="line">        </span><br><span class="line">例子</span><br><span class="line">oop = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> loop &lt;<span class="number">4</span>:</span><br><span class="line">    <span class="built_in">print</span>(loop)</span><br><span class="line">    <span class="keyword">if</span> loop == <span class="number">2</span>:</span><br><span class="line">        <span class="keyword">break</span><span class="comment">#当loop等于2是退出循环</span></span><br><span class="line">    loop +=<span class="number">1</span></span><br></pre></td></tr></table></figure>
<h3 id="（2）登入案例循环（while循环-break）">（2）登入案例循环（while循环-break）</h3>
<ul>
<li>使用了while循环后，代码确实精简多了</li>
<li>但问题是用户输入正确的用户名密码以后无法结束循环</li>
<li>那如何结束掉一个循环呢？
<ul>
<li>这就需要用到break了！</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">username = <span class="string">&quot;Tom&quot;</span></span><br><span class="line">password = <span class="string">&quot;710&quot;</span></span><br><span class="line">loop = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> loop &lt; <span class="number">3</span>:<span class="comment">#loop=3的时候结束循环</span></span><br><span class="line">    name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户的名字：》》》》&quot;</span>)</span><br><span class="line">    pass_one = <span class="built_in">input</span>(<span class="string">&quot;请输入用户密码：》》》&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> name == username <span class="keyword">and</span> pass_one == password:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;欢迎回家！&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span><span class="comment">#密码用户名都正确结束循环</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;密码或用户名错误。&quot;</span>)</span><br><span class="line">        loop +=<span class="number">1</span><span class="comment">#loop=3的时候结束循环</span></span><br></pre></td></tr></table></figure>
<h3 id="（3）登入案例（while循环嵌套-break）">（3）登入案例（while循环嵌套-break）</h3>
<ul>
<li>如果while循环嵌套了很多层</li>
<li>要想退出每一层循环则需要在每一层循环都有一个break</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">username = <span class="string">&quot;Dream&quot;</span></span><br><span class="line">password = <span class="string">&quot;123&quot;</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">3</span>:  <span class="comment"># 第一层循环</span></span><br><span class="line">    inp_name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：&quot;</span>)</span><br><span class="line">    inp_pwd = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> inp_name == username <span class="keyword">and</span> inp_pwd == password:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;登陆成功&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:  <span class="comment"># 第二层循环</span></span><br><span class="line">            cmd = <span class="built_in">input</span>(<span class="string">&#x27;&gt;&gt;: &#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> cmd == <span class="string">&#x27;quit&#x27;</span>:</span><br><span class="line">                <span class="keyword">break</span>  <span class="comment"># 用于结束本层循环，即第二层循环</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;run &lt;%s&gt;&#x27;</span> % cmd)</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment"># 用于结束本层循环，即第一层循环</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;输入的用户名或密码错误！&quot;</span>)</span><br><span class="line">        count += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="6-用户密码案例">(6)用户密码案例</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">user_data_list = [</span><br><span class="line">    &#123;<span class="string">&quot;dream&quot;</span>: <span class="string">&quot;521&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;hope&quot;</span>: <span class="string">&quot;369&quot;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&quot;opp&quot;</span>: <span class="string">&quot;963&quot;</span>&#125;,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># 【二】循环开始校验用户名和密码</span></span><br><span class="line">tag_true = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> tag_true:</span><br><span class="line">    username_input = <span class="built_in">input</span>(<span class="string">&quot;username :&gt;&gt;&gt;&gt; &quot;</span>)</span><br><span class="line">    password_input = <span class="built_in">input</span>(<span class="string">&#x27;password :&gt;&gt;&gt;&gt; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 【三】校验当前用户名是否存在于上述列表中</span></span><br><span class="line">    <span class="keyword">for</span> user_data_dict <span class="keyword">in</span> user_data_list:</span><br><span class="line">        <span class="comment"># user_data_dict : &#123;&quot;dream&quot;: &quot;521&quot;&#125;</span></span><br><span class="line">        password = user_data_dict.get(username_input)</span><br><span class="line">        <span class="comment"># 有值 521</span></span><br><span class="line">        <span class="keyword">if</span> password <span class="keyword">and</span> password == password_input:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;登陆成功&quot;</span>)</span><br><span class="line">            tag_true = <span class="literal">False</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> password <span class="keyword">and</span> password != password_input:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;密码错误&quot;</span>)</span><br></pre></td></tr></table></figure>
<h2 id="（6）continue-跳过当前当次循环">（6）continue : 跳过当前当次循环</h2>
<ul>
<li>语法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> condition:</span><br><span class="line">    <span class="comment"># 循环体</span></span><br><span class="line">    <span class="keyword">if</span> some_condition:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 跳过当前循环，继续下一次循环</span></span><br><span class="line">        </span><br><span class="line">案例</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> count &lt; <span class="number">5</span>:<span class="comment">#直到count=5是结束循环</span></span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> count == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">continue</span>  <span class="comment"># 当 count 等于 3 时，跳过当前循环，继续下一次循环</span></span><br><span class="line">    <span class="built_in">print</span>(count)</span><br></pre></td></tr></table></figure>
<ul>
<li>这两个关键字在循环中的使用可以帮助你更灵活地控制循环的流程。</li>
<li><code>break</code> 用于完全退出循环，而 <code>continue</code> 用于跳过当前循环的剩余部分，直接进入下一次循环。</li>
</ul>
<h2 id="（7）无限死循环">（7）无限死循环</h2>
<ul>
<li>有的时候，我们需要程序在满足某个条件时一直执行，这就需要用到无限死循环。</li>
<li>最简单的无限死循环可以通过while语句来实行，条件为真。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;This is an infinite loop!&quot;</span>)</span><br><span class="line">会无限循环<span class="string">&quot;This is an infinite loop!&quot;</span>，因为whileTrue：的条件永远为真，所以循环不会停止。</span><br></pre></td></tr></table></figure>
<ul>
<li>退出循环逻辑</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&quot;Enter &#x27;exit&#x27; to end the loop: &quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> user_input.lower() == <span class="string">&#x27;exit&#x27;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;You entered:&quot;</span>, user_input)</span><br><span class="line"><span class="comment">#用户需要输入&#x27;exit&#x27;才能结束程序</span></span><br></pre></td></tr></table></figure>
<ul>
<li>例子中.lower()</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">string = <span class="string">&quot;Hello World!&quot;</span></span><br><span class="line">string = string.lower()</span><br><span class="line"><span class="built_in">print</span>(string)  <span class="comment"># 输出 &quot;hello world!&quot;</span></span><br></pre></td></tr></table></figure>
<h2 id="【8】标志位">【8】标志位</h2>
<h3 id="（1）语法-3">（1）语法</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">flang = <span class="literal">True</span>  <span class="comment"># 初始化标志位</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> flang:</span><br><span class="line">    <span class="comment"># 循环体</span></span><br><span class="line">    <span class="keyword">if</span> some_condition:</span><br><span class="line">        flag = <span class="literal">False</span>  <span class="comment"># 修改标志位，退出循环</span></span><br><span class="line">        </span><br><span class="line">案例</span><br><span class="line">flag = <span class="number">710</span>  <span class="comment"># 初始化标志位</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> flag:</span><br><span class="line">    user_input = <span class="built_in">input</span>(<span class="string">&quot;请输入：&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> user_input == <span class="string">&#x27;710&#x27;</span>:</span><br><span class="line">        flag = <span class="literal">False</span>  <span class="comment"># 当用户输入 &#x27;710&#x27; 时，修改标志位，退出循环</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用户输入：&quot;</span>, user_input)<span class="comment">#用户输入错误一直循环</span></span><br></pre></td></tr></table></figure>
<h3 id="（2）登陆案例-while循环嵌套-tag标志位">（2）登陆案例(while循环嵌套+tag标志位)</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">user_list = [</span><br><span class="line">    &#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;user1&#x27;</span>, <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;123&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;user2&#x27;</span>, <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;456&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;username&#x27;</span>: <span class="string">&#x27;user3&#x27;</span>, <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;789&#x27;</span>&#125;,</span><br><span class="line">]</span><br><span class="line">loop = <span class="literal">False</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    username = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：&quot;</span>)</span><br><span class="line">    password = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> user <span class="keyword">in</span> user_list:</span><br><span class="line">        <span class="keyword">if</span> username == user[<span class="string">&#x27;username&#x27;</span>] <span class="keyword">and</span> password == user[<span class="string">&#x27;password&#x27;</span>]:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;登陆成功！&quot;</span>)</span><br><span class="line">            loop = <span class="literal">True</span>  <span class="comment"># 修改登陆标志位为 True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> loop:</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment"># 如果登陆标志位为 True，退出循环</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;用户名或密码错误，请重新输入。&quot;</span>)</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">username = <span class="string">&quot;Dream&quot;</span></span><br><span class="line">password = <span class="string">&quot;123&quot;</span></span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">tag = <span class="literal">True</span></span><br><span class="line"><span class="keyword">while</span> tag: </span><br><span class="line">    inp_name = <span class="built_in">input</span>(<span class="string">&quot;请输入用户名：&quot;</span>)</span><br><span class="line">    inp_pwd = <span class="built_in">input</span>(<span class="string">&quot;请输入密码：&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> inp_name == username <span class="keyword">and</span> inp_pwd == password:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;登陆成功&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> tag:  </span><br><span class="line">            cmd = <span class="built_in">input</span>(<span class="string">&#x27;&gt;&gt;: &#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> cmd == <span class="string">&#x27;quit&#x27;</span>:</span><br><span class="line">                tag = <span class="literal">False</span>  <span class="comment"># tag变为False， 所有while循环的条件都变为False </span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;run &lt;%s&gt;&#x27;</span> % cmd)</span><br><span class="line">        <span class="keyword">break</span>  <span class="comment"># 用于结束本层循环，即第一层循环</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;输入的用户名或密码错误！&quot;</span>)</span><br><span class="line">        count += <span class="number">1</span></span><br></pre></td></tr></table></figure>
<h2 id="【9】循环分支（else）">【9】循环分支（else）</h2>
<ul>
<li>在while循环的后面
<ul>
<li>我们可以跟else语句</li>
</ul>
</li>
<li>当while 循环正常执行完并且中间没有被break 中止的话
<ul>
<li>就会执行else后面的语句</li>
</ul>
</li>
<li>所以我们可以用else来验证
<ul>
<li>循环是否正常结束</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt;= <span class="number">5</span> :</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Loop&quot;</span>,count)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;循环正常执行完啦&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-----out of while loop ------&quot;</span>)</span><br><span class="line">输出</span><br><span class="line">Loop <span class="number">1</span></span><br><span class="line">Loop <span class="number">2</span></span><br><span class="line">Loop <span class="number">3</span></span><br><span class="line">Loop <span class="number">4</span></span><br><span class="line">Loop <span class="number">5</span></span><br><span class="line">Loop <span class="number">6</span></span><br><span class="line">循环正常执行完啦   <span class="comment">#没有被break打断，所以执行了该行代码</span></span><br><span class="line">-----out of <span class="keyword">while</span> loop ------</span><br></pre></td></tr></table></figure>
<ul>
<li>如果执行过程中被break终止
<ul>
<li>就不会执行else语句</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> count &lt;= <span class="number">5</span> :</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line">    <span class="keyword">if</span> count == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Loop&quot;</span>,count)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;循环正常执行完啦&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;-----out of while loop ------&quot;</span>)</span><br><span class="line">输出</span><br><span class="line">Loop <span class="number">1</span></span><br><span class="line">Loop <span class="number">2</span></span><br><span class="line">-----out of <span class="keyword">while</span> loop ------ <span class="comment">#由于循环被break打断了，所以不执行else后的输出语句</span></span><br></pre></td></tr></table></figure>
<h2 id="10-range关键字">(10)range关键字</h2>
<h3 id="（1）遍历数字系列">（1）遍历数字系列</h3>
<ul>
<li>语法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(stop):</span><br><span class="line">    <span class="comment"># 循环体</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, stop):</span><br><span class="line">    <span class="comment"># 循环体</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(start, stop, step):</span><br><span class="line">    <span class="comment"># 循环体</span></span><br><span class="line"></span><br><span class="line">案例</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="comment">#输出</span></span><br><span class="line">    <span class="number">0</span></span><br><span class="line">    <span class="number">1</span></span><br><span class="line">    <span class="number">2</span></span><br><span class="line">    <span class="number">3</span></span><br><span class="line">    <span class="number">4</span><span class="comment">#顾头不顾尾</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">6</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 4</span></span><br><span class="line"><span class="comment"># 5#顾头不顾尾</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>, <span class="number">2</span>):<span class="comment">#2代表隔一个输出一个，也是顾头不顾尾</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 5</span></span><br><span class="line"><span class="comment"># 7</span></span><br><span class="line"><span class="comment"># 9</span></span><br></pre></td></tr></table></figure>
<h3 id="（2）指定区间">（2）指定区间</h3>
<ul>
<li>语法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rangge(start,stop)</span><br><span class="line"></span><br><span class="line">案例</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>, <span class="number">6</span>):</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 4</span></span><br><span class="line"><span class="comment"># 5</span></span><br></pre></td></tr></table></figure>
<h3 id="（3）步长">（3）步长</h3>
<ul>
<li>语法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">rangge(start,stop,step)</span><br><span class="line"></span><br><span class="line">案例</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">10</span>, <span class="number">2</span>):<span class="comment">#2代表隔一个输出一个，也是顾头不顾尾</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line"><span class="comment"># 3</span></span><br><span class="line"><span class="comment"># 5</span></span><br><span class="line"><span class="comment"># 7</span></span><br><span class="line"><span class="comment"># 9</span></span><br></pre></td></tr></table></figure>
<h3 id="4-range-len遍历序列-len计算长度">(4)range+len遍历序列(len计算长度)</h3>
<ul>
<li>原理</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">my_list = [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>, <span class="string">&#x27;orange&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(my_list)):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Index <span class="subst">&#123;i&#125;</span>: <span class="subst">&#123;my_list[i]&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 输出：</span></span><br><span class="line"><span class="comment"># Index 0: apple</span></span><br><span class="line"><span class="comment"># Index 1: banana</span></span><br><span class="line"><span class="comment"># Index 2: orange</span></span><br></pre></td></tr></table></figure>
<h3 id="5-range创建">(5)range创建</h3>
<h4 id="1-原理">[1]原理</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">numbers = <span class="built_in">list</span>(<span class="built_in">range</span>(start, stop, step))</span><br></pre></td></tr></table></figure>
<h4 id="2-使用">[2]使用</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">numbers = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">6</span>))</span><br><span class="line"><span class="built_in">print</span>(numbers)</span><br><span class="line"><span class="comment"># 输出：[1, 2, 3, 4, 5]</span></span><br></pre></td></tr></table></figure>
<h1>【二】循环分支嵌套</h1>
<ul>
<li>循环结构和分支结构可以嵌套在一起，形成复杂的程序逻辑。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Outer loop, current value:&quot;</span>, i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Inner loop, current value:&quot;</span>, j)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Nested loops finished!&quot;</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>上述代码中，外层循环 <code>for i in range(5):</code> 执行五次，内层循环 <code>for j in range(3):</code> 每次外层循环执行时都会执行三次。这样就形成了嵌套的循环结构。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 案例2</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    score = <span class="built_in">input</span>(<span class="string">&quot;请输入您的成绩&gt;&gt;&quot;</span>)  <span class="comment"># &quot;100&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> score.isdigit():</span><br><span class="line">        score = <span class="built_in">int</span>(score)  <span class="comment"># 100</span></span><br><span class="line">        <span class="keyword">if</span> score &gt; <span class="number">100</span> <span class="keyword">or</span> score &lt; <span class="number">0</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;您的输入有误！&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> score &gt; <span class="number">90</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;成绩优秀&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> score &gt; <span class="number">70</span>:  <span class="comment"># else if</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;成绩良好&quot;</span>)</span><br><span class="line">        <span class="keyword">elif</span> score &gt; <span class="number">60</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;成绩及格&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;成绩不及格&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;请输入一个数字&quot;</span>)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.5socket%E5%A5%97%E6%8E%A5%E5%AD%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.5socket%E5%A5%97%E6%8E%A5%E5%AD%97/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>socket</h1>
<h2 id="【一】简介">【一】简介</h2>
<ul>
<li>
<p>我们知道两个进程如果需要进行通讯最基本的一个前提能能够唯一的标示一个进程，在本地进程通讯中我们可以使用PID来唯一标示一个进程，但PID只在本地唯一，网络中的两个进程PID冲突几率很大，这时候我们需要另辟它径了，我们知道IP层的ip地址可以唯一标示主机，而TCP层协议和端口号可以唯一标示主机的一个进程，这样我们可以利用ip地址＋协议＋端口号唯一标示网络中的一个进程。</p>
</li>
<li>
<p>能够唯一标示网络中的进程后，它们就可以利用socket进行通信了，什么是socket呢？</p>
</li>
<li>
<p>我们经常把socket翻译为套接字，socket是在应用层和传输层之间的一个抽象层，它把TCP/IP层复杂的操作抽象为几个简单的接口供应用层调用已实现进程在网络中通信。</p>
</li>
<li>
<p>socket起源于UNIX，在Unix一切皆文件哲学的思想下，socket是一种&quot;打开—读/写—关闭&quot;模式的实现，服务器和客户端各自维护一个&quot;文件&quot;，在建立连接打开后，可以向自己文件写入内容供对方读取或者读取对方内容，通讯结束时关闭文件。</p>
</li>
</ul>
<h2 id="【二】什么是socket">【二】什么是socket</h2>
<ul>
<li>
<p>应用层和传输层之间的抽象层</p>
</li>
<li>
<p>socket（套接字）：是一个网络接口，它允许应用层通过它发送或接收数据</p>
</li>
<li>
<p>我们无需深入理解tcp/udp协议，socket已经为我们封装好了，我们只需要遵循socket的规定去编程，写出的程序自然就是遵循tcp/udp标准的。</p>
</li>
<li>
<p>也有人将socket说成ip+port</p>
<ul>
<li>ip是标识互联网中的一台主机的位置</li>
<li>port是用来标记这台机器上的应用程序</li>
<li>IP地址是配置到网卡上的</li>
<li>port是应用程序开启的</li>
<li>ip与port的绑定就是标识了互联网中独一无二的一个应用程序</li>
</ul>
</li>
<li>
<p>而程序 的pib是同一台机器上不同进程或者线程的标识</p>
</li>
</ul>
<h2 id="【三】套接字发展史及分类">【三】套接字发展史及分类</h2>
<ul>
<li>套接字起源于 20 世纪 70 年代加利福尼亚大学伯克利分校版本的 Unix,即人们所说的 BSD Unix。</li>
<li>因此,有时人们也把套接字称为“伯克利套接字”或“BSD 套接字”。</li>
<li>一开始,套接字被设计用在同 一台主机上多个应用程序之间的通讯。</li>
<li>这也被称进程间通讯,或 IPC。套接字有<strong>两种</strong>（或者称为有两个种族）,分别是
<ul>
<li><strong>基于文件型的</strong></li>
<li><strong>基于网络型的</strong></li>
</ul>
</li>
</ul>
<h3 id="（1）基于文件类型的套接字家族">（1）基于文件类型的套接字家族</h3>
<ul>
<li>套接字家族的名字
<ul>
<li>AF_UNIX</li>
</ul>
</li>
<li>unix一切皆文件
<ul>
<li>基于文件的套接字调用的就是底层的文件系统来取数据</li>
<li>两个套接字进程运行在同一个机器</li>
<li>可以通过访问同一个文件系统间接完成通信</li>
</ul>
</li>
</ul>
<h3 id="（2）基于网络类型的套接字家族">（2）基于网络类型的套接字家族</h3>
<ul>
<li>套接字家族的名字
<ul>
<li>AF_INET</li>
</ul>
</li>
<li>还有AF_INET6被用于ipv6，还有一些其他的地址家族，不过，他们要么是只用于某个平台，要么就是已经被废弃，或者是很少被使用，或者是根本没有实现
<ul>
<li>所有家族中，AF_INET是使用最广泛的一个</li>
<li>python支持很多种地址家族，我们使用最多的还是AF_INET</li>
</ul>
</li>
</ul>
<h2 id="【四】套接字工作流程">【四】套接字工作流程</h2>
<h3 id="（1）流程分析">（1）流程分析</h3>
<ul>
<li>打电话</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#我们需要做的工作</span></span><br><span class="line">一部电话</span><br><span class="line">一张电话卡：好查找，用来表示那个号是你自己本人</span><br><span class="line">拨打电话</span><br><span class="line">和打出去电话的人建立联系</span><br><span class="line">和对方进行交流</span><br><span class="line">挂断电话</span><br></pre></td></tr></table></figure>
<ul>
<li>接电话</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#我们需要做的工作</span></span><br><span class="line">一部手机</span><br><span class="line">一张电话卡：好查找，用来表示那个号是你自己本人</span><br><span class="line">接听电话</span><br><span class="line">和打电话的人建立联系</span><br><span class="line">和对方进行交流</span><br><span class="line">挂断电话</span><br></pre></td></tr></table></figure>
<h3 id="（2）流程分析">（2）流程分析</h3>
<p>打电话</p>
<ul>
<li>打电话----服务端</li>
<li>一部手机----初始化socket对象</li>
<li>一张电话卡----与本地的接口进行绑定</li>
<li>拨打电话----listen监听是否有人监听</li>
<li>和打出去电话的人建立联系----accept接收到客户端连接 进行阻塞 connect连接</li>
<li>和对方进行交流----send发送信息</li>
<li>挂断电话----close</li>
</ul>
<p>服务端</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># （1）接电话 --- 服务端</span></span><br><span class="line"><span class="comment"># 一部手机：初始化 socket 对象</span></span><br><span class="line"><span class="comment"># family=-1 : AF_INET</span></span><br><span class="line"><span class="comment"># type=-1 : SOCK_STREAM  --- 基于TCP的流式协议</span></span><br><span class="line"><span class="comment"># proto=-1 :  0</span></span><br><span class="line"><span class="comment"># 初始化 socket 对象 ： 获得到一个基于TCP的流式协议的TCP对象</span></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一张电话卡 ：与本地的端口进行绑定</span></span><br><span class="line">ip = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">port = <span class="number">8001</span></span><br><span class="line">server.bind((ip, port))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拨打电话：listen 监听当前是否有人接通电话</span></span><br><span class="line"><span class="comment"># 半连接池</span></span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 和打出去的电话的人建立联系 ： accept 接收到客户端连接 进行阻塞 connect 连接</span></span><br><span class="line">conn, addr = server.accept()</span><br><span class="line"><span class="comment"># 只能发送二进制数据</span></span><br><span class="line">from_server_to_client_send_data = <span class="string">f&#x27;我是来自服务端的一条数据&#x27;</span></span><br><span class="line">conn.send(from_server_to_client_send_data.encode())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 和对方进行交流 ：send 发送信息</span></span><br><span class="line">from_client_to_server_recv_data = conn.recv(<span class="number">1024</span>)  <span class="comment"># 1kb = 1024字节</span></span><br><span class="line"><span class="built_in">print</span>(from_client_to_server_recv_data.decode())</span><br><span class="line"><span class="comment"># 挂断电话 close</span></span><br><span class="line">conn.close()</span><br><span class="line"></span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>
<p>接电话</p>
<ul>
<li>接电话----客户端</li>
<li>一部手机----初始化socket对象</li>
<li>一张电话卡----与本地的接口进行绑定</li>
<li>接听电话----connct</li>
<li>和打出去电话的人建立联系----connect连接</li>
<li>和对方进行交流----send发送信息</li>
<li>挂断电话----close</li>
</ul>
<p>客户端</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># （2）接电话 --- 客户端</span></span><br><span class="line"><span class="comment"># 一部手机 ： 初始化 socket 对象</span></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 一张电话卡 ：与本地的端口进行绑定</span></span><br><span class="line">ip = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">port = <span class="number">8001</span></span><br><span class="line">client.connect((ip, port))</span><br><span class="line"><span class="comment"># 接听电话 ： connct</span></span><br><span class="line"><span class="comment"># 和打进来的电话的人建立联系  connect 连接</span></span><br><span class="line">from_server_to_client_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="built_in">print</span>(from_server_to_client_recv_data.decode())</span><br><span class="line"><span class="comment"># 和对方进行交流 ： send 发送信息</span></span><br><span class="line"></span><br><span class="line">from_client_to_server_send_data = <span class="string">&#x27;我是来自客户端的一条数据&#x27;</span></span><br><span class="line">client.send(from_client_to_server_send_data.encode())</span><br><span class="line"><span class="comment"># 挂断电话 close</span></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.9%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5%EF%BC%8C%E5%8F%91%E5%B1%95%E5%8F%B2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.9%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E5%BF%B5%EF%BC%8C%E5%8F%91%E5%B1%95%E5%8F%B2/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>操作系统</h1>
<h2 id="【一】进程的概念">【一】进程的概念</h2>
<ul>
<li>进程就在电脑上正在执行的一个过程</li>
<li>进程来源于操作系统，是操作系统最核心的概念，是一个抽象问题</li>
</ul>
<h2 id="【二】为什么要有操作系统">【二】为什么要有操作系统</h2>
<ul>
<li>筹备所有的硬件就有了操作系统的这个概念</li>
<li>硬盘包括：cpu，硬盘，内存条，显卡，主板。。。</li>
</ul>
<ol>
<li>一开始要筹备所有操作硬件，必须掌握硬件的每一个细节，很繁琐，开发效率慢</li>
<li>优化：将一部分功能和硬件封装起来，进行优化
<ul>
<li>就像我们的面条版，包装成函数版，再到我们的类</li>
</ul>
</li>
<li>最后诞生了操作系统，将细节的操作功能和操作步骤封装起来，而是暴露给用户一些可以操作的接口和步骤
<ul>
<li>用户不需要了解自己的硬件细节就可以直接操作硬件</li>
</ul>
</li>
</ol>
<h2 id="【三】什么是操作系统">【三】什么是操作系统</h2>
<ul>
<li>操作系统就是一个协调、管理和控制计算机硬件资源和软件资源的控制程序</li>
<li>操作系统是位于系统硬件和应用程序之间的中间介质</li>
</ul>
<h2 id="【四】操作系统的功能">【四】操作系统的功能</h2>
<h3 id="【1】隐藏硬件接口">【1】隐藏硬件接口</h3>
<ul>
<li>将调用硬件的详细步骤隐藏起来，只会给你一些…的步骤</li>
<li>根据这些接口自己高度定制自己的程序而不需要考虑硬件细节</li>
</ul>
<h3 id="【2】资源有序化">【2】资源有序化</h3>
<ul>
<li>将应用程序对硬件资源的竞争和请求变得有序化</li>
</ul>
<h3 id="【3】对资源进行合理的调度和分配">【3】对资源进行合理的调度和分配</h3>
<ul>
<li>记录那个应用程序需要什么资源</li>
<li>对请求的资源进行分配</li>
<li>中和每一个应用之间的请求</li>
</ul>
<h2 id="【五】如何实现资源有序化">【五】如何实现资源有序化</h2>
<ul>
<li>每一个电脑上有一个操作系统的基本流程：多路复用</li>
</ul>
<h3 id="【1】时间上的复用">【1】时间上的复用</h3>
<ul>
<li>方案一：程序一个一个执行，很慢
<ul>
<li>电脑上只有一个cpu就执行方案一</li>
</ul>
</li>
<li>方案二：程序同时执行，效率高一些
<ul>
<li>电脑上有多个cpu的话就可以执行方案二</li>
</ul>
</li>
<li>这里的cpu是指：硬件cpu上面执行的cpu，–》10核20线程–》10cpu</li>
</ul>
<h3 id="【2】空间上的复用">【2】空间上的复用</h3>
<ul>
<li>内存是用来临时存储数据和CPU进行交互的</li>
<li>谁用就先把内存空间给他用</li>
<li>为啥你既能用qq又能用微信，是因为内存空间切换的足够快</li>
</ul>
<h3 id="【3】多路复用">【3】多路复用</h3>
<ul>
<li>我们现在用的电脑就是多路复用</li>
</ul>
<h2 id="【六】操作系统和普通软件的区别">【六】操作系统和普通软件的区别</h2>
<ul>
<li>操作系统
<ul>
<li>操作系统是普通软件的载体</li>
<li>操作系统比较大</li>
<li>操作系统寿命长–》开发出一个完整的系统你就会用很久</li>
</ul>
</li>
<li>普通软件
<ul>
<li>寿命短，一年可能会更新很多个版本</li>
</ul>
</li>
</ul>
<h2 id="【七】操作系统发展史">【七】操作系统发展史</h2>
<h3 id="【1】第一代计算机（1940-1955）：真空管和穿孔卡片">【1】<strong>第一代计算机（1940~1955）：真空管和穿孔卡片</strong></h3>
<h4 id="（1）产生背景">（1）产生背景</h4>
<ul>
<li>第一代之前人类是想用机械取代人力</li>
<li>第一代计算机的产生是计算机由机械时代进入电子时代的标志</li>
<li>从Babbage失败之后一直到第二次世界大战，数字计算机的建造几乎没有什么进展</li>
<li>第二次世界大战刺激了有关计算机研究的爆炸性进展。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">lowa州立大学的john Atanasoff教授和他的学生Clifford Berry建造了据认为是第一台可工作的数字计算机。</span><br><span class="line"></span><br><span class="line">该机器使用300个真空管。大约在同时，Konrad Zuse在柏林用继电器构建了Z3计算机，英格兰布莱切利园的一个小组在1944年构建了Colossus，Howard Aiken在哈佛大学建造了Mark 1，宾夕法尼亚大学的William Mauchley和他的学生J.Presper Eckert建造了ENIAC。</span><br><span class="line"></span><br><span class="line">这些机器有的是二进制的，有的使用真空管，有的是可编程的，但都非常原始，设置需要花费数秒钟时间才能完成最简单的运算。</span><br></pre></td></tr></table></figure>
<h4 id="（2）技术背景">（2）技术背景</h4>
<ul>
<li>同一个小组里的工程师们，设计、建造、编程、操作及维护同一台机器</li>
<li>所有的程序设计是用纯粹的机器语言编写的，甚至更糟糕</li>
<li>需要通过成千上万根电缆接到插件板上连成电路来控制机器的基本功能。</li>
<li>没有程序设计语言（汇编也没有），操作系统则是从来都没听说过。</li>
<li>使用机器的过程更加原始，详见下‘工作过程’</li>
</ul>
<h4 id="（3）特点">（3）特点</h4>
<ul>
<li>没有操作系统的概念 所有的程序设计都是直接操控硬件</li>
</ul>
<h4 id="（4）工作过程">（4）工作过程</h4>
<ul>
<li>程序员在墙上的机时表预约一段时间</li>
<li>然后程序员拿着他的插件版到机房里</li>
<li>将自己的插件板街道计算机里</li>
<li>这几个小时内他独享整个计算机资源</li>
<li>后面的一批人都得等着(两万多个真空管经常会有被烧坏的情况出现)。</li>
<li>后来出现了穿孔卡片，可以将程序写在卡片上，然后读入机而不用插件板</li>
</ul>
<h4 id="（5）优点">（5）优点</h4>
<ul>
<li>程序员在申请的时间段内独享整个资源</li>
<li>可以即时地调试自己的程序（有bug可以立刻处理）</li>
</ul>
<h4 id="（6）缺点">（6）缺点</h4>
<ul>
<li>浪费计算机资源，一个时间段内只有一个人用。注意：同一时刻只有一个程序在内存中，被cpu调用执行，比方说10个程序的执行，是串行的</li>
</ul>
<h3 id="【2】第二代计算机（1955-1965）：晶体管和批处理系统">【2】<strong>第二代计算机（1955~1965）：晶体管和批处理系统</strong></h3>
<h4 id="（1）产生背景-2">（1）产生背景</h4>
<ul>
<li>由于当时的计算机非常昂贵，自认很自然的想办法较少机时的浪费。</li>
<li>通常采用的方法就是批处理系统。</li>
</ul>
<h4 id="（2）特点">（2）特点</h4>
<ul>
<li>设计人员、生产人员、操作人员、程序人员和维护人员直接有了明确的分工</li>
<li>计算机被锁在专用空调房间中</li>
<li>由专业操作人员运行，这便是‘大型机’。</li>
</ul>
<h4 id="（3）技术背景">（3）技术背景</h4>
<ul>
<li>
<p>有了操作系统的概念</p>
</li>
<li>
<p>有了程序设计语言：</p>
</li>
<li>
<ul>
<li>FORTRAN语言或汇编语言，写到纸上</li>
<li>然后穿孔打成卡片</li>
<li>再将卡片盒带到输入室，交给操作员</li>
<li>然后喝着咖啡等待输出接口</li>
</ul>
</li>
</ul>
<p><img src="http://zhaochunze.dream521.site/2322215-20230625082040911-626478560.jpg" alt="img"></p>
<h4 id="（4）第二代如何解决第一代的问题-缺点">（4）第二代如何解决第一代的问题/缺点</h4>
<ul>
<li>把一堆人的输入攒成一大波输入，</li>
<li>然后顺序计算（这是有问题的，但是第二代计算也没有解决）</li>
<li>把一堆人的输出攒成一大波输出</li>
</ul>
<h3 id="【3】第三代计算机（1965-1980）：集成电路芯片和多道程序设计">【3】<strong>第三代计算机（1965~1980）：集成电路芯片和多道程序设计</strong></h3>
<h4 id="（1）产生背景-3">（1）产生背景</h4>
<ul>
<li>
<p>20世纪60年代初期，大多数计算机厂商都有两条完全不兼容的生产线。</p>
</li>
<li>
<ul>
<li>一条是面向字的：</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>大型的科学计算机</li>
<li>如IBM 7094，见上图，主要用于科学计算和工程计算</li>
</ul>
</li>
</ul>
</li>
<li>
<ul>
<li>另外一条是面向字符的：</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>商用计算机，如IBM 1401，见上图</li>
<li>主要用于银行和保险公司从事磁带归档和打印服务</li>
</ul>
</li>
</ul>
</li>
<li>
<p>开发和维护完全不同的产品是昂贵的</p>
</li>
<li>
<ul>
<li>同时不同的用户对计算机的用途不同。</li>
</ul>
</li>
</ul>
<h4 id="（2）技术背景-2">（2）技术背景</h4>
<ul>
<li>
<p>IBM公司试图通过引入system/360系列来同时满足科学计算和商业计算</p>
</li>
<li>
<ul>
<li>360系列低档机与1401相当，高档机比7094功能强很多</li>
<li>不同的性能卖不同的价格</li>
</ul>
</li>
<li>
<p>360是第一个采用了（小规模）芯片（集成电路）的主流机型</p>
</li>
<li>
<ul>
<li>与采用晶体管的第二代计算机相比，性价比有了很大的提高。</li>
<li>这些计算机的后代仍在大型的计算机中心里使用，<strong>此乃现在服务器的前身</strong></li>
<li>这些服务器每秒处理不小于千次的请求。</li>
</ul>
</li>
</ul>
<h4 id="（3）如何解决第二代计算机的问题1">（3）如何解决第二代计算机的问题1</h4>
<ul>
<li>卡片被拿到机房后能够很快的将作业从卡片读入磁盘，于是任何时刻当一个作业结束时，操作系统就能将一个作业从磁带读出，装进空出来的内存区域运行，这种技术叫做 同时的外部设备联机操作：SPOOLING</li>
<li>该技术同时用于输出。</li>
<li>当采用了这种技术后，就不在需要IBM1401机了，也不必将磁带搬来搬去了（中间俩小人不再需要）</li>
</ul>
<h4 id="（4）如何解决第二代计算机的问题2">（4）如何解决第二代计算机的问题2</h4>
<ul>
<li>
<p>第三代计算机的操作系统广泛应用了第二代计算机的操作系统没有的关键技术：</p>
</li>
<li>
<ul>
<li>多道技术</li>
</ul>
</li>
<li>
<p>cpu在执行一个任务的过程中</p>
</li>
<li>
<ul>
<li>若需要操作硬盘，则发送操作硬盘的指令</li>
<li>指令一旦发出，硬盘上的机械手臂滑动读取数据到内存中</li>
<li>这一段时间，cpu需要等待，时间可能很短</li>
<li>但对于cpu来说已经很长很长，长到可以让cpu做很多其他的任务</li>
<li>如果我们让cpu在这段时间内切换到去做其他的任务</li>
<li>这样cpu不就充分利用了吗。这正是多道技术产生的技术背景</li>
</ul>
</li>
</ul>
<h4 id="（5）多道技术">（5）多道技术</h4>
<ul>
<li>
<p>多道技术中的多道指的是多个程序</p>
</li>
<li>
<p>多道技术的实现是为了解决多个程序竞争或者说共享同一个资源（比如cpu）的有序调度问题</p>
</li>
<li>
<p>解决方式即多路复用</p>
</li>
<li>
<ul>
<li>多路复用分为时间上的复用和空间上的复用。</li>
</ul>
</li>
</ul>
<h5 id="1-空间上的复用"><strong>[1]空间上的复用</strong></h5>
<ul>
<li>将内存分为几部分，每个部分放入一个程序，这样，同一时间内存中就有了多道程序。</li>
</ul>
<h5 id="2-时间上的复用">[2]<strong>时间上的复用</strong></h5>
<ul>
<li>当一个程序在等待I/O时，另一个程序可以使用cpu</li>
<li>如果内存中可以同时存放足够多的作业，则cpu的利用率可以接近100%</li>
<li>类似于我们小学数学所学的<strong>统筹方法</strong>。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">（操作系统采用了多道技术后，可以控制进程的切换</span><br><span class="line"></span><br><span class="line">或者说进程之间去争抢cpu的执行权限。</span><br><span class="line"></span><br><span class="line">这种切换不仅会在一个进程遇到io时进行，一个进程占用cpu时间过长也会切换</span><br><span class="line"></span><br><span class="line">或者说被操作系统夺走cpu的执行权限）</span><br></pre></td></tr></table></figure>
<h5 id="3-详解：">[3]<strong>详解：</strong></h5>
<ul>
<li>
<p>空间上的复用最大的问题是：</p>
</li>
<li>
<ul>
<li>程序之间的内存必须分割</li>
<li>这种分割需要在硬件层面实现，由操作系统控制。</li>
<li>如果内存彼此不分割，则一个程序可以访问另外一个程序的内存，</li>
</ul>
</li>
<li>
<p>首先丧失的是安全性</p>
</li>
<li>
<ul>
<li>比如你的qq程序可以访问操作系统的内存</li>
<li>这意味着你的qq可以拿到操作系统的所有权限。</li>
</ul>
</li>
<li>
<p>其次丧失的是稳定性</p>
</li>
<li>
<ul>
<li>某个程序崩溃时有可能把别的程序的内存也给回收了</li>
<li>比方说把操作系统的内存给回收了，则操作系统崩溃。</li>
</ul>
</li>
</ul>
<p>第三代计算机的操作系统仍然是批处理</p>
<ul>
<li>
<p>许多程序员怀念第一代独享的计算机</p>
</li>
<li>
<ul>
<li>可以即时调试自己的程序。</li>
<li>为了满足程序员们很快可以得到响应，出现了分时操作系统</li>
</ul>
</li>
</ul>
<h4 id="（6）如何解决第二代计算机的问题3">（6）如何解决第二代计算机的问题3</h4>
<p>分时操作系统： 多个联机终端+多道技术</p>
<ul>
<li>
<p>20个客户端同时加载到内存</p>
</li>
<li>
<ul>
<li>有17在思考，3个在运行</li>
<li>cpu就采用多道的方式处理内存中的这3个程序</li>
<li>由于客户提交的一般都是简短的指令而且很少有耗时长的</li>
<li>索引计算机能够为许多用户提供快速的交互式服务</li>
<li>所有的用户都以为自己独享了计算机资源</li>
</ul>
</li>
<li>
<p>CTTS:</p>
</li>
<li>
<ul>
<li>麻省理工（MIT）在一台改装过的7094机上开发成功的</li>
<li>CTSS兼容分时系统，<strong>第三代计算机广泛采用了必须的保护硬件（程序之间的内存彼此隔离）之后，分时系统才开始流行</strong></li>
</ul>
</li>
<li>
<p>MIT:</p>
</li>
<li>
<ul>
<li>贝尔实验室和通用电气在CTTS成功研制后决定开发能够同时支持上百终端的MULTICS（其设计者着眼于建造满足波士顿地区所有用户计算需求的一台机器）</li>
<li>很明显真是要上天啊，最后摔死了。</li>
</ul>
</li>
<li>
<p>后来</p>
</li>
<li>
<ul>
<li>一位参加过MULTICS研制的贝尔实验室计算机科学家Ken Thompson开发了一个简易的，单用户版本的MULTICS</li>
<li><strong>这就是后来的UNIX系统</strong>。</li>
<li>基于它衍生了很多其他的Unix版本，为了使程序能在任何版本的unix上运行，IEEE提出了一个unix标准，即<strong>posix（可移植的操作系统接口Portable Operating System Interface）</strong></li>
</ul>
</li>
<li>
<p>后来</p>
</li>
<li>
<ul>
<li>在1987年，出现了一个UNIX的小型克隆，即minix，用于教学使用。</li>
<li>芬兰学生Linus Torvalds基于它编写了Linux</li>
</ul>
</li>
</ul>
<h3 id="【4】第四代计算机（1980-至今）：个人计算机">【4】<strong>第四代计算机（1980~至今）：个人计算机</strong></h3>
<ul>
<li>即使可以利用的cpu只有一个（早期的计算机确实如此），也能保证支持（伪）并发的能力。</li>
<li>将一个单独的cpu变成多个虚拟的cpu（多道技术：时间多路复用和空间多路复用+硬件上支持隔离），没有进程的抽象，现代计算机将不复存在。</li>
</ul>
<h3 id="【5】发展史概览">【5】发展史概览</h3>
<table>
<thead>
<tr>
<th>计算机发展阶段</th>
<th>时间</th>
<th>组成</th>
<th>改进</th>
<th>缺陷</th>
</tr>
</thead>
<tbody>
<tr>
<td>第一代计算机</td>
<td>1940~1955</td>
<td>真空管和穿孔卡片</td>
<td></td>
<td>没有操作系统的概念 所有的程序设计都是直接操控硬件</td>
</tr>
<tr>
<td>第二代计算机</td>
<td>1955~1965</td>
<td>晶体管和批处理系统</td>
<td>批处理，节省机时</td>
<td>全程需要人参与，仍是串行，无法及时调试程序</td>
</tr>
<tr>
<td>第三代计算机</td>
<td>1965~1980</td>
<td>集成电路芯片和多道程序设计</td>
<td>运用多道技术</td>
<td></td>
</tr>
<tr>
<td>第四代计算机</td>
<td>1980至今</td>
<td>个人计算机</td>
<td>支持（伪）并发的能力</td>
<td></td>
</tr>
</tbody>
</table>
<h1>总结</h1>
<h3 id="【1】操作系统的作用">【1】操作系统的作用</h3>
<ul>
<li>隐藏丑陋复杂的硬件接口，提供良好的抽象接口</li>
<li>管理，调度进程，并且将多个进程对硬件的竞争变得有序</li>
</ul>
<h3 id="【2】多道技术">【2】多道技术</h3>
<h4 id="（1）产生背景：针对单核，实现并发">（1）产生背景：针对单核，实现并发</h4>
<ul>
<li>现在的主机一般是多核，那么每个核都会利用多道技术 有4个cpu，运行于cpu1的某个程序遇到io阻塞，会等到io结束再重新调度，会被调度到4个cpu中的任意一个，具体由操作系统调度算法决定。</li>
</ul>
<h4 id="（2）空间上的复用：如内存中同时由多道程序">（2）空间上的复用：如内存中同时由多道程序</h4>
<ul>
<li>空间上的复用指定是在内存中同时运行多个程序，这样可以有效地利用内存资源。</li>
</ul>
<h4 id="（3）时间上的复用：复用一个cpu的时间片">（3）时间上的复用：复用一个cpu的时间片</h4>
<ul>
<li>
<p>指共享同一台机器的多个进程可以轮流使用CPU，从而避免了长时间等待的情况发生。</p>
</li>
<li>
<p>强调：遇到io切，占用cpu时间过长也切，核心在于切之前将进程的状态保存下来，这样才能保证下次切换回来时，能基于上次切走的位置继续运行</p>
</li>
</ul>
<h3 id="【3】操作系统发展史">【3】操作系统发展史</h3>
<ul>
<li>第一代计算机（1940-1955）：真空管和穿孔卡片</li>
<li>第二代计算机（1955-1965）：<strong>晶体管和批处理系统</strong></li>
<li><strong>第三代计算机（1965~1980）</strong>：集成电路芯片和多道程序设计</li>
<li>第四代计算机（1980-至今）：个人计算机</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.7TCP%E5%8D%8F%E8%AE%AE%E6%A8%A1%E5%9E%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.7TCP%E5%8D%8F%E8%AE%AE%E6%A8%A1%E5%9E%8B/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>TCP协议模型</h1>
<h2 id="【一】一代">【一】一代</h2>
<ul>
<li><code>client.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象：server:服务器</span></span><br><span class="line"><span class="comment"># AF_INET:当前连接是基于网络的套接字</span></span><br><span class="line"><span class="comment"># SOCK_STREAM:连接模式是TCP协议的流式模式</span></span><br><span class="line"><span class="comment"># SOCK_STREAM表示创建一个面向连接的、基于TCP协议的socket类型。它是一种可靠的、双向的、点对点的通信协议，提供面向连接的、可靠的数据传输服务。</span></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line"><span class="comment"># connect:连接</span></span><br><span class="line">client.connect(setting.ADDR)</span><br><span class="line"><span class="comment"># 直接发送数据</span></span><br><span class="line">to_server_send_data = <span class="string">f&quot;这是来自客户端的一条数据！&quot;</span></span><br><span class="line"><span class="comment">#转码</span></span><br><span class="line">to_server_send_data = to_server_send_data.encode()</span><br><span class="line"><span class="comment">#发送</span></span><br><span class="line"><span class="comment">#send：将数据to_server_send_data传给客户端</span></span><br><span class="line"><span class="comment"># 当你发送的数据较大时，可以做一个循环，分批发送</span></span><br><span class="line">client.send(to_server_send_data)</span><br><span class="line"><span class="comment">#接收到服务端回的消息</span></span><br><span class="line">from_server_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="comment">#接收到信息记得解码</span></span><br><span class="line">from_server_recv_data = from_server_recv_data.decode()</span><br><span class="line"><span class="built_in">print</span>(from_server_recv_data)</span><br><span class="line"><span class="comment">#关闭连接对象</span></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>server.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="comment"># 引入socket模块</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象：server:服务器</span></span><br><span class="line"><span class="comment"># AF_INET:当前连接是基于网络的套接字</span></span><br><span class="line"><span class="comment"># SOCK_STREAM:连接模式是TCP协议的流式模式</span></span><br><span class="line"><span class="comment"># SOCK_STREAM表示创建一个面向连接的、基于TCP协议的socket类型。它是一种可靠的、双向的、点对点的通信协议，提供面向连接的、可靠的数据传输服务。</span></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line"><span class="comment"># 导入---settings</span></span><br><span class="line"><span class="comment"># bind：将套接字绑定到一个地址</span></span><br><span class="line"><span class="comment"># 必须在listen()或connect()之前调用bind()</span></span><br><span class="line">server.bind(setting.ADDR)</span><br><span class="line"><span class="comment"># 监听连接的对象</span></span><br><span class="line"><span class="comment"># 5：代表一个端口号</span></span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"><span class="comment">#建立连接对象</span></span><br><span class="line"><span class="comment">#server.accept()阻塞，等来客户端发出请求</span></span><br><span class="line"><span class="comment"># server.accept() 会返回一个元组</span></span><br><span class="line"><span class="comment">#conn：一个新的socket对象</span></span><br><span class="line"><span class="comment"># addr：客户端的地址信息</span></span><br><span class="line">conn,addr = server.accept()</span><br><span class="line"><span class="built_in">print</span>(conn)</span><br><span class="line"><span class="comment">#&lt;socket.socket fd=332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=(&#x27;127.0.0.1&#x27;, 8002), raddr=(&#x27;127.0.0.1&#x27;, 50724)&gt;</span></span><br><span class="line"><span class="built_in">print</span>(addr)<span class="comment">#(&#x27;127.0.0.1&#x27;, 50724)</span></span><br><span class="line"><span class="comment">#接收到客户端的数据</span></span><br><span class="line"><span class="comment">#1024：表示能接收1024个字节的数据</span></span><br><span class="line"><span class="comment">#接收到的是一个字节组（bytes）</span></span><br><span class="line">from_client_rect_data = conn.recv(<span class="number">1024</span>)</span><br><span class="line"><span class="comment">#将二进制数据进行转码</span></span><br><span class="line">from_client_rect_data = from_client_rect_data.decode()</span><br><span class="line"><span class="built_in">print</span>(from_client_rect_data)<span class="comment">#这是来自客户端的一条数据！</span></span><br><span class="line"><span class="comment">#返回给客户端数据</span></span><br><span class="line">to_client_send_data = <span class="string">&quot;这是来自服务端的一条数据！&quot;</span></span><br><span class="line"><span class="comment">#记得转码--转成二进制数据</span></span><br><span class="line">to_client_send_data = to_client_send_data.encode()</span><br><span class="line"><span class="comment">#发送</span></span><br><span class="line"><span class="comment">#send：将数据to_client_send_data传给客户端</span></span><br><span class="line"><span class="comment"># 当你发送的数据较大时，可以做一个循环，分批发送</span></span><br><span class="line">conn.send(to_client_send_data)</span><br><span class="line"><span class="comment">#关不连接和关闭服务</span></span><br><span class="line">conn.close()</span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>
<h2 id="【二】二代—空值的时候">【二】二代—空值的时候</h2>
<ul>
<li><code>client.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line">client.connect(setting.ADDR)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    to_server_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应服务端：=--&quot;</span>).strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> to_server_send_data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;数据不能为空！&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> to_server_send_data == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;当前连接已退出！&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    to_server_send_data = to_server_send_data.encode()</span><br><span class="line">    client.send(to_server_send_data)</span><br><span class="line">    from_server_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line">    from_server_recv_data = from_server_recv_data.decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;接收服务端的信息--<span class="subst">&#123;from_server_recv_data&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#关闭连接对象</span></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>server.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Current username：socket </span></span><br><span class="line"><span class="comment"># current date：2024/5/15</span></span><br><span class="line"><span class="comment"># current time ：16:54</span></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="comment"># 引入socket模块</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line">server.bind(setting.ADDR)</span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"><span class="comment">#放在这进入while循环中的哪个连接对象会一致不变，永远会是同一个</span></span><br><span class="line">conn, addr = server.accept()</span><br><span class="line"><span class="comment"># if conn == &quot;q&quot;:</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment">#conn, addr = server.accept()，在while循环外面的话每次接收的就是一个新的对象</span></span><br><span class="line">    <span class="comment">#while里面交流的对象永远是conn收到的</span></span><br><span class="line">    from_client_rect_data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">    from_client_rect_data = from_client_rect_data.decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;接收客服端的消息--<span class="subst">&#123;from_client_rect_data&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        to_client_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应客户端:---&quot;</span>).strip()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> to_client_send_data:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;服务端传数据不能为空！&quot;</span>)</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> to_client_send_data == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;已退出！&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        to_client_send_data = to_client_send_data.encode()</span><br><span class="line">        conn.send(to_client_send_data)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">conn.close()</span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>
<h2 id="【三】三代—优化">【三】三代—优化</h2>
<ul>
<li><code>client.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line">client.connect(setting.ADDR)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    to_server_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应服务端：=--&quot;</span>).strip()</span><br><span class="line">    to_server_send_data = to_server_send_data.encode()</span><br><span class="line">    client.send(to_server_send_data)</span><br><span class="line">    from_server_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line">    from_server_recv_data = from_server_recv_data.decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;接收服务端的信息--<span class="subst">&#123;from_server_recv_data&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#关闭连接对象</span></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>server.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="comment"># 引入socket模块</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line">server.bind(setting.ADDR)</span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"><span class="comment">#放在这进入while循环中的哪个连接对象会一致不变，永远会是同一个</span></span><br><span class="line">conn, addr = server.accept()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment">#conn, addr = server.accept()，在while循环外面的话每次接收的就是一个新的对象</span></span><br><span class="line">    <span class="comment">#while里面交流的对象永远是conn收到的</span></span><br><span class="line">    from_client_rect_data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">    from_client_rect_data = from_client_rect_data.decode()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;接收客服端的消息--<span class="subst">&#123;from_client_rect_data&#125;</span>&quot;</span>)</span><br><span class="line">    to_client_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应客户端:---&quot;</span>).strip()</span><br><span class="line">    to_client_send_data = to_client_send_data.encode()</span><br><span class="line">    conn.send(to_client_send_data)</span><br><span class="line">conn.close()</span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>
<h2 id="【四】四代—while">【四】四代—while</h2>
<ul>
<li><code>client.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象：server:服务器</span></span><br><span class="line"><span class="comment"># AF_INET:当前连接是基于网络的套接字</span></span><br><span class="line"><span class="comment"># SOCK_STREAM:连接模式是TCP协议的流式模式</span></span><br><span class="line"><span class="comment"># SOCK_STREAM表示创建一个面向连接的、基于TCP协议的socket类型。它是一种可靠的、双向的、点对点的通信协议，提供面向连接的、可靠的数据传输服务。</span></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line"><span class="comment"># connect:连接</span></span><br><span class="line">client.connect(setting.ADDR)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 直接发送数据</span></span><br><span class="line">    to_server_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应服务端：=--&quot;</span>).strip()</span><br><span class="line">    <span class="comment"># 转码</span></span><br><span class="line">    to_server_send_data = to_server_send_data.encode()</span><br><span class="line">    <span class="comment"># 发送</span></span><br><span class="line">    <span class="comment"># send：将数据to_server_send_data传给客户端</span></span><br><span class="line">    <span class="comment"># 当你发送的数据较大时，可以做一个循环，分批发送</span></span><br><span class="line">    client.send(to_server_send_data)</span><br><span class="line">    <span class="comment"># 接收到服务端回的消息</span></span><br><span class="line">    from_server_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="comment"># 接收到信息记得解码</span></span><br><span class="line">    from_server_recv_data = from_server_recv_data.decode()</span><br><span class="line">    <span class="built_in">print</span>(from_server_recv_data)</span><br><span class="line"><span class="comment">#关闭连接对象</span></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>server.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="comment"># 引入socket模块</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象：server:服务器</span></span><br><span class="line"><span class="comment"># AF_INET:当前连接是基于网络的套接字</span></span><br><span class="line"><span class="comment"># SOCK_STREAM:连接模式是TCP协议的流式模式</span></span><br><span class="line"><span class="comment"># SOCK_STREAM表示创建一个面向连接的、基于TCP协议的socket类型。它是一种可靠的、双向的、点对点的通信协议，提供面向连接的、可靠的数据传输服务。</span></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line"><span class="comment"># 导入---settings</span></span><br><span class="line"><span class="comment"># bind：将套接字绑定到一个地址</span></span><br><span class="line"><span class="comment"># 必须在listen()或connect()之前调用bind()</span></span><br><span class="line">server.bind(setting.ADDR)</span><br><span class="line"><span class="comment"># 监听连接的对象</span></span><br><span class="line"><span class="comment"># 5：代表一个端口号</span></span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 建立连接对象</span></span><br><span class="line">    <span class="comment"># server.accept()阻塞，等来客户端发出请求</span></span><br><span class="line">    <span class="comment"># server.accept() 会返回一个元组</span></span><br><span class="line">    <span class="comment"># conn：一个新的socket对象</span></span><br><span class="line">    <span class="comment"># addr：客户端的地址信息</span></span><br><span class="line">    conn, addr = server.accept()</span><br><span class="line">    <span class="built_in">print</span>(conn)</span><br><span class="line">    <span class="comment"># &lt;socket.socket fd=332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=(&#x27;127.0.0.1&#x27;, 8002), raddr=(&#x27;127.0.0.1&#x27;, 50724)&gt;</span></span><br><span class="line">    <span class="built_in">print</span>(addr)  <span class="comment"># (&#x27;127.0.0.1&#x27;, 50724)</span></span><br><span class="line">    <span class="comment"># 接收到客户端的数据</span></span><br><span class="line">    <span class="comment"># 1024：表示能接收1024个字节的数据</span></span><br><span class="line">    <span class="comment"># 接收到的是一个字节组（bytes）</span></span><br><span class="line">    from_client_rect_data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="comment"># 将二进制数据进行转码</span></span><br><span class="line">    from_client_rect_data = from_client_rect_data.decode()</span><br><span class="line">    <span class="built_in">print</span>(from_client_rect_data)  <span class="comment"># 这是来自客户端的一条数据！</span></span><br><span class="line">    <span class="comment"># 返回给客户端数据</span></span><br><span class="line">    to_client_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应客户端:---&quot;</span>).strip()</span><br><span class="line">    <span class="comment"># 记得转码--转成二进制数据</span></span><br><span class="line">    to_client_send_data = to_client_send_data.encode()</span><br><span class="line">    <span class="comment"># 发送</span></span><br><span class="line">    <span class="comment"># send：将数据to_client_send_data传给客户端</span></span><br><span class="line">    <span class="comment"># 当你发送的数据较大时，可以做一个循环，分批发送</span></span><br><span class="line">    conn.send(to_client_send_data)</span><br><span class="line">    <span class="comment"># 关不连接和关闭服务</span></span><br><span class="line">conn.close()</span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>
<h2 id="【五】第五代–try">【五】第五代–try</h2>
<ul>
<li><code>client.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line">client.connect(setting.ADDR)</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    to_server_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应服务端：=--&quot;</span>).strip()</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> to_server_send_data:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;数据不能为空！&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> to_server_send_data == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;当前连接已退出！&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    to_server_send_data = to_server_send_data.encode()</span><br><span class="line">    client.send(to_server_send_data)</span><br><span class="line">    from_server_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line">    from_server_recv_data = from_server_recv_data.decode()</span><br><span class="line">    <span class="keyword">if</span> from_server_recv_data == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;收到服务端的退出信息！&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;接收服务端的信息--<span class="subst">&#123;from_server_recv_data&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment">#关闭连接对象</span></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>server.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> setting</span><br><span class="line"><span class="comment"># 引入socket模块</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"></span><br><span class="line">server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">server.bind(setting.ADDR)</span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"><span class="comment">#放在这进入while循环中的哪个连接对象会一致不变，永远会是同一个</span></span><br><span class="line">conn, addr = server.accept()</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># conn, addr = server.accept()，在while循环外面的话每次接收的就是一个新的对象</span></span><br><span class="line">        <span class="comment"># while里面交流的对象永远是conn收到的</span></span><br><span class="line">        from_client_rect_data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">        from_client_rect_data = from_client_rect_data.decode()</span><br><span class="line">        <span class="comment">#这里接受的数据为空的时候</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> from_client_rect_data:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;客户端已退出！&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;接收客服端的消息--<span class="subst">&#123;from_client_rect_data&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            to_client_send_data = <span class="built_in">input</span>(<span class="string">&quot;回应客户端:---&quot;</span>).strip()</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> to_client_send_data:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;服务端传数据不能为空！&quot;</span>)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> to_client_send_data == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;已退出！&quot;</span>)</span><br><span class="line">                <span class="comment"># break不能停止，因为客户端还在等在结束信息</span></span><br><span class="line">            to_client_send_data = to_client_send_data.encode()</span><br><span class="line">            conn.send(to_client_send_data)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">conn.close()</span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.6%E7%B2%98%E5%8C%85%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.6%E7%B2%98%E5%8C%85%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>粘包问题</h1>
<h2 id="【一】介绍">【一】介绍</h2>
<ul>
<li>
<p>粘包问题只会发生在TCP协议上—》流失协议–》不断的传输数据</p>
<ul>
<li>因为TCP是流式协议</li>
</ul>
</li>
<li>
<p>不会发生在UDP协议上–》报式协议—》一次性传输数据</p>
</li>
</ul>
<h2 id="【二】粘包问题">【二】粘包问题</h2>
<ul>
<li>客户端发送数据远远超出服务端的接受范围</li>
<li>就会导致不同数据之间的混乱
<ul>
<li>意思就是你第一次发送的数据太多没有发完，就会跟着第二次混在一块发送。</li>
</ul>
</li>
</ul>
<h2 id="【三】解决思路和办法">【三】解决思路和办法</h2>
<ul>
<li>问题产生在服务端
<ul>
<li>原因是客户端传给服务端数据，但是服务端不知道接收的总数据的大小，只能按默认的大小来接收</li>
</ul>
</li>
<li>解决办法
<ul>
<li>客户端发送数据的时候将数据总在一块，一次性发送给服务端</li>
<li>服务端接收到总数据的大小长度，根据自己的容量大小分批接收</li>
</ul>
</li>
</ul>
<h2 id="【四】例题">【四】例题</h2>
<ul>
<li>解决方法</li>
<li><code>server.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象</span></span><br><span class="line">server = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 解决端口被占用的问题</span></span><br><span class="line">server.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line">server.bind(settings.ADDR)</span><br><span class="line"><span class="comment"># 服务端多了一步监听对象</span></span><br><span class="line">server.listen(<span class="number">5</span>)</span><br><span class="line"><span class="comment"># 多了一步建立连接对象</span></span><br><span class="line"><span class="comment"># 就是客户端传过来的数据</span></span><br><span class="line">conn, addr = server.accept()</span><br><span class="line"><span class="comment"># while循环</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment"># 这里面交流的对象永远是上面接收到的那一个</span></span><br><span class="line">        <span class="comment"># conn,addr = server.accept():接收到新的对象，忘记上一个连接过的对象</span></span><br><span class="line">        <span class="comment"># 先接收客户端传过来的第一个数据struct打包好的四个字节的数据</span></span><br><span class="line">        json_pack_data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">        <span class="comment"># 判断是不是空的</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> json_pack_data:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="comment"># 对数据解包-&gt;得到json二进制长度数据</span></span><br><span class="line">        json_bytes_length = settings.unpack_data(data=json_pack_data)</span><br><span class="line">        <span class="comment"># 根据json二进制数据长度解出JSON二进制数据</span></span><br><span class="line">        json_data_bytes = conn.recv(json_bytes_length)</span><br><span class="line">        <span class="comment"># 将json二进制数据转为json字符串数据</span></span><br><span class="line">        json_str = json_data_bytes.decode()</span><br><span class="line">        <span class="comment"># 将json字符串数据转换为python的字典</span></span><br><span class="line">        data_info = json.loads(json_str)</span><br><span class="line">        <span class="comment"># 字典特性--》键取值</span></span><br><span class="line">        <span class="comment"># 得到总的数据长度</span></span><br><span class="line">        data_length = data_info.get(<span class="string">&#x27;data_length&#x27;</span>)</span><br><span class="line">        <span class="comment"># 开始分批接收数据</span></span><br><span class="line">        <span class="comment"># 定义数据</span></span><br><span class="line">        <span class="comment"># 定义总数居---&gt;二进制</span></span><br><span class="line">        all_data = <span class="string">b&#x27; &#x27;</span></span><br><span class="line">        <span class="comment"># 每次只能接收数据的大小</span></span><br><span class="line">        size = <span class="number">1024</span></span><br><span class="line">        <span class="comment"># 引入方法---》divmod--》得到商和余数</span></span><br><span class="line">        <span class="comment"># 比如</span></span><br><span class="line">        <span class="comment"># data_length : 5</span></span><br><span class="line">        <span class="comment"># size : 2</span></span><br><span class="line">        <span class="comment"># count : 2 , last_size : 1</span></span><br><span class="line">        count, last_size = <span class="built_in">divmod</span>(data_length, size)</span><br><span class="line">        <span class="comment"># 再定义一个接收数据的大小</span></span><br><span class="line">        all_size = <span class="number">0</span></span><br><span class="line">        <span class="comment"># while循环</span></span><br><span class="line">        <span class="keyword">while</span> all_size &lt; count + <span class="number">1</span>:</span><br><span class="line">            all_size += <span class="number">1</span></span><br><span class="line">            <span class="comment"># 接收到每一次的数据并和总数据拼接</span></span><br><span class="line">            <span class="keyword">if</span> all_size == count + <span class="number">1</span>:</span><br><span class="line">                all_data += conn.recv(size)</span><br><span class="line">                from_client_recv_data = all_data.decode()</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&#x27;这是来自客户端的数据 :&gt;&gt;&gt;&gt;  \n <span class="subst">&#123;from_client_recv_data&#125;</span>&#x27;</span>)</span><br><span class="line">            <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">                to_client_send_data = <span class="built_in">input</span>(<span class="string">&quot;请输入发送给客户端的数据 :&gt;&gt;&gt;&gt; &quot;</span>).strip()</span><br><span class="line">                <span class="keyword">if</span> <span class="keyword">not</span> to_client_send_data:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;不允许发送空的数据&#x27;</span>)</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                <span class="keyword">if</span> to_client_send_data == <span class="string">&#x27;q&#x27;</span>:</span><br><span class="line">                    <span class="built_in">print</span>(<span class="string">f&#x27;当前连接已退出!&#x27;</span>)</span><br><span class="line">                <span class="comment"># 编码</span></span><br><span class="line">                to_client_send_data = to_client_send_data.encode()</span><br><span class="line">                <span class="comment"># 发送数据</span></span><br><span class="line">                conn.send(to_client_send_data)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># 关闭服务</span></span><br><span class="line">conn.close()</span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>
<ul>
<li><code>client.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="comment"># 导入模块版</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> uuid</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> conf <span class="keyword">import</span> settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数--》启动命令</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_cmd</span>(<span class="params">command</span>):</span><br><span class="line">    result = subprocess.run(</span><br><span class="line">        command,  <span class="comment"># 子进程要执行的命令</span></span><br><span class="line">        shell=<span class="literal">True</span>,  <span class="comment"># 执行的是shell命令</span></span><br><span class="line">        <span class="comment"># 存放的是执行命令成功的结果</span></span><br><span class="line">        stdout=subprocess.PIPE,</span><br><span class="line">        <span class="comment"># 存放的是执行命令失败的结果</span></span><br><span class="line">        stderr=subprocess.PIPE,</span><br><span class="line">        encoding=<span class="string">&quot;gbk&quot;</span>,</span><br><span class="line">        timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># returncode属性是run()函数返回结果的状态</span></span><br><span class="line">    <span class="keyword">if</span> result.returncode == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stdout</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stderr</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个server对象</span></span><br><span class="line">client = socket.socket(family=socket.AF_INET, <span class="built_in">type</span>=socket.SOCK_STREAM)</span><br><span class="line"><span class="comment"># 绑定IP和PORT</span></span><br><span class="line">client.connect(settings.ADDR)</span><br><span class="line"><span class="comment"># 创建一个while循环</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="comment"># 输入发送数据</span></span><br><span class="line">    command = <span class="built_in">input</span>(<span class="string">&quot;请输入你要执行的命令：----&quot;</span>).strip()</span><br><span class="line">    <span class="comment"># 判断</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> command:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;不允许发送空数据&quot;</span>)</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> command == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;当前连接已退出！&quot;</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="comment"># 执行本地的命令，获取到当前命令结果</span></span><br><span class="line">    result = run_cmd(command=command)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line">    <span class="comment"># 将命令的结果进行编码，转换成二进制数据</span></span><br><span class="line">    result_bytes = result.encode()</span><br><span class="line">    <span class="comment"># 计算长度</span></span><br><span class="line">    data_length = <span class="built_in">len</span>(result)</span><br><span class="line">    <span class="comment"># 加一个数据字典，将所有的数据概览</span></span><br><span class="line">    <span class="comment"># 获得盐</span></span><br><span class="line">    salt = uuid.uuid4().<span class="built_in">hex</span></span><br><span class="line">    <span class="comment"># 加密</span></span><br><span class="line">    encrypted = settings.encrypt_data(data=result_bytes, salt=salt)</span><br><span class="line">    <span class="built_in">print</span>(data_length)</span><br><span class="line">    <span class="comment"># 建立字典</span></span><br><span class="line">    send_data_info = &#123;</span><br><span class="line">        <span class="string">&#x27;command&#x27;</span>: command,</span><br><span class="line">        <span class="string">&#x27;data_length&#x27;</span>: data_length,</span><br><span class="line">        <span class="string">&#x27;salt&#x27;</span>: salt,</span><br><span class="line">        <span class="string">&#x27;encrypted&#x27;</span>: encrypted</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment"># 将上面打包的数据---》发送给服务端</span></span><br><span class="line">    <span class="comment"># 字典格式无法发送，将字典转换为字符串数据用--》json</span></span><br><span class="line">    <span class="comment"># dump：处理文件数据</span></span><br><span class="line">    <span class="comment"># dumps：将格式转换</span></span><br><span class="line">    json_str = json.dumps(send_data_info)</span><br><span class="line">    <span class="comment"># 将转换好的字符串数据再转换成二进制数据、</span></span><br><span class="line">    json_bytes = json_str.encode()</span><br><span class="line">    <span class="comment"># json字符串转换的二进制数据还是会很长、</span></span><br><span class="line">    <span class="comment"># 于是我们想到--》struct模块：将某个数据转换为四个字节的二进制数据</span></span><br><span class="line">    <span class="comment"># 将数据打包</span></span><br><span class="line">    json_length_pack = settings.pack_data(data_length=<span class="built_in">len</span>(json_bytes))</span><br><span class="line">    <span class="comment"># 发送数据--》先发送打包好的struct数据--》再发送json数据--》最后发送原始数据</span></span><br><span class="line">    <span class="comment"># 服务端接受的顺序取决于客户端发送的顺序</span></span><br><span class="line">    <span class="comment"># 先发送打包好的struct数据</span></span><br><span class="line">    client.send(json_length_pack)</span><br><span class="line">    <span class="built_in">print</span>(json_length_pack)</span><br><span class="line">    <span class="comment"># 再发送json数据-&gt;二进制数据</span></span><br><span class="line">    client.send(json_bytes)</span><br><span class="line">    <span class="comment"># 最后发送原始数据---&gt;命令二进制数据</span></span><br><span class="line">    client.send(result_bytes)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 接收服务端返回的消息</span></span><br><span class="line">    from_server_recv_data = client.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="comment"># 解码</span></span><br><span class="line">    from_server_recv_data = from_server_recv_data.decode()</span><br><span class="line">    <span class="comment"># 判断---解码得到的是q的话就代表服务端已退出</span></span><br><span class="line">    <span class="keyword">if</span> from_server_recv_data == <span class="string">&quot;q&quot;</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;来自服务端的数据：-----<span class="subst">&#123;from_server_recv_data&#125;</span>&quot;</span>)</span><br><span class="line"><span class="comment"># 关闭连接对象--要在while循环外面</span></span><br><span class="line">client.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li><code>settings.py</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Current username：粘包问题 </span></span><br><span class="line"><span class="comment"># current date：2024/5/15</span></span><br><span class="line"><span class="comment"># current time ：20:39</span></span><br><span class="line"></span><br><span class="line">IP = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line"><span class="comment"># localhost 和 127.0.0.1区别</span></span><br><span class="line"><span class="comment"># DNS解析 --&gt; 一串字符解析成IP</span></span><br><span class="line"><span class="comment"># localhost 就是一个域名 只能在本地使用</span></span><br><span class="line">PORT = <span class="number">8006</span></span><br><span class="line">ADDR = (IP, PORT)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#加密</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt_data</span>(<span class="params">data, salt</span>):</span><br><span class="line">    data = <span class="built_in">str</span>(data) + <span class="built_in">str</span>(salt)</span><br><span class="line">    data = data.encode()</span><br><span class="line">    md5 = hashlib.md5()</span><br><span class="line">    md5.update(data)</span><br><span class="line">    <span class="keyword">return</span> md5.hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个包含不同类型字段的格式字符串</span></span><br><span class="line">format_string = <span class="string">&#x27;i&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对数据进行打包</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pack_data</span>(<span class="params">data_length: <span class="built_in">int</span></span>):</span><br><span class="line">    <span class="comment"># 使用 struct.pack 将数据打包成二进制字节串</span></span><br><span class="line">    packed_data = struct.pack(format_string, data_length)</span><br><span class="line">    <span class="keyword">return</span> packed_data</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对数据解包</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">unpack_data</span>(<span class="params">data</span>):</span><br><span class="line">    data_length = struct.unpack(format_string, data)</span><br><span class="line">    <span class="keyword">return</span> data_length[<span class="number">0</span>]</span><br></pre></td></tr></table></figure>
<h2 id="【五】小插曲（subprocess模块）">【五】小插曲（subprocess模块）</h2>
<ul>
<li>相当于一个模拟终端（cmd）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_cmd</span>(<span class="params">command</span>):</span><br><span class="line">    result = subprocess.run(</span><br><span class="line">        command,  <span class="comment"># 子进程要执行的命令</span></span><br><span class="line">        shell=<span class="literal">True</span>,  <span class="comment"># 执行的是shell的命令</span></span><br><span class="line">        <span class="comment"># 存放的是执行命令成功的结果</span></span><br><span class="line">        stdout=subprocess.PIPE,</span><br><span class="line">        <span class="comment"># 存放的是执行命令失败的结果</span></span><br><span class="line">        stderr=subprocess.PIPE,</span><br><span class="line">        encoding=<span class="string">&quot;gbk&quot;</span>,</span><br><span class="line">        timeout=<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># returncode属性是run()函数返回结果的状态。</span></span><br><span class="line">    <span class="keyword">if</span> result.returncode == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stdout</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> result.stderr</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(run_cmd([<span class="string">&quot;dir&quot;</span>]))<span class="comment">#命令：dir</span></span><br><span class="line">输出<span class="comment">#  驱动器 D 中的卷是 Data</span></span><br><span class="line">    <span class="comment">#  卷的序列号是 6672-D05A</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#  D:\pycharm\project\DAY01\模块 的目录</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># 2024/05/15  20:28    &lt;DIR&gt;          .</span></span><br><span class="line">    <span class="comment"># 2024/05/14  15:21    &lt;DIR&gt;          ..</span></span><br><span class="line">    <span class="comment"># 2024/05/09  16:53               111 pickle_file</span></span><br><span class="line">    <span class="comment"># 2024/05/09  16:54               932 pickle模块.py</span></span><br><span class="line">    <span class="comment"># 2024/05/15  20:28               731 subprocess模块.py</span></span><br><span class="line">    <span class="comment">#                3 个文件          1,774 字节</span></span><br><span class="line">    <span class="comment">#                2 个目录 122,309,275,648 可用字节</span></span><br></pre></td></tr></table></figure>
<h2 id="【六】struct模块介绍">【六】struct模块介绍</h2>
<ul>
<li><code>struct.pack()</code>是Python内置模块<code>struct</code>中的一个函数</li>
<li>他的作用是将指定的数据按照指定的格式进行打包</li>
<li>将打包后的结果转换为一个字节序列（byte string），可以用于在网络上传输或者储存于文件中。</li>
</ul>
<h3 id="（1）参数简介">（1）参数简介</h3>
<ul>
<li><code>struct.pack(fmt, v1, v2, ...)</code></li>
<li><code>fmt</code>是格式字符串，指定了需要打包的数据格式，v1,v2则是需要打包的数据</li>
<li>数据按照fmt的格式被编写成二进制的字符串，并返回字节串</li>
<li>定义fmt用的</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">● x --- 填充字节</span><br><span class="line">● c --- char类型，占1字节</span><br><span class="line">● b --- signed char类型，占1字节</span><br><span class="line">● B --- unsigned char类型，占1字节</span><br><span class="line">● h --- short类型，占2字节</span><br><span class="line">● H --- unsigned short类型，占2字节</span><br><span class="line">● i --- int类型，占4字节</span><br><span class="line">● I --- unsigned int类型，占4字节</span><br><span class="line">● l --- long类型，占4字节（32位机器上）或者8字节（64位机器上）</span><br><span class="line">● L --- unsigned long类型，占4字节（32位机器上）或者8字节（64位机器上）</span><br><span class="line">● q --- long long类型，占8字节</span><br><span class="line">● Q --- unsigned long long类型，占8字节</span><br><span class="line">● f --- float类型，占4字节</span><br><span class="line">● d --- double类型，占8字节</span><br><span class="line">● s --- char[]类型，占指定字节个数，需要用数字指定长度</span><br><span class="line">● p --- char[]类型，跟s一样，但通常用来表示字符串</span><br><span class="line">● ? --- bool类型，占1字节</span><br></pre></td></tr></table></figure>
<ul>
<li>例题</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#导入模块</span></span><br><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"></span><br><span class="line"><span class="comment">#定义一个包含不同类型字段的格式字符串</span></span><br><span class="line">format_string = <span class="string">&quot;i&quot;</span></span><br><span class="line"></span><br><span class="line">data_to_pack = <span class="string">&quot;ajeaedji0ejdpoadopdkmscoijaeciojei测测为的味道维持稳定饿挖的低洼d&quot;</span></span><br><span class="line"><span class="comment">#上面数据二进制</span></span><br><span class="line">data_to_pack_bytes = data_to_pack.encode()</span><br><span class="line"></span><br><span class="line"><span class="comment">#计算长度</span></span><br><span class="line">data_to_pack_len = <span class="built_in">len</span>(data_to_pack_bytes)</span><br><span class="line"><span class="built_in">print</span>(data_to_pack_len)<span class="comment">#80</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 struct.pack 将数据打包成二进制字节串</span></span><br><span class="line">packed_data = struct.pack(format_string, data_to_pack_len)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(packed_data)<span class="comment">#b&#x27;P\x00\x00\x00&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#解析二进制字符串，恢复原始数据</span></span><br><span class="line">unpacked_data = struct.unpack(format_string, packed_data)</span><br><span class="line"><span class="built_in">print</span>(unpacked_data)<span class="comment">#(80,)</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/1.8%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/1.8%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%92%8C%E5%9B%9B%E6%AC%A1%E6%8C%A5%E6%89%8B/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>TCP三次握手和四次挥手</h1>
<ul>
<li>只发生在TCP协议上</li>
</ul>
<h2 id="【一】三次握手">【一】三次握手</h2>
<p>发生在连接阶段</p>
<ul>
<li>第一次握手
<ul>
<li>客户端发出请求（一定要有数据），需要和服务端建立联系</li>
</ul>
</li>
<li>第二次握手
<ul>
<li>服务端接收到客户端发来的请求</li>
<li>ACK=1：表示收到了当前客户端发送给我的请求</li>
</ul>
</li>
<li>第三次握手
<ul>
<li>客户端收到服务端发来的请求（一定要带数据）</li>
<li>表示建立连接成功
<ul>
<li>ACK=1:表示已经被正确接收</li>
<li>SYN=1:一个俩及请求或是连接接收内报文</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="【二】四次挥手">【二】四次挥手</h2>
<p>发生在断开连接阶段</p>
<ul>
<li>第一次挥手
<ul>
<li>客户端向服务端发出断开连接请求</li>
</ul>
</li>
<li>第二次挥手
<ul>
<li>服务端接收到客户端发来的请求</li>
<li>服务端拒绝断开连接</li>
</ul>
</li>
<li>第三次挥手
<ul>
<li>不断开的原因是，数据还没有处理完成</li>
<li>处理完之后</li>
<li>向服务端请求表示可以断开连接</li>
</ul>
</li>
<li>第四次挥手
<ul>
<li>客户端接收到服务端的断开连接的请求</li>
<li>断开连接</li>
</ul>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/10.0Django%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%A8%A1%E5%9E%8B%E5%B1%82/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/10.0Django%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%A8%A1%E5%9E%8B%E5%B1%82/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>Django框架之模型层</h1>
<h2 id="【一】模型层引入（测试环境搭建）">【一】模型层引入（测试环境搭建）</h2>
<ul>
<li>Django的orm框架必须是在Django的启动状态下才能使用</li>
<li>Django为我们提供了测试环境</li>
<li>这个测试环境只是临时启动而不是持久化活动</li>
</ul>
<p>创建测试环境</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复制</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br></pre></td></tr></table></figure>
<h2 id="【二】Django的ORM的单表操作">【二】Django的ORM的单表操作</h2>
<h3 id="【1】数据库配置">【1】数据库配置</h3>
<ul>
<li>在setting.py文件中配置
<ul>
<li>将原来django自带的删掉</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,</span><br><span class="line">        <span class="comment"># 手动创建一个新的数据库</span></span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&quot;django_two&quot;</span>,</span><br><span class="line">        <span class="string">&quot;USER&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PASSWORD&quot;</span>: <span class="string">&quot;1234567&quot;</span>,</span><br><span class="line">        <span class="string">&quot;HOST&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PORT&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">        <span class="string">&quot;CHARSET&quot;</span>: <span class="string">&quot;utf8mb4&quot;</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>启动项目可能会报错</li>
<li>原因是没有下载mysqlclient</li>
</ul>
<p>解决方法一</p>
<ul>
<li>
<p>打猴子补丁</p>
</li>
<li>
<p>随便找一个文件，一般都会选择<code>__init__.py</code>文件</p>
</li>
<li>
<p>把下面的数据复制进去即可</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pymysql</span><br><span class="line"></span><br><span class="line">pymysql.install_as_MySQLdb()</span><br></pre></td></tr></table></figure>
<p>方法二</p>
<ul>
<li>下载mysqlclient</li>
</ul>
<h3 id="【2】在APP下的models-py文件中定义模型表">【2】在APP下的models.py文件中定义模型表</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfo</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>, verbose_name=<span class="string">&quot;名字&quot;</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField(verbose_name=<span class="string">&quot;年龄&quot;</span>)</span><br><span class="line">    <span class="comment"># 显示注册时间</span></span><br><span class="line">    <span class="comment"># auto_now_add=True</span></span><br><span class="line">    <span class="comment"># Django会在对象第一次被创建时自动设置该字段的值为当前的日期和时间。之后，无论对象如何被保存或修改，这个字段的值都不会再自动更新</span></span><br><span class="line">    <span class="comment"># DateTimeField类型</span></span><br><span class="line">    <span class="comment"># 用于在数据库中存储日期和时间</span></span><br><span class="line">    register_time = models.DateTimeField(auto_now_add=<span class="literal">True</span>,</span><br><span class="line">                                         verbose_name=<span class="string">&quot;注册时间&quot;</span>)</span><br><span class="line">    <span class="comment"># auto_now：在创建数据库的时候会自动新增时间，每次修改都会刷新</span></span><br><span class="line">    update_time = models.DateTimeField(auto_now=<span class="literal">True</span>,</span><br><span class="line">                                       verbose_name=<span class="string">&quot;更新时间&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>迁移数据库</p>
<ul>
<li>执行两句话</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python manage.py makemigrations</span><br><span class="line"></span><br><span class="line">python manage.py migrate</span><br></pre></td></tr></table></figure>
<ul>
<li>执行完后就迁移成功了</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240625202154249.png" alt="image-20240625202154249"></p>
</li>
</ul>
<h3 id="【3】对数据库的增删改查（必会N条）">【3】对数据库的增删改查（必会N条）</h3>
<ul>
<li>在你的测试环境下面写</li>
</ul>
<h4 id="（1）增">（1）增</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复制</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line">    <span class="comment"># 【1】对数据库增值</span></span><br><span class="line">    <span class="comment"># 方式一 create()</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.create(name=&quot;jack&quot;, age=22)</span></span><br><span class="line">    <span class="comment"># print(data) # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># 方法二 先生成一个对象，然后在提交事务</span></span><br><span class="line">    <span class="comment"># data = UserInfo(name=&quot;tom&quot;, age=710)</span></span><br><span class="line">    <span class="comment"># print(data) # UserInfo object (None)</span></span><br><span class="line">    <span class="comment"># 提交事务，不提交事务不会添加数据</span></span><br><span class="line">    <span class="comment"># data.save()</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="（2）删">（2）删</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复制</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 【4】删除数据</span></span><br><span class="line">    <span class="comment"># 方法一 获取到筛选的结果，然后对结果进行删除.delete()</span></span><br><span class="line">    <span class="comment"># 会把符合条件的全部删除</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name=&quot;tom&quot;).delete()</span></span><br><span class="line">    <span class="comment"># print(data) # (2, &#123;&#x27;user.UserInfo&#x27;: 2&#125;)# 删除了两条数据</span></span><br><span class="line">    <span class="comment"># 方法二 直接删除对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.get(name=&quot;dream&quot;).delete()</span></span><br><span class="line">    <span class="comment"># print(data)  # (1, &#123;&#x27;user.UserInfo&#x27;: 1&#125;) #删除了一条数据</span></span><br></pre></td></tr></table></figure>
<h4 id="（3）改">（3）改</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复制</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【3】对数据库修改数据</span></span><br><span class="line">    <span class="comment"># 方法一 查完后直接修改</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name=&quot;jack&quot;).update(name=&quot;dream&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # 2 # 代表修改了两条数据</span></span><br><span class="line">    <span class="comment"># 方法二 先查对象，然后对象.属性名改值</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.get(pk=1)</span></span><br><span class="line">    <span class="comment"># data.name = &quot;tom&quot;</span></span><br><span class="line">    <span class="comment"># print(data)  # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># # 一定要提交数据</span></span><br><span class="line">    <span class="comment"># data.save()</span></span><br><span class="line">    <span class="comment"># # 修改成功</span></span><br></pre></td></tr></table></figure>
<h4 id="（4）查">（4）查</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复制</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【2】查询数据库里面的数据</span></span><br><span class="line">    <span class="comment"># 方式一 get和values取出所有符合条件的值，all取出所有的数据对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.all()</span></span><br><span class="line">    <span class="comment"># # 得到的是所有数据的对象</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;, &lt;UserInfo: UserInfo object (2)&gt;, &lt;UserInfo: UserInfo object (3)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.all().values(&quot;name&quot;)</span></span><br><span class="line">    <span class="comment"># # 取出所有人的名字</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># # &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;jack&#x27;&#125;, &#123;&#x27;name&#x27;: &#x27;jack&#x27;&#125;, &#123;&#x27;name&#x27;: &#x27;tom&#x27;&#125;]&gt;</span></span><br><span class="line">    <span class="comment"># # 得到id为1的user对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.get(pk=1)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># # 得到数据</span></span><br><span class="line">    <span class="comment"># data = data.name</span></span><br><span class="line">    <span class="comment"># print(data)  # jack</span></span><br><span class="line">    <span class="comment"># 方法二 fileter过滤结果 结果是queryset对象</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(pk=1)</span></span><br><span class="line">    <span class="comment"># print(data)  # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># 获得结果集的第一个结果</span></span><br><span class="line">    <span class="comment"># 因为就一个结果，都可以获得</span></span><br><span class="line">    <span class="comment"># data = data.first()</span></span><br><span class="line">    <span class="comment"># print(data) # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># 获得结果集的最后一个结果</span></span><br><span class="line">    <span class="comment"># 因为就一个结果，都可以获得</span></span><br><span class="line">    <span class="comment"># data = data.last()</span></span><br><span class="line">    <span class="comment"># print(data)  # UserInfo object (1)</span></span><br><span class="line">    <span class="comment"># 获得结果集中的所有符合条件的结果</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name=&quot;jack&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;, &lt;UserInfo: UserInfo object (2)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># data = data.all()</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (1)&gt;, &lt;UserInfo: UserInfo object (2)&gt;]&gt;</span></span><br><span class="line">    <span class="comment"># 获取结果集中的对应字段对应的数据,values得到的是字典</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age=22).values(&quot;name&quot;, &quot;age&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;jack&#x27;, &#x27;age&#x27;: 22&#125;, &#123;&#x27;name&#x27;: &#x27;jack&#x27;, &#x27;age&#x27;: 22&#125;]&gt;</span></span><br><span class="line">    <span class="comment"># 获取结果集中的对应字段对应的数据,values_list得到的是字典</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age=22).values_list(&quot;name&quot;, &quot;age&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [(&#x27;jack&#x27;, 22), (&#x27;jack&#x27;, 22)]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="（5）其它方法">（5）其它方法</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复制</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 记住在django中pk就是mysql中的id</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【5】去重</span></span><br><span class="line">	<span class="comment"># 筛选数的第一条数据</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.values(&quot;age&quot;).distinct().first()</span></span><br><span class="line">    <span class="comment"># print(user, type(user))</span></span><br><span class="line">    <span class="comment"># &#123;&#x27;age&#x27;: 18&#125; &lt;class &#x27;dict&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 【6】知道数据的结果量</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.count()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 【7】排序</span></span><br><span class="line">    <span class="comment"># 正序排 MySQL正序加 asc</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;age&quot;)</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line">    <span class="comment"># 倒序排 MySQL倒序加 desc</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;-age&quot;)</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line">    <span class="comment"># 将排序后的结果翻转</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;age&quot;).reverse()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line">    <span class="comment"># 在Django的ORM语句中只要不是确切的某个对象 就可以一直 . 触发其他方法</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.order_by(&quot;age&quot;).count()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 【8】对某个条件以外的结果进行剔除</span></span><br><span class="line">    <span class="comment"># 不会提出到你指定的这个年龄的结果</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.exclude(age=18)</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 【9】判断当前筛选到的结果是否存在</span></span><br><span class="line">    <span class="comment"># user = UserInfo.objects.filter(name=&quot;dream_1&quot;).exists()</span></span><br><span class="line">    <span class="comment"># print(user)</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 【必知必会N条】</span></span><br><span class="line">	<span class="comment"># model是models.py文件中定义模型表的类名，需要提前导入</span></span><br><span class="line">    <span class="comment"># 【1】增加</span></span><br><span class="line">    <span class="comment"># （1）model.objects.create(filed=value)</span></span><br><span class="line">    <span class="comment"># （2）model(filed=value).save()</span></span><br><span class="line">    <span class="comment"># 【2】删除</span></span><br><span class="line">    <span class="comment"># （3）model.objects.filter(filed=value).delete()</span></span><br><span class="line">    <span class="comment"># （4）model.objects.get(filed=value).delete()</span></span><br><span class="line">    <span class="comment"># 【3】修改</span></span><br><span class="line">    <span class="comment"># （5）model.objects.filter(filed=value).update(filed=new_value)</span></span><br><span class="line">    <span class="comment"># （6）obj = model.objects.get(filed=value)</span></span><br><span class="line">    <span class="comment"># obj.filed_name = value </span></span><br><span class="line">    <span class="comment"># obj.save()</span></span><br><span class="line">    <span class="comment"># 【4】查看</span></span><br><span class="line">    <span class="comment"># (7) model.objects.filter(field=value)</span></span><br><span class="line">    <span class="comment"># (8) model.objects.filter(field=value).first()</span></span><br><span class="line">    <span class="comment"># (9) model.objects.filter(field=value).last()</span></span><br><span class="line">    <span class="comment"># (10) model.objects.all() </span></span><br><span class="line">    <span class="comment"># (11) model.objects.get(filed=value)</span></span><br><span class="line">    <span class="comment"># 【5】扩展方法</span></span><br><span class="line">    <span class="comment"># (12) model.objects.filter(field=value).count() 计数</span></span><br><span class="line">    <span class="comment"># (13) model.objects.filter(field=value).values() 获取键值对结果</span></span><br><span class="line">    <span class="comment"># (14) model.objects.filter(field=value).values_list() 获取值结果</span></span><br><span class="line">    <span class="comment"># (15) model.objects.values(&quot;field&quot;).distinct() 对结果进行去重</span></span><br><span class="line">    <span class="comment"># (16) model.objects.filter(field=value).order_by(&quot;-filed&quot;) 降序</span></span><br><span class="line">    <span class="comment"># (17) model.objects.filter(field=value).order_by(&quot;filed&quot;) 升序</span></span><br><span class="line">    <span class="comment"># (18) model.objects.filter(field=value).exists() 判断结果是否存在</span></span><br><span class="line">    <span class="comment"># (19) model.objects.exclude(filed=value) 排除指定条件的数据</span></span><br></pre></td></tr></table></figure>
<ul>
<li>数据库信息</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4	jack	22	2024-06-25 13:02:38.766847	2024-06-25 13:02:38.766847</span><br><span class="line">5	jack	22	2024-06-25 13:02:43.551628	2024-06-25 13:02:43.551628</span><br><span class="line">6	tom	710	2024-06-25 13:03:09.526967	2024-06-25 13:03:09.526967</span><br><span class="line">7	tom	710	2024-06-25 13:03:11.030100	2024-06-25 13:03:11.030100</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240625213204352.png" alt="image-20240625213204352"></p>
<h2 id="【三】神奇的双下划线查询">【三】神奇的双下划线查询</h2>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 在main入口下面复制manage.py文件中main入口下面的第一行代码每一个Django项目都要自己去找 自己去复制</span></span><br><span class="line">    os.environ.setdefault(<span class="string">&#x27;DJANGO_SETTINGS_MODULE&#x27;</span>, <span class="string">&#x27;Django_two.settings&#x27;</span>)</span><br><span class="line">    <span class="comment"># 导入模块</span></span><br><span class="line">    <span class="keyword">import</span> django</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动方式只是临时启动，不是持久化</span></span><br><span class="line">    django.setup()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> UserInfo</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 神奇的双下划线</span></span><br><span class="line">    <span class="comment"># 大于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__gt=22)</span></span><br><span class="line">    <span class="comment"># # 两条数据符合</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 小于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__lt=22)</span></span><br><span class="line">    <span class="comment"># # 没有符合条件的</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet []&gt;</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment"># # 大于等于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__gte=22)</span></span><br><span class="line">    <span class="comment"># # 四条符合的数据</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;, &lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 小于等于</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__lte=22)</span></span><br><span class="line">    <span class="comment"># 两条条符合的数据</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 或条件</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__in=(18, 22))</span></span><br><span class="line">    <span class="comment"># # 两条条符合的数据</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 两个条件之间</span></span><br><span class="line">    <span class="comment"># 也包含18，22</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(age__range=(18, 22))</span></span><br><span class="line">    <span class="comment"># #两条条符合的数据</span></span><br><span class="line">    <span class="comment"># print(data)  # &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 模糊查询</span></span><br><span class="line">    <span class="comment"># 查人名中带有 m 的人的名字</span></span><br><span class="line">    <span class="comment"># 强约束 区分大小写</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__contains=&quot;m&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 弱约束 不区分大小写</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__icontains=&quot;M&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 以指定条件开头</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__startswith=&quot;t&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 以指定条件结尾</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(name__endswith=&quot;m&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询指定那一天</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(register_time__day=&quot;20&quot;)</span></span><br><span class="line">    <span class="comment"># print(data) # &lt;QuerySet []&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#  查询指定那一年</span></span><br><span class="line">    <span class="comment"># data = UserInfo.objects.filter(register_time__year=&quot;2024&quot;)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;UserInfo: UserInfo object (4)&gt;, &lt;UserInfo: UserInfo object (5)&gt;, &lt;UserInfo: UserInfo object (6)&gt;, &lt;UserInfo: UserInfo object (7)&gt;]&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询指定那一月</span></span><br><span class="line">    data = UserInfo.objects.<span class="built_in">filter</span>(register_time__month=<span class="string">&quot;5&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(data) <span class="comment"># &lt;QuerySet []&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>数据库信息</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">4	jack	22	2024-06-25 13:02:38.766847	2024-06-25 13:02:38.766847</span><br><span class="line">5	jack	22	2024-06-25 13:02:43.551628	2024-06-25 13:02:43.551628</span><br><span class="line">6	tom	710	2024-06-25 13:03:09.526967	2024-06-25 13:03:09.526967</span><br><span class="line">7	tom	710	2024-06-25 13:03:11.030100	2024-06-25 13:03:11.030100</span><br></pre></td></tr></table></figure>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cimage-20240625213204352.png" alt="image-20240625213204352"></p>
<h2 id="【四】创建多表关系">【四】创建多表关系</h2>
<ul>
<li>既然是多表查询，那就是不止一个表</li>
<li>在models.py文件中创建多个表</li>
<li>我们学过的表查询有
<ul>
<li>一对一查询</li>
<li>一对多查询</li>
<li>多对多查询</li>
</ul>
</li>
</ul>
<h3 id="【1】一对多的表">【1】一对多的表</h3>
<ul>
<li>ForeignKey方法创建一对多关系</li>
</ul>
<p>创建图书表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建的是图书表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几位</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类型</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版社</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>创建出版社表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建出版社表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Publisher</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br></pre></td></tr></table></figure>
<h3 id="【2】一对一的表">【2】一对一的表</h3>
<ul>
<li>OneToOneField方法创建一对一关系</li>
</ul>
<p>创建作者表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># # 创建作者表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Author</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField()</span><br><span class="line">    <span class="comment"># 作者和作者详情表进行关联，一对一关系，一个作者只能有一个详情</span></span><br><span class="line">    <span class="comment"># 一个详情对应一个作者</span></span><br><span class="line">    author_detail = models.OneToOneField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表,作者详情表</span></span><br><span class="line">        to=<span class="string">&quot;AuthorDetail&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<p>创建作者详情表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建作者详情表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AuthorDetail</span>(models.Model):</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 电话</span></span><br><span class="line">    phone = models.CharField(max_length=<span class="number">11</span>)</span><br></pre></td></tr></table></figure>
<h3 id="【3】多对多的表">【3】多对多的表</h3>
<ul>
<li>
<p>ManyToManyField方法创建多对多关系</p>
</li>
<li>
<p>需要第三张表存放两个表的关系</p>
</li>
</ul>
<p>创建图书表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建的是图书表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几位</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类型</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版社</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多对多的关系</span></span><br><span class="line">    auther = models.ManyToManyField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete = models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>创建作者表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建作者表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Author</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField()</span><br><span class="line">    <span class="comment"># 作者和作者详情表进行关联，一对一关系，一个作者只能有一个详情</span></span><br><span class="line">    <span class="comment"># 一个详情对应一个作者</span></span><br><span class="line">    author_detail = models.OneToOneField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表,作者详情表</span></span><br><span class="line">        to=<span class="string">&quot;AuthorDetail&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># 与作者建立的第三张表</span></span><br><span class="line">    book = models.ManyToManyField(</span><br><span class="line">        <span class="comment"># 跟那张表进行关联</span></span><br><span class="line">        to=<span class="string">&quot;Book&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>创建图书和作者表关系表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 作者和书的关系表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BookToAuthor</span>(models.Model):</span><br><span class="line">    <span class="comment"># 字段关联作者表</span></span><br><span class="line">    author = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 关联作者的表</span></span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line">    <span class="comment"># 字段关联图书的表</span></span><br><span class="line">    book = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 关联图书的表</span></span><br><span class="line">        to=<span class="string">&quot;Book&quot;</span>,</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="【4】多对多的表方法二">【4】多对多的表方法二</h3>
<ul>
<li>直接在这两张表的其中一张上建立第三张表</li>
</ul>
<p>比如我们在Book上建立</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几位</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类型</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版社</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多对多的关系</span></span><br><span class="line">    auther = models.ManyToManyField(</span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span></span><br><span class="line">    )</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 多对多的关系</span></span><br><span class="line">  auther = models.ManyToManyField(</span><br><span class="line">      to=<span class="string">&quot;Author&quot;</span></span><br><span class="line">  )</span><br></pre></td></tr></table></figure>
<ul>
<li>Django会自动创建第三张表</li>
</ul>
<h3 id="【5】总的创建表代码">【5】总的创建表代码</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建出版社表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Publisher</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建的是图书表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Book</span>(models.Model):</span><br><span class="line">    <span class="comment"># 标题</span></span><br><span class="line">    title = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 价格</span></span><br><span class="line">    <span class="comment"># max_digits：最多几位</span></span><br><span class="line">    <span class="comment"># decimal_places：最多小数点后面几位</span></span><br><span class="line">    <span class="comment"># DecimalField：小数类型</span></span><br><span class="line">    price = models.DecimalField(max_digits=<span class="number">8</span>, decimal_places=<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># 一对多关系，图书与出版社</span></span><br><span class="line">    publisher = models.ForeignKey(</span><br><span class="line">        <span class="comment"># 目标建立关系的表</span></span><br><span class="line">        to=<span class="string">&quot;Publisher&quot;</span>,</span><br><span class="line">        <span class="comment"># 级联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 多对多的关系</span></span><br><span class="line">    auther = models.ManyToManyField(</span><br><span class="line">        to=<span class="string">&quot;Author&quot;</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建作者详情表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">AuthorDetail</span>(models.Model):</span><br><span class="line">    <span class="comment"># 地址</span></span><br><span class="line">    addr = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 电话</span></span><br><span class="line">    phone = models.CharField(max_length=<span class="number">11</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># # 创建作者表</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Author</span>(models.Model):</span><br><span class="line">    <span class="comment"># 名字</span></span><br><span class="line">    name = models.CharField(max_length=<span class="number">32</span>)</span><br><span class="line">    <span class="comment"># 年龄</span></span><br><span class="line">    age = models.IntegerField()</span><br><span class="line">    <span class="comment"># 作者和作者详情表进行关联，一对一关系，一个作者只能有一个详情</span></span><br><span class="line">    <span class="comment"># 一个详情对应一个作者</span></span><br><span class="line">    author_detail = models.OneToOneField(</span><br><span class="line">        <span class="comment"># 目标建立关系的表,作者详情表</span></span><br><span class="line">        to=<span class="string">&quot;AuthorDetail&quot;</span>,</span><br><span class="line">        <span class="comment"># 联更新和级联删除，和并在一起了</span></span><br><span class="line">        on_delete=models.CASCADE</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"><span class="comment"># 记得迁移数据库</span></span><br></pre></td></tr></table></figure>
<h2 id="【五】一对多的外键字段">【五】一对多的外键字段</h2>
<h3 id="【1】添加值">【1】添加值</h3>
<ul>
<li>create</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 【一】一对多表外键字段</span></span><br><span class="line">   <span class="comment"># 【1】添加数据  create</span></span><br><span class="line">   <span class="comment">#  Publish.objects.create(name=&quot;人民出版社&quot;, addr=&quot;北京&quot;)</span></span><br><span class="line">   <span class="comment"># Publish.objects.create(name=&quot;上海出版社&quot;, addr=&quot;上海&quot;)</span></span><br><span class="line">   <span class="comment"># Publish.objects.create(name=&quot;南京出版社&quot;, addr=&quot;南京&quot;)</span></span><br><span class="line">   <span class="comment"># Publish.objects.create(name=&quot;东京出版社&quot;, addr=&quot;东京&quot;)</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 在创建图书数据的时候要进行出版社的关联</span></span><br><span class="line">   <span class="comment"># publish_obj = Publish.objects.get(pk=2)</span></span><br><span class="line">   <span class="comment"># 方式一 ： 直接在 字段 publish_id 值是指定出版社的id</span></span><br><span class="line">   <span class="comment"># Book.objects.create(title=&quot;西游记&quot;, price=&quot;99&quot;,publish_id=publish_obj.id)</span></span><br><span class="line">   <span class="comment"># 方式二 ： 在模型表中定义的字段是叫 publish 所以 直接将对象扔进去</span></span><br><span class="line">   <span class="comment"># Book.objects.create(title=&quot;红楼梦&quot;, price=&quot;88&quot;, publish=publish_obj)</span></span><br></pre></td></tr></table></figure>
<h3 id="【2】删除数据">【2】删除数据</h3>
<ul>
<li>delete</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 【2】删除数据--删除外键关系  delete</span></span><br><span class="line">    <span class="comment"># book中的publisher字段</span></span><br><span class="line">    <span class="comment"># 因为你在创建的时候已经添加了级联更新和级联删除所以你删除信息和修改信息都会发生变化</span></span><br><span class="line">    <span class="comment"># Book.objects.get(pk=&quot;1&quot;).delete()# 删除了book id为1的数据</span></span><br><span class="line">    <span class="comment"># Publisher.objects.get(pk=&quot;1&quot;).delete()# 删除了出版社的id，对应的图书也一并被删掉了</span></span><br><span class="line">    <span class="comment"># 删除外键数据 出版社表中的数据 在图书表中 预支相关联的数据也会被删除</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="【3】修改外键字段">【3】修改外键字段</h3>
<ul>
<li>update</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 【3】修改外键字段 update</span></span><br><span class="line">   <span class="comment"># 我们将红楼梦从1出版社转到3出版社该怎么做</span></span><br><span class="line">   <span class="comment"># 方法一</span></span><br><span class="line">   <span class="comment"># 我们先获得出版社的一个id</span></span><br><span class="line">   <span class="comment"># publisher_obj = Publisher.objects.get(pk=&quot;4&quot;)</span></span><br><span class="line"></span><br><span class="line">   <span class="comment"># Book.objects.filter(title=&quot;红楼梦&quot;).update(publisher=publisher_obj)</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 方法二</span></span><br><span class="line">   <span class="comment"># 直接替换,指定书的id，替换指定印刷厂的id</span></span><br><span class="line">   <span class="comment"># id不存在就会报错</span></span><br><span class="line">   <span class="comment"># books = Book.objects.filter(pk=6).update(publisher_id=6)</span></span><br><span class="line"><span class="comment"># 也可以放对象</span></span><br></pre></td></tr></table></figure>
<h2 id="【六】多对多的外键字段">【六】多对多的外键字段</h2>
<h3 id="【1】添加数据">【1】添加数据</h3>
<ul>
<li>一定要保证两个表里面有值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 图书和作者表</span></span><br><span class="line">    <span class="comment"># for i in range(1, 6):</span></span><br><span class="line">    <span class="comment">#     detail_obj = AuthorDetail.objects.create(addr=f&quot;上海_&#123;i&#125;&quot;, phone=f&quot;1&#123;i&#125;0&quot;)</span></span><br><span class="line">    <span class="comment">#     # print(detail_obj) # AuthorDetail object (1)</span></span><br><span class="line">    <span class="comment">#     Author.objects.create(name=f&quot;dream_&#123;i&#125;&quot;, age=18 * i, author_detail=detail_obj)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># for i in range(1, 6):</span></span><br><span class="line">    <span class="comment">#     Book.objects.create(</span></span><br><span class="line">    <span class="comment">#         title=f&quot;第 &#123;i&#125; 本书&quot;,</span></span><br><span class="line">    <span class="comment">#         price=str(60 * i),</span></span><br><span class="line">    <span class="comment">#         publish_id=random.randint(2, 6)</span></span><br><span class="line">    <span class="comment">#     )</span></span><br></pre></td></tr></table></figure>
<ul>
<li>要使用Django自带的机制自动生成的第三张表，models不会有第三张表</li>
<li>需要跨表建立关系</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获得书籍对象</span></span><br><span class="line">    data = book_obj = Book.objects.get(pk=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获得作者对象</span></span><br><span class="line">    data = auther_obj = Author.objects.get(pk=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">     <span class="comment"># 【1】添加多对多外键关系---关键字add</span></span><br><span class="line">    <span class="comment"># 方式一</span></span><br><span class="line">    <span class="comment"># 给book_obj书籍添加一个作者</span></span><br><span class="line">    <span class="comment"># 获得书籍对象，在获得作者对象，书籍对象在跨到作者身上</span></span><br><span class="line">    <span class="comment"># 你的第三章表建立建立谁的身上了就得到谁的对象然后在把和你建立多对多关系的表添加进去</span></span><br><span class="line">    <span class="comment"># data = book_obj.auther.add(auther_obj)</span></span><br><span class="line">    <span class="comment"># print(data)</span></span><br><span class="line">    <span class="comment"># 方式二 直接放作者的id号</span></span><br><span class="line">    <span class="comment"># book_obj.auther.add(1, 3,6,4,5)</span></span><br></pre></td></tr></table></figure>
<h3 id="【2】删除数据-2">【2】删除数据</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获得书籍对象</span></span><br><span class="line">    data = book_obj = Book.objects.get(pk=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获得作者对象</span></span><br><span class="line">    data = auther_obj = Author.objects.get(pk=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 【2】删除多对多外键关系 remove</span></span><br><span class="line">    <span class="comment"># book_obj.auther.remove(auther_obj)</span></span><br><span class="line">    <span class="comment"># 删除多个，直接给作者的id</span></span><br><span class="line">    <span class="comment"># book_obj.auther.remove(3, 1)</span></span><br></pre></td></tr></table></figure>
<h3 id="【3】修改外键关系">【3】修改外键关系</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获得书籍对象</span></span><br><span class="line">   data = book_obj = Book.objects.get(pk=<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 获得作者对象</span></span><br><span class="line">   data = auther_obj = Author.objects.get(pk=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 【3】修改外键关系---》set</span></span><br><span class="line">   <span class="comment"># 方式一 用set方法，弊端就是会清空其他的外键关系</span></span><br><span class="line">   <span class="comment"># set关键字是一个列表</span></span><br><span class="line">   <span class="comment"># 修改了数据，保留了book_obj是16对应的3，其他的book_obj对应的书籍被清空，</span></span><br><span class="line">   <span class="comment"># book_obj.auther.set([3])</span></span><br><span class="line">   <span class="comment"># 方式二 先用 remove 移除外键关系 再用 add 添加外键关系</span></span><br><span class="line">   <span class="comment"># book_obj.auther.remove(auther_obj)</span></span><br><span class="line">   <span class="comment"># book_obj.auther.add(auther_obj)</span></span><br></pre></td></tr></table></figure>
<h1>多表查询（正反向查询）</h1>
<h2 id="【一】什么是正反向查询">【一】什么是正反向查询</h2>
<h3 id="【1】正向查询">【1】正向查询</h3>
<ul>
<li>外键字段在自己身上就叫正向查询
<ul>
<li>有外键关系的两张表 从有外检字段的表向另一张无外键字段的表查询数据的时候就是正向</li>
</ul>
</li>
<li>正向查询的时候，直接按照字段查询</li>
</ul>
<h3 id="【2】反向查询">【2】反向查询</h3>
<ul>
<li>外键字段不在自己身上，我查你就叫反向查询
<ul>
<li>有外键关系的两张表 从无外键字段的表向另一张有外键字段表查询数据的时候就是反向</li>
</ul>
</li>
<li>反向查询的时候，要使用关键字_set</li>
</ul>
<h2 id="【二】多表查询案例">【二】多表查询案例</h2>
<h3 id="【1】子查询（基于对象的跨表查询）">【1】子查询（基于对象的跨表查询）</h3>
<h4 id="（1）查询书籍主键为14的出版社">（1）查询书籍主键为14的出版社</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查询书籍主键为1的出版社</span></span><br><span class="line">   <span class="comment">#得到图书对象</span></span><br><span class="line">   book_obj = Book.objects.get(pk=<span class="number">14</span>)</span><br><span class="line">   <span class="comment">#图书与出版社是一对多关系</span></span><br><span class="line">   <span class="built_in">print</span>(book_obj)  <span class="comment"># Book object (14)</span></span><br><span class="line">   <span class="comment">#不要带_id</span></span><br><span class="line">   publisher_id = book_obj.publisher_id</span><br><span class="line">   <span class="built_in">print</span>(publisher_id)  <span class="comment"># 6</span></span><br><span class="line">   <span class="comment">#得到出版社对象</span></span><br><span class="line">   publisher_obj = book_obj.publisher</span><br><span class="line">   <span class="built_in">print</span>(publisher_obj)  <span class="comment"># Publisher object (6)</span></span><br><span class="line">   <span class="comment">#对象.name得到出版社</span></span><br><span class="line">   publisher_name = book_obj.publisher.name</span><br><span class="line">   <span class="built_in">print</span>(publisher_name)  <span class="comment"># 4出版社</span></span><br></pre></td></tr></table></figure>
<h4 id="（2）查询数据主键为1的作者">（2）查询数据主键为1的作者</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键为1的作者</span></span><br><span class="line">  <span class="comment"># 书籍与作者是多对多关系</span></span><br><span class="line">  <span class="comment"># 得到主键id为1的对象</span></span><br><span class="line">  book_obj = Book.objects.<span class="built_in">filter</span>(pk=<span class="number">1</span>).first()</span><br><span class="line">  <span class="built_in">print</span>(book_obj) <span class="comment"># Book object (1)</span></span><br><span class="line">  res = book_obj.auther</span><br><span class="line">  <span class="built_in">print</span>(res)  <span class="comment"># user.Author.None</span></span><br><span class="line">  auther_obj = book_obj.auther.<span class="built_in">all</span>()</span><br><span class="line">  <span class="built_in">print</span>(auther_obj)  <span class="comment"># &lt;QuerySet [&lt;Author: Author object (2)&gt;]&gt;</span></span><br><span class="line">  author_obj = book_obj.auther.<span class="built_in">all</span>().values(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(author_obj)  <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom2&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-查询作者主键为3的电话号码">(3)查询作者主键为3的电话号码</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询作者主键为3的电话号码</span></span><br><span class="line">   <span class="comment"># 得到作者对象</span></span><br><span class="line">   <span class="comment"># 作者与作者详情是一对一关系</span></span><br><span class="line">   author_obj = Author.objects.<span class="built_in">filter</span>(pk=<span class="number">3</span>).first()</span><br><span class="line">   <span class="built_in">print</span>(author_obj)  <span class="comment"># Author object (3)</span></span><br><span class="line">   <span class="comment"># 得到作者详情对象</span></span><br><span class="line">   author_detail_obj = author_obj.author_detail</span><br><span class="line">   <span class="built_in">print</span>(author_detail_obj)  <span class="comment"># AuthorDetail object (3)</span></span><br><span class="line">   <span class="comment"># 对象.字段</span></span><br><span class="line">   phone = author_detail_obj.phone</span><br><span class="line">   <span class="built_in">print</span>(phone)  <span class="comment"># 130</span></span><br></pre></td></tr></table></figure>
<h4 id="4-查询出版社是-1出版社-的书">(4)查询出版社是  1出版社  的书</h4>
<ul>
<li>在下面<code>res</code>只是一个待执行的查询的“准备”状态</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询出版社是  1出版社  的书</span></span><br><span class="line">   <span class="comment"># 出版社与书是多对一关系</span></span><br><span class="line">   <span class="comment"># 没有外键关系的表要向有外键关系的表查，就是反向查询加_set</span></span><br><span class="line">   <span class="comment"># 得到出版社对象</span></span><br><span class="line">   publisher_obj = Publisher.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;1出版社&quot;</span>).first()</span><br><span class="line">   <span class="built_in">print</span>(publisher_obj)  <span class="comment"># Publisher object (2)</span></span><br><span class="line">   <span class="comment"># 反向查询加_set</span></span><br><span class="line">   <span class="comment"># 只是一个执行状态的准备，并没有进行查询</span></span><br><span class="line">   res = publisher_obj.book_set</span><br><span class="line">   <span class="built_in">print</span>(res)  <span class="comment"># user.Book.None</span></span><br><span class="line">   <span class="comment"># 得到图书对象</span></span><br><span class="line">   book_obj = publisher_obj.book_set.<span class="built_in">all</span>()</span><br><span class="line">   <span class="built_in">print</span>(book_obj)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br><span class="line">   <span class="comment"># values得到想要的数据</span></span><br><span class="line">   publisher_name = publisher_obj.book_set.<span class="built_in">all</span>().values(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(publisher_name)  <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;第1本书&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="（5）查询作者是tom1写过的书">（5）查询作者是tom1写过的书</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询作者是tom1写过的书</span></span><br><span class="line">   <span class="comment"># 作者和图书是多对多关系</span></span><br><span class="line">   <span class="comment"># 得到作者的对象</span></span><br><span class="line">   author_obj = Author.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;tom1&quot;</span>).first()</span><br><span class="line">   <span class="built_in">print</span>(author_obj)  <span class="comment"># Author object (1)</span></span><br><span class="line">   <span class="comment"># 得到图书对象</span></span><br><span class="line">   book_obj = author_obj.book_set</span><br><span class="line">   <span class="built_in">print</span>(book_obj)  <span class="comment"># user.Book.None</span></span><br><span class="line">   <span class="comment"># 得到图书的名字</span></span><br><span class="line">   book_name = author_obj.book_set.<span class="built_in">all</span>().values(<span class="string">&quot;title&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(book_name)  <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;第3本书&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="6-查询手机号是110的作者姓名">(6)查询手机号是110的作者姓名</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询手机号是110的作者姓名</span></span><br><span class="line">    <span class="comment"># 作者和作者详情是一对一关系</span></span><br><span class="line">    <span class="comment"># 得到作者详情对象</span></span><br><span class="line">    author_detail_obj = AuthorDetail.objects.<span class="built_in">filter</span>(phone=<span class="number">110</span>).first()</span><br><span class="line">    <span class="built_in">print</span>(author_detail_obj)</span><br><span class="line">    <span class="comment"># 主键在作者身上，反向查询，但是是一对一关系，不需要加_set</span></span><br><span class="line">    author_obj = author_detail_obj.author</span><br><span class="line">    <span class="built_in">print</span>(author_obj)  <span class="comment"># Author object (1)</span></span><br><span class="line">    <span class="comment"># 得到作者的名字</span></span><br><span class="line">    author_name = author_obj.name</span><br><span class="line">    <span class="built_in">print</span>(author_name)  <span class="comment"># tom1</span></span><br></pre></td></tr></table></figure>
<h4 id="7-小结">(7)小结</h4>
<ul>
<li>基于对象的反向查询</li>
<li>什么时候需要加_set.all()
<ul>
<li>查询结果是多个的时候需要加</li>
</ul>
</li>
<li>一对一表关系不区分正反向 因为关系唯一</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正向查询：有外键字段向没有外键字段的表查 查询方式是 .字段名</span></span><br><span class="line"><span class="comment"># 反向查询：没有外键字段向有外键字段的表查 查询方式时 .有外键字段的表明_set</span></span><br></pre></td></tr></table></figure>
<h3 id="【2】联表查询">【2】联表查询</h3>
<ul>
<li>基于双下划线的跨表查询</li>
<li>联表查询就是将两张表合并在一起查询数据</li>
</ul>
<h4 id="（1）查询tom1的手机号和作者的名字">（1）查询tom1的手机号和作者的名字</h4>
<ul>
<li>
<p>正向查询</p>
</li>
<li>
<p>使用双下划线（查询信息的表明__字段）</p>
</li>
<li>
<p>查询到作者信息在.value.(需要查询信息的表__需要查询的字段,其他字段)</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询tom1的手机号和作者的名字</span></span><br><span class="line">   <span class="comment"># 正向查询</span></span><br><span class="line">   <span class="comment"># 作者和作者详情是一对一关系</span></span><br><span class="line">   name_phone = Author.objects.<span class="built_in">filter</span>(name=<span class="string">&quot;tom1&quot;</span>).values(</span><br><span class="line">       <span class="string">&quot;name&quot;</span>,</span><br><span class="line">       <span class="string">&quot;author_detail__phone&quot;</span></span><br><span class="line">   )</span><br><span class="line">   <span class="built_in">print</span>(name_phone)</span><br><span class="line">   <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom1&#x27;, &#x27;author_detail__phone&#x27;: &#x27;110&#x27;&#125;]&gt;</span></span><br><span class="line">   <span class="comment"># first：取到单个数据</span></span><br><span class="line">   author_dict = name_phone.first()</span><br><span class="line">   <span class="built_in">print</span>(author_dict)  <span class="comment"># &#123;&#x27;name&#x27;: &#x27;tom1&#x27;, &#x27;author_detail__phone&#x27;: &#x27;110&#x27;&#125;</span></span><br><span class="line">   <span class="comment"># 取到名字</span></span><br><span class="line">   name = name_phone.first().get(<span class="string">&quot;name&quot;</span>)</span><br><span class="line">   <span class="built_in">print</span>(name)  <span class="comment"># tom1</span></span><br></pre></td></tr></table></figure>
<ul>
<li>反向查询</li>
<li>先拿到详情，再用作者详情关联作者表，通过 __字段的方法 过滤出我们想要的指定数据</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询tom1的手机号和作者的名字</span></span><br><span class="line">    <span class="comment"># 反向查询</span></span><br><span class="line">    phone_name = AuthorDetail.objects.<span class="built_in">filter</span>(author__name=<span class="string">&quot;tom1&quot;</span>).values(</span><br><span class="line">        <span class="string">&quot;phone&quot;</span>,</span><br><span class="line">        <span class="string">&quot;author__name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(phone_name)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;phone&#x27;: &#x27;110&#x27;, &#x27;author__name&#x27;: &#x27;tom1&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="（2）查询书籍主键为1的出版社的名字和书的名字">（2）查询书籍主键为1的出版社的名字和书的名字</h4>
<ul>
<li>正向查询</li>
<li>先过滤出书籍ID为1的书籍对象，再去关联出版者表，利用__字段取值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键为1的出版社的名字和书的名字</span></span><br><span class="line">    <span class="comment"># 正向查询</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(pk=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;title&quot;</span>,</span><br><span class="line">        <span class="string">&quot;publisher__name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;第1本书&#x27;, &#x27;publisher__name&#x27;: &#x27;1出版社&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>反向查询</li>
<li>先查询到指定出版社，再从出版社反向找到书籍名字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键为1的出版社的名字和书的名字</span></span><br><span class="line">    <span class="comment"># 反向查询</span></span><br><span class="line">    data = Publisher.objects.<span class="built_in">filter</span>(book__id=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;name&quot;</span>,</span><br><span class="line">        <span class="string">&quot;book__title&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;1出版社&#x27;, &#x27;book__title&#x27;: &#x27;第1本书&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-查询书籍主键为1的作者的名字">(3)查询书籍主键为1的作者的名字</h4>
<ul>
<li>正向</li>
<li>先拿到 书籍主键ID为1的对象，再关联作者信息表，通过__字段取值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键为1的作者的名字</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(pk=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;auther__name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;auther__name&#x27;: &#x27;tom2&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>反向</li>
<li>先拿到 书籍ID为1的作者数据再去取作者的名字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键为1的作者的名字</span></span><br><span class="line">    data = Author.objects.<span class="built_in">filter</span>(book__id=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;name&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom2&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="4-查询书籍主键为1的作者的手机号">(4)查询书籍主键为1的作者的手机号</h4>
<ul>
<li>跨越了三个表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询书籍主键为1的作者的手机号</span></span><br><span class="line">    data = Author.objects.<span class="built_in">filter</span>(book__id=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;author_detail__phone&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;author_detail__phone&#x27;: &#x27;120&#x27;&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="（5）小结">（5）小结</h4>
<ul>
<li>掌握了双下划线和正反向可以无限跨表</li>
</ul>
<h2 id="【三】聚合函数（aggregate）">【三】聚合函数（aggregate）</h2>
<ul>
<li>
<p>正常情况下我们需要进行分组才能进行聚合函数的运算</p>
</li>
<li>
<p>使用聚合函数时：利用关键字aggregate可以不分组进行某个字段的聚合函数</p>
</li>
</ul>
<h3 id="【1】引入聚合函数">【1】引入聚合函数</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Max, Min, Sum, Count, Avg</span><br></pre></td></tr></table></figure>
<h3 id="【2】聚合函数案例">【2】聚合函数案例</h3>
<ul>
<li>第一步需要先导入聚合函数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Max, Min, Sum, Count, Avg</span><br></pre></td></tr></table></figure>
<h4 id="1-求所有书的平均价格">(1)求所有书的平均价格</h4>
<ul>
<li>利用聚合函数不用分组就可以的到的结果的方法：aggregate</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求所有书的平均数</span></span><br><span class="line">    <span class="keyword">from</span> django.db.models <span class="keyword">import</span> Sum, Avg</span><br><span class="line">    book_avg_price = Book.objects.aggregate(Avg(<span class="string">&quot;price&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(book_avg_price)</span><br><span class="line">    <span class="comment"># &#123;&#x27;price__avg&#x27;: Decimal(&#x27;60.000000&#x27;)&#125;</span></span><br><span class="line">    <span class="keyword">from</span> django.db.models <span class="keyword">import</span> Sum, Avg</span><br><span class="line">    book_avg_price = Book.objects.aggregate(Avg(<span class="string">&quot;price&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(book_avg_price)</span><br><span class="line">    <span class="comment"># &#123;&#x27;price__avg&#x27;: Decimal(&#x27;60.000000&#x27;)&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-一次性用很多方法">(2)一次性用很多方法</h4>
<ul>
<li>利用聚合函数不用分组就可以的到的结果的方法：aggregate</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Sum, Avg, Max, Min, Count</span><br><span class="line"></span><br><span class="line">    book_avg_price = Book.objects.aggregate(Avg(<span class="string">&quot;price&quot;</span>), Max(<span class="string">&quot;price&quot;</span>), Min(<span class="string">&quot;price&quot;</span>), Sum(<span class="string">&quot;price&quot;</span>), Count(<span class="string">&quot;price&quot;</span>))</span><br><span class="line">    <span class="built_in">print</span>(book_avg_price)</span><br><span class="line">    <span class="comment"># &#123;&#x27;price__avg&#x27;: Decimal(&#x27;60.000000&#x27;), &#x27;price__max&#x27;: Decimal(&#x27;100.00&#x27;), &#x27;price__min&#x27;: Decimal(&#x27;20.00&#x27;), &#x27;price__sum&#x27;: Decimal(&#x27;300.00&#x27;), &#x27;price__count&#x27;: 5&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="【四】分组查询（关键字：annotate）">【四】分组查询（关键字：annotate）</h2>
<h3 id="【1】引入">【1】引入</h3>
<ul>
<li>按照指定条件对数据进行分组</li>
</ul>
<h3 id="【2】分组查询语法">【2】分组查询语法</h3>
<ul>
<li>models 后面跟的是什么，就是按什么分组</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">res = models.Book.objects.annotate()</span><br></pre></td></tr></table></figure>
<h3 id="【3】案例">【3】案例</h3>
<h4 id="（1）统计每一本书的作者个数">（1）统计每一本书的作者个数</h4>
<ul>
<li>Book分组，然后计算作者的个数</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line"><span class="keyword">from</span> user.models <span class="keyword">import</span> Book</span><br><span class="line">   <span class="comment"># 统计每一本书的作者个数</span></span><br><span class="line">   <span class="comment"># 一定要看你的字段名写错了没，错了就会找不到数据</span></span><br><span class="line">   <span class="comment"># 获得分组后的对象</span></span><br><span class="line">   data = Book.objects.annotate(author_number=Count(<span class="string">&quot;auther&quot;</span>))</span><br><span class="line">   <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;, &lt;Book: Book object (2)&gt;, &lt;Book: Book object (15)&gt;, &lt;Book: Book object (16)&gt;, &lt;Book: Book object (17)&gt;]&gt;</span></span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 获得分组后的数据</span></span><br><span class="line">   data = Book.objects.annotate(author_number=Count(<span class="string">&quot;auther&quot;</span>)).values(</span><br><span class="line">       <span class="string">&quot;title&quot;</span>,</span><br><span class="line">       <span class="string">&quot;author_number&quot;</span></span><br><span class="line">   )</span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;第1本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;第2本书&#x27;, &#x27;author_number&#x27;: 0&#125;, &#123;&#x27;title&#x27;: &#x27;第3本书&#x27;, &#x27;author_number&#x27;: 4&#125;, &#123;&#x27;title&#x27;: &#x27;第4本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;第5本书&#x27;, &#x27;author_number&#x27;: 0&#125;]&gt;</span></span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   </span><br><span class="line">   <span class="comment"># 等价于</span></span><br><span class="line">    data = Book.objects.annotate(author_number=Count(<span class="string">&quot;auther__pk&quot;</span>)).values(</span><br><span class="line">       <span class="string">&quot;title&quot;</span>,</span><br><span class="line">       <span class="string">&quot;author_number&quot;</span></span><br><span class="line">   )</span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;第1本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;第2本书&#x27;, &#x27;author_number&#x27;: 0&#125;, &#123;&#x27;title&#x27;: &#x27;第3本书&#x27;, &#x27;author_number&#x27;: 4&#125;, &#123;&#x27;title&#x27;: &#x27;第4本书&#x27;, &#x27;author_number&#x27;: 1&#125;, &#123;&#x27;title&#x27;: &#x27;第5本书&#x27;, &#x27;author_number&#x27;: 0&#125;]&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="（2）统计每个出版社最便宜的书的价格">（2）统计每个出版社最便宜的书的价格</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line"><span class="keyword">from</span> user.models <span class="keyword">import</span>  Publisher</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计每个出版社最便宜的书的价格</span></span><br><span class="line">data = Publisher.objects.annotate(min_book_price=Min(<span class="string">&#x27;book__price&#x27;</span>)).values(</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>,</span><br><span class="line">    <span class="string">&quot;min_book_price&quot;</span></span><br><span class="line">)</span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line"><span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;1出版社&#x27;, &#x27;min_book_price&#x27;: Decimal(&#x27;20.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;4出版社&#x27;, &#x27;min_book_price&#x27;: Decimal(&#x27;40.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;2出版社&#x27;, &#x27;min_book_price&#x27;: Decimal(&#x27;80.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;3出版社&#x27;, &#x27;min_book_price&#x27;: Decimal(&#x27;100.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;5出版社&#x27;, &#x27;min_book_price&#x27;: None&#125;]&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="（3）统计不止一个作者的图书">（3）统计不止一个作者的图书</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> Book</span><br><span class="line">    <span class="comment"># 统计不止一个作者的图书</span></span><br><span class="line">    <span class="comment"># 先按图书分组</span></span><br><span class="line">    <span class="comment"># 再筛选不止一个作者的图书</span></span><br><span class="line">    data = Book.objects.annotate(one_author=Count(<span class="string">&quot;auther&quot;</span>)).<span class="built_in">filter</span>(one_author__gt=<span class="number">1</span>).values(</span><br><span class="line">        <span class="string">&quot;title&quot;</span>,</span><br><span class="line">        <span class="string">&quot;one_author&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&#123;&#x27;title&#x27;: &#x27;第3本书&#x27;, &#x27;one_author&#x27;: 4&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="4-查询每个作者出的书总价格">(4)查询每个作者出的书总价格</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Count, Avg, Max, Min, Sum</span><br><span class="line">    <span class="keyword">from</span> user.models <span class="keyword">import</span> Author</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询每个作者出的书总价格</span></span><br><span class="line">    data = Author.objects.annotate(sum_book_price=Sum(<span class="string">&quot;book__price&quot;</span>)).values(</span><br><span class="line">        <span class="string">&quot;name&quot;</span>,</span><br><span class="line">        <span class="string">&quot;sum_book_price&quot;</span></span><br><span class="line">    )</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&#123;&#x27;name&#x27;: &#x27;tom2&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;80.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;tom1&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;60.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;tom3&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;140.00&#x27;)&#125;, &#123;&#x27;name&#x27;: &#x27;tom4&#x27;, &#x27;sum_book_price&#x27;: Decimal(&#x27;60.00&#x27;)&#125;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="5-小结">(5)小结</h4>
<ul>
<li>
<p>下面这个语法</p>
</li>
<li>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Book.objects.values(<span class="string">&#x27;price&#x27;</span>).annotate()</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>如果annotate前面没东西，则会按照Book进行分组,如果前面有参数就会按照前面的参数’price’进行分组</p>
</li>
</ul>
<h2 id="【五】F和Q查询">【五】F和Q查询</h2>
<h3 id="【1】引入-2">【1】引入</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> <span class="keyword">from</span> django.db.models <span class="keyword">import</span> F, Q</span><br></pre></td></tr></table></figure>
<h3 id="【2】F查询">【2】F查询</h3>
<ul>
<li>能够帮你获取到列表中的某个字段对应的数据</li>
<li>注意：在操作字符串类型的时候，F查询不能够直接做到字符串的拼接</li>
</ul>
<h4 id="（1）查询库存数大于销量的书籍">（1）查询库存数大于销量的书籍</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># F 查询 : 帮助我们直接获取到表中的某个字段对应的数据</span></span><br><span class="line">res = models.Book.objects.<span class="built_in">filter</span>(sales__gt=F(<span class="string">&#x27;stock&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(res)  <span class="comment"># &lt;QuerySet [&lt;Book: 水浒传&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="（2）将所有的书籍价格提升100">（2）将所有的书籍价格提升100</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> user.models <span class="keyword">import</span> Book</span><br><span class="line">   <span class="keyword">from</span> django.db.models <span class="keyword">import</span> F</span><br><span class="line"></span><br><span class="line">   <span class="comment"># 将所有的书籍价格提升100</span></span><br><span class="line">   data = Book.objects.update(price=F(<span class="string">&quot;price&quot;</span>) + <span class="number">100</span>)</span><br><span class="line">   <span class="built_in">print</span>(data)</span><br><span class="line">   <span class="comment"># 5</span></span><br><span class="line">   <span class="comment"># 代表更新了5条数据</span></span><br></pre></td></tr></table></figure>
<h4 id="3-将所有的数据后面添加-nb">(3)将所有的数据后面添加_nb</h4>
<ul>
<li>
<p>Value 是一个用于在查询中插入静态值的类，这个值可以是任何Django支持的数据库数据类型</p>
<ul>
<li>
<pre><code class="language-python">from django.db.models import Value
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- Concat:在操作字符串的时候F查询不能直接操作字符串，需要引入这个方法</span><br><span class="line"></span><br><span class="line">  - ````python</span><br><span class="line">    from django.db.models.functions import Concat</span><br><span class="line">    ````</span><br><span class="line"></span><br><span class="line">```python</span><br><span class="line">from user.models import Book</span><br><span class="line">    from django.db.models import F</span><br><span class="line">    from django.db.models import Value</span><br><span class="line">    from django.db.models.functions import Concat</span><br><span class="line">    # 将所有的书籍后面添加_nb</span><br><span class="line">    # 在操作字符串的时候F查询不能直接操作字符串，需要引入一个方法，Concat</span><br><span class="line">    # Value：Value 是一个用于在查询中插入静态值的类，这个值可以是任何Django支持的数据库数据类型</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    data = Book.objects.update(title=Concat(F(&quot;title&quot;),Value(&#x27;_nb&#x27;)))</span><br><span class="line">    print(data)</span><br><span class="line">    # 5</span><br><span class="line">    # 更新了5条数据</span><br></pre></td></tr></table></figure>

</code></pre>
</li>
</ul>
</li>
</ul>
<h3 id="【3】Q查询">【3】Q查询</h3>
<ul>
<li>关键字filter()方法中的关键字参数查询都是一起进行’and’</li>
<li>如果你需要执行更复杂的查询(列如ORM语句)，你可以使用Q对象</li>
</ul>
<h4 id="1-查询卖出数大于100或者价格小于500的书籍">(1)查询卖出数大于100或者价格小于500的书籍</h4>
<ul>
<li>直接使用 filter 查询数据，逗号隔开,里面放的参数是 and 关系</li>
<li>两个条件都必须符合</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询卖出数大于100或者价格小于500的书籍</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(sales__gt=<span class="number">100</span>, price__lt=<span class="number">500</span>)</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>直接使用 Q 查询数据，逗号隔开,里面放的参数还是 and 关系
<ul>
<li>两个条件都必须成立</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = Book.objects.<span class="built_in">filter</span>(Q(sales__gt=<span class="number">100</span>), Q(price__lt=<span class="number">500</span>))</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>直接使用 Q 查询数据，逗号可以换成其他连接符达到效果</p>
<ul>
<li>
<p>or：任一个条件符合即可</p>
</li>
<li>
<p>关键字作为连接符，会阉割条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = Book.objects.<span class="built_in">filter</span>(Q(sales__gt=<span class="number">100</span>) <span class="keyword">or</span> Q(price__lt=<span class="number">500</span>))</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>|：或关系</p>
<ul>
<li>有一个成立就可以</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data = Book.objects.<span class="built_in">filter</span>(Q(sales__gt=<span class="number">100</span>) | Q(price__lt=<span class="number">500</span>))</span><br><span class="line">    <span class="built_in">print</span>(data) <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="（2）Q的高阶用法">（2）Q的高阶用法</h4>
<ul>
<li>
<p>能够将查询条件的左边也变成 字符串形式</p>
</li>
<li>
<p>自己创造查询条件</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db.models <span class="keyword">import</span> Q</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 查询卖出数大于100或者价格小于500的书籍</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 生成Q对象</span></span><br><span class="line">    q = Q()</span><br><span class="line">    <span class="comment"># 创建Q对象的连接条件</span></span><br><span class="line">    <span class="comment"># or：满足一个条件即可</span></span><br><span class="line">    <span class="comment"># and: 两个条件都要满足</span></span><br><span class="line">    <span class="comment"># 默认是and关系</span></span><br><span class="line">    q.connector = <span class="string">&quot;or&quot;</span></span><br><span class="line">    <span class="comment"># 添加第一个加条件--&gt;左边</span></span><br><span class="line">    q.children.append((<span class="string">&quot;sales__gt&quot;</span>, <span class="number">100</span>))</span><br><span class="line">    <span class="comment"># 添加第二个加条件--&gt;右边</span></span><br><span class="line">    q.children.append((<span class="string">&quot;price__lt&quot;</span>, <span class="number">500</span>))</span><br><span class="line">    <span class="comment"># 查询</span></span><br><span class="line">    <span class="comment"># filter 除了可以放条件 还可以放对象</span></span><br><span class="line">    data = Book.objects.<span class="built_in">filter</span>(q)</span><br><span class="line">    <span class="built_in">print</span>(data)  <span class="comment"># &lt;QuerySet [&lt;Book: Book object (1)&gt;]&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>可以在去对象内 children里面 无限制的添加元素 添加元组，元组里两个元素</p>
</li>
<li>
<p>而且还支持修改 or 、and</p>
</li>
<li>
<p>默认是and</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 或查询</span></span><br><span class="line">q = Q()</span><br><span class="line">q |= Q(条件一)</span><br><span class="line">q |= Q(条件二)</span><br><span class="line">qs = Model.objects.<span class="built_in">filter</span>(q)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 并查询</span></span><br><span class="line">q = Q()</span><br><span class="line">q &amp;= Q(条件一)</span><br><span class="line">q &amp;= Q(条件二)</span><br><span class="line">qs = Model.objects.<span class="built_in">filter</span>(q)</span><br></pre></td></tr></table></figure>
<h1>Django中开启事务</h1>
<h2 id="【一】ACID特性">【一】ACID特性</h2>
<ul>
<li>原子性（Atomicity）
<ul>
<li>事务被称为一个不可再分隔的原子操作单位</li>
<li>要么全部操作成功并永久保存，要么全部操作失败并回滚到事务开始前的状态，不存在部分成功或部分失败的情况</li>
</ul>
</li>
<li>一致性（Consistency）
<ul>
<li>事务执行前后，数据库应保持一致的状态</li>
<li>在事务开始之前和结束之后，数据库必须满足所有的完整性约束，如列级别的约束、外键关系等</li>
</ul>
</li>
<li>隔离性（Isolation）
<ul>
<li>事务的执行结果对其他并发执行的事务是隔离的</li>
<li>一个事务的执行不应受到其他事务的干扰，各个事务之间应该相互独立工作，从而避免数据的不一致性</li>
</ul>
</li>
<li>持久性（Durability）
<ul>
<li>一旦事务被提交，其结果应该永久保存在数据库中，并且可以被系统故障恢复</li>
<li>即使系统发生宕机或崩溃，事务提交后的更改也应该是永久性的</li>
</ul>
</li>
</ul>
<h2 id="【二】事务名词">【二】事务名词</h2>
<ul>
<li>开启事务：Start Transaction</li>
<li>事务结束：End Transaction</li>
<li>提交事务：Commit Transaction</li>
<li>回滚事务：Rollback Transaction</li>
</ul>
<h2 id="【三】默认事务行为">【三】默认事务行为</h2>
<ul>
<li>Django是支持事务操作的，它的默认事务行为是自动提交</li>
<li>具体表现形式为：每次数据库操作(比如调用save()方法)会立即被提交到数据库中</li>
<li>如果你希望把连续的SQL操作包裹在一个事务里，就需要手动开启事务</li>
</ul>
<h2 id="【四】开启事务">【四】开启事务</h2>
<h3 id="【1】开启全局事务">【1】开启全局事务</h3>
<ul>
<li>在settings.py中的数据库中配置</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;</span><br><span class="line">    <span class="string">&#x27;default&#x27;</span>: &#123;</span><br><span class="line">        <span class="string">&#x27;ENGINE&#x27;</span>: <span class="string">&#x27;django.db.backends.mysql&#x27;</span>,</span><br><span class="line">        <span class="comment"># 手动创建数据库</span></span><br><span class="line">        <span class="string">&#x27;NAME&#x27;</span>: <span class="string">&quot;django_two&quot;</span>,</span><br><span class="line">        <span class="string">&quot;USER&quot;</span>: <span class="string">&quot;root&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PASSWORD&quot;</span>: <span class="string">&quot;1234567&quot;</span>,</span><br><span class="line">        <span class="string">&quot;HOST&quot;</span>: <span class="string">&quot;127.0.0.1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;PORT&quot;</span>: <span class="number">3306</span>,</span><br><span class="line">        <span class="string">&quot;CHARSET&quot;</span>: <span class="string">&quot;utf8mb4&quot;</span>,</span><br><span class="line">        <span class="comment"># 开启全局事务，绑定的是http请求响应整个过程</span></span><br><span class="line">        <span class="string">&quot;ATOMIC_REQUESTS&quot;</span>: <span class="literal">True</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>解析
<ul>
<li>每当有请求过来时，Django会在调用视图方法前开启一个事务。</li>
<li>如果完成了请求处理并正确返回了结果，Django就会提交该事务。</li>
<li>否则，Django会回滚该事务</li>
</ul>
</li>
</ul>
<h3 id="【2】取消局部的事务">【2】取消局部的事务</h3>
<ul>
<li>方法就是，在你要取消事务的视图函数上写一个添加一个装饰器</li>
<li>首先导入一个方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>使用<code>@transactionnon_atomic_requests</code>装饰器让某些视图函数方法不受事务的控制</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@transaction.non_atomic_requests</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<ul>
<li>如有多个数据库，让使用otherdb的视图不受事务控制</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@transaction.non_atomic_requests(<span class="params">using=<span class="string">&quot;otherdb&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<ul>
<li>虽然全局开启事务很简单，但Django并不推荐开启全局事务。</li>
<li>因为一旦将事务跟 HTTP 请求绑定到一起时，每一个请求都会开启事务，当访问量增长到一定的时候会造成很大的性能损耗</li>
<li>推荐使用局部开启事务</li>
</ul>
<h3 id="【3】局部开启事务">【3】局部开启事务</h3>
<ul>
<li>借助一个方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>给视图函数添加装饰器</li>
</ul>
<h4 id="（1）在函数头上增加装饰器">（1）在函数头上增加装饰器</h4>
<ul>
<li>第一步：引入Django内部的事务模块</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>第二部：在视图函数上添加装饰器</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加局部开启事务装饰器</span></span><br><span class="line"><span class="meta">@transaction.non_atomic_requests</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<h4 id="（2）在类内部的函数头上增加装饰器">（2）在类内部的函数头上增加装饰器</h4>
<ul>
<li>第一步：引入模块</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br></pre></td></tr></table></figure>
<ul>
<li>第二部:添加在类里面的函数头上</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">UserInfo</span>(<span class="title class_ inherited__">View</span>):</span><br><span class="line">    <span class="comment"># 添加局部开启事务装饰器</span></span><br><span class="line"><span class="meta">    @transaction.atomic</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get</span>(<span class="params">self, request</span>):</span><br><span class="line">        ...</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">post</span>(<span class="params">self, request</span>):</span><br><span class="line">        ...</span><br></pre></td></tr></table></figure>
<h4 id="（3）自定义事务点—-Savepoint回滚">（3）自定义事务点—&gt;<strong>Savepoint回滚</strong></h4>
<ul>
<li>自己设定开启事务的点</li>
<li>一旦发生异常或错误，我们使用savepoint_rollback方法让程序回滚到指定的保存点</li>
<li>如果没有问题，就使用savepoint_commit方法提交事务</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.shortcuts <span class="keyword">import</span> render</span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">longin</span>(<span class="params">request</span>):</span><br><span class="line">    <span class="comment"># 开启事务</span></span><br><span class="line">    <span class="keyword">with</span> transaction.atomic():</span><br><span class="line">        <span class="comment"># 记录事务起点</span></span><br><span class="line">        sid = transaction.savepoint()</span><br><span class="line">        <span class="comment"># 异常捕获</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment">#执行你的代码</span></span><br><span class="line">            ...</span><br><span class="line">        <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">            <span class="comment"># 进行事务的回滚</span></span><br><span class="line">            transaction.savepoint_rollback(sid)</span><br><span class="line">        <span class="comment"># 没有发生错误就提交事务</span></span><br><span class="line">        transaction.savepoint_commit(sid)</span><br><span class="line">    <span class="keyword">return</span> render(request, <span class="string">&quot;login.html&quot;</span>, <span class="built_in">locals</span>())</span><br></pre></td></tr></table></figure>
<h4 id="4-事务提交后回调函数">(4)事务提交后回调函数</h4>
<ul>
<li>意思就是：当前事务提交后立即执行额外的任务</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例1</span></span><br><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> transaction</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">do_something</span>():</span><br><span class="line">  <span class="keyword">pass</span>  <span class="comment"># send a mail, invalidate a cache, fire off a Celery task, etc.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">transaction.on_commit(do_something)</span><br></pre></td></tr></table></figure>
<h1>字段及字段参数的补充</h1>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> django.db <span class="keyword">import</span> models</span><br><span class="line"></span><br><span class="line"><span class="comment"># 【一】CharField 字符串类型</span></span><br><span class="line"><span class="comment"># max_length 规定字符串的长度</span></span><br><span class="line"><span class="comment"># models.CharField(max_length=25)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【二】IntegerField 整数类型</span></span><br><span class="line"><span class="comment"># 只能放数字类型</span></span><br><span class="line"><span class="comment"># 用数字表示 支付方式 微信 支付宝 花呗 ...</span></span><br><span class="line"><span class="comment"># 用数字代表字符串</span></span><br><span class="line"><span class="comment"># models.IntegerField(choices=((1, &quot;微信&quot;), (2, &quot;支付宝&quot;), (3, &quot;花呗&quot;)))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【三】BooleanField 布尔值类型</span></span><br><span class="line"><span class="comment"># 可以放 0 / 1 也可以放 True / False</span></span><br><span class="line"><span class="comment"># models.BooleanField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【四】EmailField 邮箱</span></span><br><span class="line"><span class="comment"># 必须符合邮箱格式才能被存进去</span></span><br><span class="line"><span class="comment"># models.EmailField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【五】TextField 大文本字段</span></span><br><span class="line"><span class="comment"># 大量的文本</span></span><br><span class="line"><span class="comment"># models.TextField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【六】AutoField 自动生成id</span></span><br><span class="line"><span class="comment"># models.AutoField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【七】DateTimeField 时间日期</span></span><br><span class="line"><span class="comment"># auto_now 第一次创建的时候的时间</span></span><br><span class="line"><span class="comment"># auto_now_add 以后每次更新的时候的时间</span></span><br><span class="line"><span class="comment"># models.DateTimeField(</span></span><br><span class="line"><span class="comment">#     auto_now=True,</span></span><br><span class="line"><span class="comment">#     auto_now_add=True</span></span><br><span class="line"><span class="comment"># )</span></span><br><span class="line"><span class="comment"># models.DateField()</span></span><br><span class="line"><span class="comment"># models.TimeField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【8】FileField 文件数据</span></span><br><span class="line"><span class="comment"># models.FileField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【9】ImageField 图片数据</span></span><br><span class="line"><span class="comment"># models.ImageField()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【10】外键关系字段</span></span><br><span class="line"><span class="comment"># 一对多关系</span></span><br><span class="line"><span class="comment"># models.ForeignKey()</span></span><br><span class="line"><span class="comment"># 一对一关系</span></span><br><span class="line"><span class="comment"># models.OneToOneField()</span></span><br><span class="line"><span class="comment"># 多对多关系</span></span><br><span class="line"><span class="comment"># models.ManyToManyField()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【二】字段参数</span></span><br><span class="line"><span class="comment"># default 默认值</span></span><br><span class="line"><span class="comment"># null 是否为空</span></span><br><span class="line"><span class="comment"># blank 是否为空 从admin后台插入数据逇时候是否可以为空</span></span><br><span class="line"><span class="comment"># unique 是否唯一</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 【三】自己看 数据库字段优化 defer / only</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://aurora-lsk.asia/2023/01/01/10.0selenium%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%93%8D%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="坤">
      <meta itemprop="description" content="选择有时候比努力更重要，但是你不努力，选择就只是空谈">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="坤博客">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/01/01/10.0selenium%E6%A1%86%E6%9E%B6%E4%B9%8B%E6%B5%8F%E8%A7%88%E5%99%A8%E6%93%8D%E4%BD%9C/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-01-01 00:00:00" itemprop="dateCreated datePublished" datetime="2023-01-01T00:00:00+08:00">2023-01-01</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-11 18:31:34" itemprop="dateModified" datetime="2025-10-11T18:31:34+08:00">2025-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Blog/" itemprop="url" rel="index"><span itemprop="name">Blog</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1>selenium框架之浏览器操作</h1>
<h2 id="【一】页面的操作">【一】页面的操作</h2>
<h3 id="【1】初始化浏览器对象">【1】初始化浏览器对象</h3>
<ul>
<li>前期我们将Chrome驱动添加到环境变量了，所以我们可以直接初始化界面。（或者也可以通过指定绝对路径的方式）</li>
</ul>
<h4 id="（1）方式一：使用环境变量">（1）方式一：使用环境变量</h4>
<ul>
<li>我们不指定驱动位置，在selenium打开浏览器的时间会很长</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="comment"># 初始化浏览器为chrome浏览器</span></span><br><span class="line">browser = Chrome()</span><br><span class="line"></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"><span class="comment"># 关闭浏览器</span></span><br><span class="line">browser.close()</span><br></pre></td></tr></table></figure>
<h4 id="（2）方式二：使用绝对路径">（2）方式二：使用绝对路径</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="【2】访问页面">【2】访问页面</h3>
<ul>
<li>进行页面访问使用的是get方法，传入参数为待访问页面的URL地址即可</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="【3】设置浏览器的大小">【3】设置浏览器的大小</h3>
<ul>
<li>方法：set_window_size（宽度，高度）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览器</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置浏览器的打开的大小</span></span><br><span class="line">browser.set_window_size(<span class="number">1000</span>,<span class="number">500</span>)</span><br></pre></td></tr></table></figure>
<h3 id="【4】设置浏览器为全屏">【4】设置浏览器为全屏</h3>
<ul>
<li>方法：maximize_window（）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览器</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置浏览器全屏</span></span><br><span class="line">browser.maximize_window()</span><br></pre></td></tr></table></figure>
<h3 id="【5】前进和后退页面">【5】前进和后退页面</h3>
<ul>
<li>前进页面：forward（）</li>
<li>后退页面：back（）</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览器</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 前进和后退页面</span></span><br><span class="line"><span class="comment"># 先打开一个网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.jd.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 后退回百度</span></span><br><span class="line">browser.back()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 前进到京东页面</span></span><br><span class="line">browser.forward()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="【6】获得页面的基础属性">【6】获得页面的基础属性</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览器</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得网页标题</span></span><br><span class="line"><span class="built_in">print</span>(browser.title)  <span class="comment"># 百度一下，你就知道</span></span><br><span class="line"><span class="comment"># 获得当前网址</span></span><br><span class="line"><span class="built_in">print</span>(browser.current_url)  <span class="comment"># https://www.baidu.com/</span></span><br><span class="line"><span class="comment"># 获得浏览器的名字</span></span><br><span class="line"><span class="built_in">print</span>(browser.name)  <span class="comment"># chrome</span></span><br><span class="line"><span class="comment"># 获得网页源码</span></span><br><span class="line"><span class="built_in">print</span>(browser.page_source)</span><br></pre></td></tr></table></figure>
<h3 id="【7】在浏览器中切换，新开，关闭，页面">【7】在浏览器中切换，新开，关闭，页面</h3>
<ul>
<li>隐士等待：<code>browser.implicitly_wait(2)</code>
<ul>
<li>如果在这两秒（或指定的时间）内WebDriver找到了元素,会立即停止等待并继续执行后续的代码</li>
<li>如果过了这两秒之后，元素仍然没有被找到,WebDriver会抛出一个NoSuchElementException异常</li>
</ul>
</li>
<li><code>browser.window_handles</code>：获得浏览器打开的所有页面的句柄，得到的是一个列表
<ul>
<li>得到这个句柄切换页面</li>
<li>也可以说或的页面的所有选项卡</li>
</ul>
</li>
<li><code>browser.switch_to.window(all_handles[0])</code>：切换到第一个选项卡页面</li>
<li>在本页面打开新的页面：<code>browser.get('https://www.pinduoduo.com/')</code></li>
<li>关闭当前选项卡：<code>browser.close()</code></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">service = Service(executable_path=<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览器</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 使用创建好的驱动发送get请求，打开指定网址</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.jd.com&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># time.sleep(2)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 隐士等待两秒，确保页面加载完全</span></span><br><span class="line"><span class="comment"># 当你使用browser.implicitly_wait(2)设置了隐式等待时间后，如果在这两秒（或指定的时间）内WebDriver找到了元素，</span></span><br><span class="line"><span class="comment"># 那么它就会立即停止等待并继续执行后续的代码。</span></span><br><span class="line"><span class="comment"># 但是，如果过了这两秒之后，元素仍然没有被找到，</span></span><br><span class="line"><span class="comment"># 那么WebDriver会抛出一个NoSuchElementException异常，表示它无法在指定的时间内找到该元素</span></span><br><span class="line">browser.implicitly_wait(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># browser.window_handles是一个属性，它返回当前会话中打开的所有窗口（或标签页）的句柄列表。</span></span><br><span class="line"><span class="comment"># 每个句柄都是一个唯一的标识符，用于区分不同的窗口或标签页</span></span><br><span class="line"><span class="built_in">print</span>(browser.window_handles)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在当前浏览器实例中新打开一个选项卡</span></span><br><span class="line">browser.execute_script(<span class="string">&#x27;window.open(&quot;https://www.baidu.com&quot;)&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取所有选项卡</span></span><br><span class="line">all_handles = browser.window_handles</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到第一个选项卡</span></span><br><span class="line">browser.switch_to.window(all_handles[<span class="number">0</span>])</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在第一个选项中打开拼多多</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.pinduoduo.com/&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到第二个选项卡上，打开百度</span></span><br><span class="line">browser.switch_to.window(all_handles[<span class="number">1</span>])</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭当前选项卡</span></span><br><span class="line">browser.close()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 关闭当前浏览器</span></span><br><span class="line">browser.quit()</span><br></pre></td></tr></table></figure>
<h2 id="【二】定位页面元素">【二】定位页面元素</h2>
<h3 id="【1】前言">【1】前言</h3>
<ul>
<li>我们熟知的 百度为例，我们进入首页，按 【F12】 进入开发者工具。</li>
<li>红框中显示的就是页面的代码，我们要做的就是从代码中定位获取我们需要的元素</li>
</ul>
<p><img src="D:%5Cpycharm%5CTemporary_notes%5C%E5%9B%BE%E7%89%87%5Cee02bd15-8922-4f62-8ce7-91baf3ab2401.png" alt="ee02bd15-8922-4f62-8ce7-91baf3ab2401"></p>
<h3 id="【2】八大选择器介绍">【2】八大选择器介绍</h3>
<ul>
<li>通过webdriver对象的 find_element(by=“属性名”, value=“属性值”)</li>
</ul>
<table>
<thead>
<tr>
<th>属性</th>
<th>函数</th>
</tr>
</thead>
<tbody>
<tr>
<td>CLASS</td>
<td>find_element(by=By.CLASS_NAME, value=‘’)</td>
</tr>
<tr>
<td>XPATH</td>
<td>find_element(by=By.XPATH, value=‘’)</td>
</tr>
<tr>
<td>LINK_TEXT</td>
<td>find_element(by=By.LINK_TEXT, value=‘’)</td>
</tr>
<tr>
<td>PARTIAL_LINK_TEXT</td>
<td>find_element(by=By.PARTIAL_LINK_TEXT, value=‘’)</td>
</tr>
<tr>
<td>TAG</td>
<td>find_element(by=By.TAG_NAME, value=‘’)</td>
</tr>
<tr>
<td>CSS</td>
<td>find_element(by=By.CSS_SELECTOR, value=‘’)</td>
</tr>
<tr>
<td>ID</td>
<td>find_element(<a target="_blank" rel="noopener" href="http://by=By.ID">by=By.ID</a>, value=‘’)</td>
</tr>
</tbody>
</table>
<h3 id="【3】八大选择器示例">【3】八大选择器示例</h3>
<h4 id="（1）ID">（1）ID</h4>
<ul>
<li>通过ID进行定位</li>
<li><code>browser</code>: 生成的浏览器对象</li>
<li><code>real_id</code>：查找元素的真实ID</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">label_position = browser.find_element(By.ID, <span class="string">&quot;real_id&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="（2）Name">（2）Name</h4>
<ul>
<li>通过元素name的属性进行定位</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.NAME, <span class="string">&#x27;real_name&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="（3）Class">（3）Class</h4>
<ul>
<li>通过元素的 Class 属性进行定位</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.CLASS_NAME, <span class="string">&#x27;real_class&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="（4）Tag定位">（4）Tag定位</h4>
<ul>
<li>通过标签名进行定位</li>
<li>将 ‘div’ 替换为你要查找的具体标签名，如 ‘a’、‘span’</li>
<li>使用 find_element<strong>s</strong> 方法，通过标签名进行定位</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_elements(By.TAG_NAME, <span class="string">&#x27;div&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="（5）Link文字进行定位">（5）Link文字进行定位</h4>
<ul>
<li>精准定位</li>
<li>将 ‘link_text’ 替换为你要查找的链接文字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.LINK_TEXT, <span class="string">&#x27;link_text&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="（6）Partial-Link文字">（6）Partial Link文字</h4>
<ul>
<li>模糊定位</li>
<li>将 ‘partial_link_text’ 替换为你要查找的部分链接文字</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.PARTIAL_LINK_TEXT, <span class="string">&#x27;partial_link_text&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="（7）Xpath">（7）Xpath</h4>
<ul>
<li>xpath表达式进行定位</li>
<li>将 ‘xpath_expression’ 替换为你要使用的实际 XPath 表达式</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">label_position = browser.find_element(By.XPATH, <span class="string">&#x27;xpath_expression&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="（8）CSS选择器">（8）CSS选择器</h4>
<ul>
<li>将 ‘css_selector’ 替换为你要使用的实际 CSS 选择器</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">element = bro.find_element(By.CSS_SELECTOR, <span class="string">&#x27;css_selector&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="【4】百度案例">【4】百度案例</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 八大选择器案例</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="comment"># 查找到驱动</span></span><br><span class="line">service = Service(<span class="string">&#x27;./text/chromedriver.exe&#x27;</span>)</span><br><span class="line"><span class="comment"># 创建浏览器对象</span></span><br><span class="line">browser = Chrome(service=service)</span><br><span class="line"><span class="comment"># 打开百度</span></span><br><span class="line">browser.get(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 通过类属性查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.CLASS_NAME, <span class="string">&quot;s_ipt&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过id属性查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.ID, <span class="string">&quot;kw&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过name属性查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.NAME, <span class="string">&quot;wd&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Tag标签名查找所有的input框</span></span><br><span class="line">search_input = browser.find_elements(By.TAG_NAME, <span class="string">&quot;input&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Xpath方法查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;kw&quot;]&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Link文字查找百度的新闻标签</span></span><br><span class="line">search_input = browser.find_element(By.LINK_TEXT, <span class="string">&#x27;新闻&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过Partial Link文字查找百度的新闻标签</span></span><br><span class="line">search_input = browser.find_element(By.PARTIAL_LINK_TEXT, <span class="string">&#x27;新&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过CSS选择器查找百度搜索框</span></span><br><span class="line">search_input = browser.find_element(By.CSS_SELECTOR, <span class="string">&#x27;#kw&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(search_input)</span><br></pre></td></tr></table></figure>
<h3 id="【5】小结">【5】小结</h3>
<ul>
<li>
<p>以上示例中的定位方式都是通过 find_element 或 find_elements 方法配合相应的定位器（如 <a target="_blank" rel="noopener" href="http://By.ID">By.ID</a>、<a target="_blank" rel="noopener" href="http://By.NAME">By.NAME</a> 等）来定位元素。</p>
</li>
<li>
<ul>
<li>find_element 方法返回第一个匹配到的元素</li>
<li>find_elements 方法返回所有匹配到的元素的列表</li>
</ul>
</li>
</ul>
<h2 id="【三】元素操作（节点交互）">【三】元素操作（节点交互）</h2>
<ul>
<li>
<p>Selenium可以驱动浏览器来执行一些操作，也就是说可以让浏览器模拟执行一些动作。</p>
</li>
<li>
<ul>
<li>比较常见的用法有：</li>
</ul>
</li>
<li>
<ul>
<li>
<ul>
<li>输入文字时用send_keys()方法，</li>
<li>清空文字时用clear()方法，</li>
<li>点击按钮时用click()方法</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">kw1.clear()        <span class="comment">#清除元素的值</span></span><br><span class="line">kw1.click()        <span class="comment">#点击元素</span></span><br><span class="line">kw1.<span class="built_in">id</span>             <span class="comment">#Selenium所使用的内部ID</span></span><br><span class="line">kw1.get_property(<span class="string">&#x27;background&#x27;</span>) <span class="comment">#获取元素的属性的值</span></span><br><span class="line">kw1.get_attribute(<span class="string">&#x27;id&#x27;</span>) <span class="comment">#获取元素的属性的值</span></span><br><span class="line">kw1.location       <span class="comment">#不滚动获取元素的坐标</span></span><br><span class="line">kw1.location_once_scrolled_into_view  <span class="comment">#不滚动且底部对齐并获取元素的坐标</span></span><br><span class="line">kw1.parent         <span class="comment">#父元素</span></span><br><span class="line">kw1.send_keys(<span class="string">&#x27;&#x27;</span>)  <span class="comment">#向元素内输入值</span></span><br><span class="line">kw1.size           <span class="comment">#大小</span></span><br><span class="line">kw1.submit         <span class="comment">#提交</span></span><br><span class="line">kw1.screenshot(<span class="string">&#x27;2.png&#x27;</span>) <span class="comment">#截取元素形状并保存为图片</span></span><br><span class="line">kw1.tag_name       <span class="comment">#标签名</span></span><br><span class="line">kw1.text           <span class="comment">#内容，如果是表单元素则无法获取</span></span><br><span class="line">kw1.is_selected()  <span class="comment">#判断元素是否被选中</span></span><br><span class="line">kw1.is_enabled()   <span class="comment">#判断元素是否可编辑</span></span><br><span class="line">kw1.is_displayed   <span class="comment">#判断元素是否显示</span></span><br><span class="line">kw1.value_of_css_property(<span class="string">&#x27;color&#x27;</span>) <span class="comment">#获取元素属性的值</span></span><br><span class="line">kw1._upload(<span class="string">&#x27;2.png&#x27;</span>) <span class="comment">#上传文件</span></span><br></pre></td></tr></table></figure>
<ul>
<li>find_element方法仅仅能够获取元素对象，接下来就可以对元素执行以下操作 从定位到的元素中提取数据的方法</li>
</ul>
<h3 id="【1】从定位到的元素中获取数据">【1】从定位到的元素中获取数据</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">el.get_attribute(key)           <span class="comment"># 获取key属性名对应的属性值</span></span><br><span class="line">el.text                        	<span class="comment"># 获取开闭标签之间的文本内容</span></span><br></pre></td></tr></table></figure>
<h3 id="【2】对定位到的元素的操作">【2】对定位到的元素的操作</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">el.click()                      <span class="comment"># 对元素执行点击操作</span></span><br><span class="line">el.submit()                     <span class="comment"># 对元素执行提交操作</span></span><br><span class="line">el.clear()                      <span class="comment"># 清空可输入元素中的数据</span></span><br><span class="line">el.send_keys(data)              <span class="comment"># 向可输入元素输入数据</span></span><br></pre></td></tr></table></figure>
<h3 id="【3】百度登入案例">【3】百度登入案例</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 引入模块</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> Chrome</span><br><span class="line"><span class="comment"># 引入Service</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.chrome.service <span class="keyword">import</span> Service</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.by <span class="keyword">import</span> By</span><br><span class="line"><span class="comment"># 时间</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Service对象，指定ChromeDriver的路径</span></span><br><span class="line">service = Service(executable_path=<span class="string">&quot;./chromedriver.exe&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成浏览器对象</span></span><br><span class="line">browser = Chrome(</span><br><span class="line">    service=service</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置浏览器为全屏</span></span><br><span class="line">browser.maximize_window()</span><br><span class="line"><span class="comment"># 控制浏览器打开百度</span></span><br><span class="line">browser.get(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置你打开的浏览器的分辨率</span></span><br><span class="line"><span class="comment"># browser.set_window_size(1920, 1080)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到百度的登入按钮</span></span><br><span class="line">search_btn = browser.find_element(By.ID, <span class="string">&quot;s-top-loginbtn&quot;</span>)</span><br><span class="line"></span><br><span class="line">search_btn.click()</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到登入界面的手机号输入框</span></span><br><span class="line">search_input_phone = browser.find_element(By.XPATH,<span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__userName&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 渲染数据</span></span><br><span class="line">search_input_phone.send_keys(<span class="string">&quot;17746302958&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到登入界面的密码输入框</span></span><br><span class="line">search_input_psw = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__password&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 渲染数据</span></span><br><span class="line">search_input_psw.send_keys(<span class="string">&quot;lsk2lmy1314&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先点击阅读接收</span></span><br><span class="line">search_receive_btn = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__isAgree&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击</span></span><br><span class="line">search_receive_btn.click()</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后找到登入按钮</span></span><br><span class="line">search_btn = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;TANGRAM__PSP_11__submit&quot;]&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 点击按钮</span></span><br><span class="line">search_btn.click()</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 获得点击发送验证码的按钮</span></span><br><span class="line">search_input_verification_btn = browser.find_element(By.XPATH,<span class="string">&#x27;//*[@id=&quot;goToVerify&quot;]&#x27;</span>)</span><br><span class="line"><span class="comment"># 点击发送验证码</span></span><br><span class="line">search_input_verification_btn.click()</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得输入验证码的框</span></span><br><span class="line">search_input_verification = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;passAuthVcode&quot;]&#x27;</span>)</span><br><span class="line"><span class="comment"># 将得到的验证码在一分钟之内，输入进去</span></span><br><span class="line"><span class="comment"># 第一次见进入的时候，会发送验证码，你随机填的验证码肯定不正确</span></span><br><span class="line"><span class="comment"># 但是你第二次，启动之前把你获得的验证码放在括号里，就可以登入成功</span></span><br><span class="line">search_input_verification.send_keys(<span class="string">&quot;913879&quot;</span>)</span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获得校验验证码的按钮</span></span><br><span class="line">search_verification_btn = browser.find_element(By.XPATH, <span class="string">&#x27;//*[@id=&quot;passAuthSubmitCode&quot;]&#x27;</span>)</span><br><span class="line"><span class="comment"># 点击下一步</span></span><br><span class="line">search_verification_btn.click()</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br><span class="line"><span class="comment"># 可以用input标签不让程序自动关闭</span></span><br><span class="line"><span class="comment"># input(&quot;阻止它关闭：&quot;)</span></span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/20/">20</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">坤</p>
  <div class="site-description" itemprop="description">选择有时候比努力更重要，但是你不努力，选择就只是空谈</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">196</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">坤</span>
</div>
  <div class="powered-by">由 <a href="https://github.com/lsk-0912" class="theme-link" rel="noopener" target="_blank">lsk-0912</a> & <a href="https://github.com/lsk-0912" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
